
Oleg Zaitsev

`

`\ _

x^*
<^.

recifes
Em \

pagina: 1

Oleg Zaitsev

Rootkib,
$ Ru \ mave/braç/ouça,
Ke \ State $ &
Vascoror $

E .
Ar "
1) 2 =

São Petersburgo
"BHV-Petersburg"
2006

pagina: 2

UDC 681.3.068
BBK 32.973.26-018.2
3-12
Zaitsev O.V.
3-12 Vootk!
Detecção e proteção.-St.Il.

1 $ vm 5-94157-868-7

As tecnologias e técnicas subjacentes ao trabalho do trabalho são consideradas
Programas maliciosos gastos: rootkitas, espiões de teclado.
Programas de Zru \ Age/Aya \ Aga, Vaskgoog, Ttodap-Po \ Toafa, etc. para a maioria
A consistência dos programas e tecnologias considerados mostra descrições detalhadas
o algoritmo de trabalho e exemplos de código no rarsh e c, demonstrando
Sugado pela implementação do algoritmo.Vários utilitários são descritos, incluindo
número e utilidade de um autor popular a \ 2, projetado para pesquisar e
Neutralização de programas nocivos e "marcadores" de hacker.Considerado
Situações típicas associadas a danos a um prejudicial
programas.Para cada situação, o processo de análise e tratamento é descrito.
Os CDs anexados mostram os textos iniciais dos exemplos,
Utilitário Tivirus Aue e alguns materiais adicionais.

Para administradores de sistema, especialistas em proteção de informações,
estudantes universitários e usuários experientes

UDC 681.3.068
BBK 32.973.26-018.2

Grupo de publicação de preparação:

Editor -in -chief Ekaterina Kondukova
Deputado.editor -in -chief igor shishigin

Cabeça.Os editores do divã Grigory
Editor Ekaterina Kapalygina
Layout do computador de Natalia Smirnova
Corretor Natalia Pershakova
Capa inna tachina

Cabeça.Produção Nikolai Tver

ID da licença nº 02429 de 24.07.00.Podliado para imprimir em 28/07/06.
O formato está com deslocamento.Conv.curar.eu.26531.
Circulation 2000 Cópias.Pedido nº 487
"BHV-Petersbum, 194354, São Petersburgo, 56 Yesenin St.
Conclusão sanitária e epidemiológica sobre os produtos nº 77.99.02.953.D.008421.11.04
Datado de 11/11/2004 emitido pelo Serviço Federal para Supervisão
No campo da proteção do consumidor e do poço humano.
Impresso a partir de diálogo pronto

Na empresa unitária estatal "tipo de" nvuka "
199034, St. Yerburg, 9 Linha, 12

15 $ VM 5-94157-868-7 © Zaitsev O.V. 2006
© Registro, IzValilation "BHV-Petersburg", 2006

pagina: 3

Índice

Introdução ....... Esetaani + Enpininevaeva elenin.It INIA em IAAAANENNNE NEOE 1
Quem é endereçado a este kimga ................. ishiihainininininininininininianininianinotlitiaiiyaniniainianiania 2
Gratidão ........... ,.

Capítulo 1. Classificação de programas prejudiciais ......... Neenannio Zeneuye Egorie Tivi e .3
Classificação de acordo com o método de infecção do sistema ...................
Classificação por danos ............ „Linhas de lítio: 5
As principais variações de programas prejudiciais ............... Instituto de Pesquisa.Iiiiiiiiiitininni 5

Zru \ Age (Programas Geeks) ............ “Despeje-os Llipill-Tannies 6
Zru \ waga prok1e .......... linhas
AZ \! Programas de idade e módulos ...
Tgodap-oo \ etoa4eg ....... linha iLyainzinatinishhyniyniyiyaniyi e
Osheg ........ lírios linho A Lap Ilezinenetenny 12
Vno (vgo \ zegeg Notege Operação!) .........
Nuaskug ....... Liliya vlettyiiiyilianev ien ieniaaniottentiaeii -ine.
TGODAP (Programa de Trojan) .............. „iiisiniiyiyiyliyaniyaniyaniyaniyaniyanitini Jan Paliniyanatninn 15
|: (9) <("mar aaa 16
|OA 16
Estatísticas da prevalência de vários tipos de prejudiciais em ............. 19
Tendências de desenvolvimento de programas nocivos .................. iii iiinitnninny 21

Ceras ..........-.Lilia Lilia ou itetitiatiationiasia 23
Uzegmo4e koski ............ ou no isnchinitiiliteinnnnnna 25
Métodos de introdução de código de máquina no processo ................ ou 27
Métodos de interceptação de funções .............. Lilia Ivan 36
Keta!Eles comeram ipitinetytyti 74
Os principais tipos de keta!
Interferência na operação do sistema sem interceptação de funções .................. Procure.91
Custos com base no driver do sistema de arquivos ................ linhas 101
Sistemas de monitoramento sem interceptação Instalação ............ Liana 101
Conclusões .............. Lenin Still.104
Espiões do teclado ............ linhas ai titanninithniya 105
Espio do teclado com base em armadilhas .......... +.Distyyshininiilizlniainonia 107
Métodos de busca de espiões de teclado com base em armadilhas ............. Verdes 112
Rastreando a entrada do teclado usando uma pesquisa de teclado ........ 117

Um espião de teclado baseado na technologia rutki em chzegmo4e ............... 118

pagina: 4

e índice

O espião do teclado baseado no filtro de motorista ................ „Ehiininia 122
Um espião de teclado com base na Kov1Ki-Technology in Kegp!
Programas para rastrear um buffer de troca e remover cópias da tela ........... 144
Rastreando um buffer de troca ................. iiiiliilichinonit line ninelinnini linha 144
Removendo cópias da tela .................... liiiininillyiiiiiiiyiyitinillaiiiiininatettitzennyanyanyaya 147
Detecção de programas para rastreamento
Atrás da área de transferência e tela ........... +... lírios linininite é iliniainvilietitini 148
Tgodap-oo \ pua4eg ​​........ Otin Shadow de Otiin Inina Nova Telnetnavnna 151
Tgodap-ooo \ Owls com base nas funções da biblioteca iptoop ........... "linhas 151
Tgodap-ooo \/puhadeg com base nas funções da biblioteca de mishpee ...... „ai iiainninynia 152
Tgodap-OGORRREG ..........
As tecnologias são costuradas de malware da remoção ............ e ... Ichiiyinia 158
Bloqueando o acesso ao arquivo ................ Iiioliniinininininthichennintnnnnn 159
Contrariando os principais métodos de proteção contra a remoção ............ cap.
Nbaskugg ..... ion iontini ontitiyviyveviyviyititis do lizavatzoniliniya positivo 161
Tecnologias para rastrear a atividade da rede ........... Z.Lírios de Iinnsheaniaia 162
Contrariando as tecnologias ETU \ ia |
Acesso à rede de um aplicativo não executado ............ e iiliiiiiiiiiiiiiIliiiiiinitnit 167
Acesso à rede usando Kau/ Zoskmet ......... iniciais 167
A gestão do aplicativo confiável ................. privação de teininitani 168
Implementação de pessoas de fora 01-1 em processos confiáveis ​​............. 1 ...
Criação em processos confiáveis ​​de fluxos de trojan .............. +... iiiliinis 170
Modificação do código da máquina de processos confiáveis ​​.............. UNU 171
Máscaras do processo não intencionado ............ initensnin 172
Ataques aos processos do rtezhma |
Ataques à SIG da concha de controle ......... "Jeen, do Instituto de Pesquisa da Iininia, em 173
Modificação das chaves do registro e arquivos pertencentes a yeria \ ay ............. 173
Modificação do banco de dados da ameixa |................ iiiiiiinityininityInitnivnis 174
Drivers ignorados instalados por Riga \ ia | .......................................... ...
Capítulo 3. Programas e programados para pesquisar o sistema ..... “A Igreja de Ononiachyuvonovov 177
Utilitários para a busca e neutralização das rotas ...... Yen Yen 177
G. Y e 178
KoviveChea [por exemplo, ............ iniiizaiaziiiiii titi tiilitinizhini 182
Viaskiaeni ............ Ai Titan cantando Najachinnia 184
|UE h 186
Kos!
$ Dólar ...... nii ou onnit puxa 188
Utilitários de monitoramento do sistema ........... Lily Lithium nenenizhenin 190
|.
Veempo .............. yene um 192
Iu) 6 o) 1 ni 193
TSR \ Meshch .............. UNEM de Initiainnoitiaittia -IatitatAviet.
Utilitários de controle de automóveis .............. linhas de IA Titinnnini 195

A \ ogip $ ......... U.E.

pagina: 5

Tabela de tabela

Utilidade Nuoaskot .......... Ei Ietinna 198
Despachantes de processo ........... iiiitititititititityityityiiiiiiiiiiiiilishish 200
Utilitário rgosez $ echryuga ........... +.Jeena Research
Utilitários para pesquisar e bloquear espiões do teclado ................ Elilia, 203
Richasukeuboaga ...............- ililya naniaininevnnnni 203
Aley Keyuyuyg adapassado ............-.olion desculpe iinnivininwinnn 205
Snifffers ..............
Sott \ ue \ y .......... a internet nininoviniviniaviniiiiyeviyi 208
|
Utilitário Antivirus Auy .............. Linha Yin Nina Tiiivinavinávia 214
Gerenciador de processos ....... Yena Silence Lilipiylitpilateenia 217
Estudo automático do sistema ............- .- olya ii iti linviyuvniya i 220
Restauração do sistema ......... „+.Nuts Piintitaniyenin 224
Quarentena automática ........... +.Ipiliiyaniyatiyatinia 226
AU7, sistema SSA!
Pesquise arquivos no disco .............. innet ptinosiviyviliaiiiiitinetinlia 229
Gerenciador de controle operacional de automóveis .......... linha de íons de ien Olivin otanisiyznesytiyaninin 233
Ótimos recursos de experimento ........... “ea niinitinitinitylitoniaiyita de ai oiiitiililintini, 234
YAIR SITE // LITM MIGIOT!
Site Aéreo:/Ligiuusap Rendimentos.
Conclusões ...... Internet Eshiashaliti 235

Capítulo 4. Métodos de pesquisa do sistema,

Pesquisa e exclusão de malware ...
Preparação para análise ......... “..
Loisk e neutralização de Rutkitov ............ lilia de iiiiyaliniaiiiiiiyilinitiyiiiyinalenin 238

Exemplo da análise - Vaskdoog.
Exemplo da análise - Vaskdog
Exemplo da análise - \/ogt.
Procure espiões do teclado ........ +.NII Pesquisa de Inittinny, 247
Keilogger com base em armadilhas ............- .. Linha julho intitlando 247
Keilogger baseado em uma pesquisa de teclado cíclico ............. “AI 248
Keilogger baseado em Rutka-Technology ........... +.Ai ittitiiiiitiytitininin 249
Situações típicas que surgem durante o tratamento dos PCs e sua solução ............. 249
Mudando as configurações do navegador ................- ai leiliaiiiiiiiiiiititisElininen 250
Um exemplo prático é TGODAP.............. linha 252
Exemplo prático-tgap.z4oproprava com base no arquivo kes ................. 254
Substituindo o papel de parede da área de trabalho sem o desejo do usuário .......... „e.Iilnininia 255
Um exemplo prático - Noah.
Conclusão de janelas estranhas com informações de publicidade .................. Leeinilini 259
Exemplo - ACH \! Age.Shok2th ...
A aparência de forasteiros vno ............... Lilia Lininilnini: 264
Um exemplo prático é TGODAP.SH ................ iiiiininininininininininining 267

Conclusão ... Yena Oka Noowevo LLC Vooon com Vovo Vovo VovoveVoveVotoVovoVoVoVo 269

pagina: 6

M entregou

Aplicações .........- un zzetchvvvveje novo vooon euteneneneennn 2171

Apêndice 1. Funções em números de CT

Para vários sistemas operacionais ......... hee uteenenia 273
Apêndice 2. Descrição do comandante do disco ... “Oneiai sini zvinnino bem:
Catálogo de Zochvsa .......... „ou orinliniltinlinivininina linha da tia anniynniya 285
Podkatalog vo {ki ....... e.Linha de insininina linicain ott anii ai alinanniylani 285
Podkatalog Keu |
Podkatalog mals \ aga ...... ou anionov anna esboço 287
Catálogo [P ..... “Lilia ntv Itinshi 287
Catálogo aul ........... Lisa zichiniyiyuilzininininiioiaiiniiyeti nina vinhos 287
Lista de literatura ...

Ponteiro de sujeito .... “Zosioooovorovo nobraonaooo -oovopiopvoop vhead Avilovovo 289

pagina: 7

Introdução

Este livro é dedicado a tecnologias e métodos usados ​​em alguns
Tipos de programas prejudiciais comuns.Em particular, um grande
A atenção é dada às rotas e espiões do teclado.

Capítulo 1] contém uma classificação de programas maliciosos nos quais um especial
Atenção é dada a az \/idade e zeru \/aga.Os programas estão condicionalmente
malicioso porque eles não têm vírus de computador inerentes
A capacidade de reproduzir, não danifica os dados e não transmite o mal
Integradores de informações confidenciais.No entanto, a presença de AZ \ No. Age
Em um computador para um usuário, o vírus é desagradável - muitos magos em
O processo de trabalho é entregue por janelas de publicidade com uma frequência irritante,
Altere a página inicial do navegador e execute outros indesejáveis
ações.

O capítulo 2 examina em detalhes as tecnologias usadas pelo moderno
programas maliciosos.Primeiro de tudo, é dada atenção aos rutkuts
e tecnologias raiz.Além disso, espião
Programas para rastrear o teclado e um buffer de troca.
Também descrito pelos programas das classes de Nbaskugg, TGOAP-RO \ Z'TUADEG e TGAAP-
VGorreg, Métodos de proteção contra a remoção, ignorando o rigumay e rastreamento
Sneak de tráfego.Os materiais do capítulo 2 são projetados principalmente para o experimental
Administrador de usuário e sistema.Para a maioria, considerado
tecnologias dadas exemplos nas línguas de traseiras e C explicando
Os princípios do trabalho e demonstrando os recursos de sua implementação.Muitos
De exemplos após pequenos refinamentos podem ser usados ​​para testar
Programas e utilitários antivírus.

O capítulo 3 é dedicado a vários utilitários que podem ser úteis
mi para a busca e destruição de programas maliciosos sem o uso de anti-
Vírus e antenas.Atenção especial é dada aos programas gratuitos
Mães trabalhando sem instalação.Todos os programas descritos são derrotados por
categorias (anti-reguladores, anti-ceylogers, utilitários de monitoramento, despacho
Existem processos, gerentes de sugestões automáticos, sniffers).Dos programas descritos
Você pode equipar um conjunto peculiar de ferramentas que são úteis para
Exame operacional de um computador.Além de programas conhecidos
Desenvolvedores pessoais no capítulo 3 descrevem a utilidade do autor AUI, pretendida
Para um estudo semi -automático de um computador.Este utilitário
Com documentação detalhada, você pode encontrar no livro em anexo compacto
disco.

pagina: 8

2 Introdução

O capítulo 4 discute exemplos práticos de uma análise de computador com exemplo
O número descrito no capítulo 3 dos programas.Este material pode ser interessante
o leitor com qualquer nível de treinamento, pois demonstra o sub- básico
move -se para a análise do computador.Como exemplos de análise, típico
Situações que todo usuário pode enfrentar é um exemplo
O rum desta situação é a retirada de janelas estranhas de informações de publicidade
a matting ou substituição da página inicial do navegador.

Quem é endereçado a este livro

O livro destina -se a um amplo público de leitores interessados ​​em
Os princípios do trabalho de programas nocivos e métodos de proteção deles.
Em particular, pode ser útil:

Com especialistas em proteção de informações;

(9 alunos que estudam disciplinas na especialidade "Informações
segurança";

Com administradores de sistema;

(Com usuários experientes que estão interessados ​​nos princípios do trabalho prejudicial
programas de nariz e métodos de proteção deles sem o uso de anti

Rusa.

Para estudar os exemplos descritos no livro, o conhecimento das línguas do SI é desejável
VER e conhecimento geral no campo da programação do sistema.No entanto
Esse conhecimento é precisamente desejável, uma vez que a descrição de todas as tecnologias neste
O livro começa com a história sobre os algoritmos e os princípios de seu trabalho, e já
Em seguida, exemplos específicos de identificação demonstrando esta tecnologia em
prática.O mesmo pode ser dito sobre a utilidade descrita no livro - para
sua aplicação não requer conhecimento especial, como no caso de
Debuggers e Dizassemblers.

Gratidão

Sou sinceramente grato a Sergey Sherstnev pela ajuda fornecida na preparação
Tovka e exemplos de testes para este livro.

pagina: 9

Capítulo 1

Classificação
programas maliciosos

Atualmente, muitos métodos de classificação diferentes são conhecidos
programas maliciosos.Como recursos de classificação geralmente
Atua uma das propriedades dos programas prejudiciais.

Com a metodologia de infecção do sistema.

(Com os danos causados ​​pelo sistema como resultado da atividade do malicioso
gramas.

(0 Algumas características técnicas. Por exemplo, uma plataforma na qual
Um programa malicioso pode funcionar (\ 132, Spich, taua),
Ou aplicado durante a criação da ferramenta de desenvolvimento.

Classificação de acordo com o método de infecção é um dos mais
Estranho e universal.

Classificação de acordo com o método
infecção pelo sistema

De acordo com o método de infecção do sistema e arquivos, várias categorias podem ser distinguidas.

(9 vírus de computador. Esses são programas prejudiciais que têm
Propriedade da infecção de outros programas.Sob o termo "infecção" em
Este contexto é entendido para introduzir o código da máquina do vírus no corpo
O programa afetado e a modificação do programa afetado para tal
no caminho, para que o código da máquina do vírus receba controle no momento de
Iniciando um programa infectado ou no processo.O procedimento é
o vírus (o chamado "tratamento"), caso seja reduzido para

pagina: 10

4 Capítulo 1
o código da máquina do vírus do corpo do programa e restaurando seu
desempenho.Restauração da aplicação do aplicativo
pode ser tão simples (consistindo, como regra, na restauração de não
quantos campos no cabeçalho do arquivo executável) e muito complicados.
Por exemplo, o vírus pode criptografar fragmentos do programa infectado,
portanto, para restaurar a aplicação do aplicativo, seu
Decodificação.

(0 redes e vermes postais. Programas maliciosos desse tipo não são
Aproveite a capacidade de "infectar" outras aplicações, mas tenha algo
ritmos que lhes permitem enviar suas cópias para outros computadores
ry.O tratamento do worm se resume à busca de seus componentes no disco e de seus
remoção.

Sobre programas de Trojan.Programas desta categoria não têm
de propriedade de infectar outras aplicações ou enviar suas cópias para
Outros computadores.No entanto, com suas atividades, eles prejudicam
o usuário de uma maneira ou de outra- por exemplo, a transferência dele
Dados Phytened para um atacante, destruição de informações,
violação do trabalho de outras aplicações.Tratamento do programa Trojan
Somos semelhantes ao tratamento do verme- tudo se resume ao fortalecimento dos arquivos
Programa Yang.

Com Daiga/5 Ruy'ag.Os programas desse tipo são semelhantes ao Trojan, ou seja ..
Eles não podem infectar outras aplicações ou enviar suas cópias para
outros computadores, mas diferentemente dos programas de Trojan, eles não
prejudicial.No entanto, a presença deles no computador diminui seu trabalho
Tu, há um consumo tangível de tráfego de intranet, o programa pode
realizar rastreando o trabalho do usuário (por exemplo, conserte
Visitado pelo PMC.) E oferecer muita preocupação com sua atividade
Stu.Freqüentemente, esses programas mascaram sua presença em com-
Puchester e neutraliza ativamente sua remoção.

Vale a pena notar que existem muitos programas prejudiciais que podem
Mas atribua a várias categorias ao mesmo tempo.Por exemplo, correio
O worm pode executar as funções do programa Trojan, e o Trojan
Gram, por exemplo, pode ser introduzido em um dos aplicativos do sistema
Pelo princípio do vírus.Além disso, cada um dos desenvolvedores de anti
Os programas RUS aderem aos seus próprios critérios de classificação.
Como resultado, um antivírus não pode detectar algum tempo
Um programa diário (como os analistas não o consideram prejudicial),
o outro o detectará como ACH \ No. Age, o terceiro- como um Trojan
Grama.Na maioria das vezes, esses momentos controversos surgem precisamente para
programas de categorias de az \ mago e zru \ idade que não são maliciosos
formulários.

pagina: 11

Classificação de programas prejudiciais 5
Classificação por dano

Por outro lado, você pode classificar programas maliciosos para
O grau de perigo para o sistema.Nesse caso, o seguinte pode ser distinguido
categorias.

Seguro.Apesar do fato de que os programas desta categoria pertencem a
malicioso, eles não causam danos óbvios ao sistema operacional e
Dados do usuário.Quase todo o AZ \/! Age- e
Programa Zru \/Age.Seguros seguros também podem incluir Noahs que
Eu simula a presença de um programa prejudicial sem danos.

De lagogramas que destroem e danificam os dados.Destruições semelhantes
As ações são colocadas em vários vírus de computador e Trojan
programas.Alguns programas maliciosos produzem reversível
danos à informação (por exemplo, sua criptografia} seguida por
Nucas o resgate para restaurar informações, geralmente após o pagamento
Alguns representam para o desenvolvedor.

De lagogramas que coletam e transmitem a terceiros confidenciais
Informação.Geralmente esses são programas de Trojan que coletam vários
Senhas armazenadas no computador do usuário.

0 Programas organizando uma lacuna na segurança de um computador.Este é o primeiro
A virada de todos os tipos de programas Farms4oog e Trojan realizando
criação de contas estranhas ou execução semelhante
Operações que permitem ao invasor acessar o computador
Do utilizador

De lagogramas que neutralizam ou danificando um especializado
Suporte gramatical usado para proteger o computador.Em Classif
A Cania do Laboratório Kaspersky de tais programas é destacada na categoria
Riya tradep.

Como no caso da classificação anterior, muitos dos maliciosos
Os programas podem ser atribuídos a várias categorias ao mesmo tempo.Por exemplo
Medidas, o programa Trojan pode roubar informações confidenciais
e ao mesmo tempo neutralize ativamente \ a |e antivírus.

As principais variedades
programas maliciosos
Vamos considerar com mais detalhes a variedade mais comum

o estágio de malware moderno.Vamos prestar a atenção principal
Programas de classe AZ \/Aga, Zru \!

pagina: 12

[5] Capítulo 1

Lunidade foi apanhada e possivelmente já ultrapassou os programas maliciosos de outro
Tipos GIH.Além de descrever as propriedades básicas dos programas, formulamos um crime
Terias, pelo qual o programa pode ser atribuído à categoria de Bru \\ Mage ou
AZ \! Idade.

Zru \ Age (programas Spiena)

Programa Shpion (nomes alternativos-zru, zru \ Ate, $
U/aga.Zru tgo) ap) é costume chamar a coleta de software
E transmitir a alguém informações sobre o usuário sem o seu consentimento.
Informações sobre o usuário podem incluir seus dados pessoais,
Configuração de seu computador e sistema operacional, estatísticas de trabalho
Na internet.

O software de espião é usado para vários alvos, de
Os principais são pesquisas de marketing e publicidade de destino.
Nesse caso, informações sobre a configuração do computador do usuário,
Ele usou pelo software, sites visitados, estatísticas
Solicitações para mecanismos de pesquisa e estatísticas de palavras inseridas no teclado
permite que você determine com muito precisão o tipo de atividade e o círculo de interesses do
faturas.Portanto, na prática, o grupo pode ser observado com mais frequência
Zru \/! Age + ACH \/AGA, ou seja, "Spy" + "Módulo de Show de Publicidade".Espião
A parte coleta informações sobre o usuário e a transmite para o servidor
Noah Company.Lá, a informação é analisada e, em resposta, é enviado para anúncios
Informações Naya mais adequadas para um determinado usuário.No melhor
Caso de publicidade é mostrado em janelas pop separadas, no pior -
É introduzido em páginas carregadas e enviado pelo e -mail.

No entanto, as informações coletadas podem ser usadas não apenas para o
Objetivos da lâmpada- por exemplo, obtendo informações sobre o PC do usuário
pode simplificar significativamente o ataque de hacker e hackers do computador
Calle.E se o programa se atualizar periodicamente pela Internet, então este
Torna o computador muito vulnerável - um ataque elementar a $ pode
Substitua o endereço da fonte de atualização para o endereço do servidor hacker - este
"Atualização" levará à introdução de qualquer estranho ao PC do usuário
software de TI.

O software espião pode chegar ao benefício do computador
Vatel de duas maneiras principais.

Com durante os sites da Internet visitando.A penetração mais comum
O software de espião ocorre quando o usuário visita o hacker e
\ iiage?Como uma regra
Lo, para a instalação do software SPY, os componentes da ASIUH são usados
ou programas de Trojan da categoria de tgodapoo \ puadeg de acordo com clássicos

pagina: 13

Classificação de programas prejudiciais 7

ção do laboratório de Kaspersky.Muitos sites de hackers podem emitir
"rachado" contendo um programa de espionagem ou ttgodap-ooo \ un
seus downloads.

C Como resultado da instalação de programas pagos gratuitos ou condicionalmente.
O mais desagradável é que esses programas existem
Existem muitos, eles são distribuídos pela Internet ou para um Pi-
CDS.Um exemplo clássico é o codec guuch contendo
A utilidade para carregar e instalar zru \\ mago.Maioria
Programas que contêm os componentes da Zru \ Age não notificam sobre isso
Do utilizador.

Critérios precisos para inserir o programa na categoria "zru \/aga" não é
Ele aparece e, muitas vezes, os criadores de pacotes antivírus incluem os programas
Tigoria "A \ U/Aga", "Ntsaskug" e "VNO" para a categoria de "Zeru \/aga" e vice -versa.

Para ter certeza, várias regras e condições são propostas, sujeitas a
Que o programa pode ser classificado como zero \\ AGA.A base da classe
os símbolos são devidos ao autor do estudo do mais
Programa Strange Zru \/Age.

Sobre o programa está instalado secretamente no computador do usuário.Significado
Este parágrafo é que o instalador de um programa convencional é longo
As esposas notificam o usuário do fato de instalar o programa (com possivelmente
para recusar a instalação), ofereça -se para escolher um catálogo para instalação e
configuração.Além disso, após a instalação, o instalador deve criar
item na lista "Instalação e remoção de programas", cuja chamada
Processo de Deinstal.Software de espionagem
geralmente estabelecido de maneira exótica (frequentemente usando
Módulos de categoria de Trojan) secretamente do usuário, enquanto seu
Deanstal na maioria dos casos é impossível.O segundo caminho de instalação
o zru \! Age-uma instalação secreta completa com qualquer população
Programa de Lyar.

Com o programa, ele é secretamente carregado na memória durante o carregamento do computador
Ra.Vale a pena notar que os desenvolvedores da Modern 5Ra \! AGA são usados
Tecnologias de Toofy para mascarar o processo na memória e arquivos no disco.
Além disso, a criação de processos "indestrutíveis" se torna popular
(ou seja, o lançamento de dois processos que se reiniciam no caso
paradas) e o uso de outras tecnologias que dificultam a remoção
Zru \/aga sem o uso de ferramentas especializadas.Tal tecnologia,
Em particular, é usado em zru \/aga.
programas.

Com o programa executa algumas operações sem um usuário especificando -
por exemplo, aceita ou transmite qualquer informação do inter-
Neta.

pagina: 14

8 Capítulo 1

Com o programa carrega e define suas atualizações, acréscimos.
Módulos de expansão ou outro software sem o conhecimento e o consentimento do usuário.
Esta propriedade é inerente a muitos programas de espionagem e extremamente
O chá é perigoso, porque carregar e instalar atualizações e adicionais
Os módulos são secretos e geralmente levam a operação instável
Tópicos.Além disso, mecanismos de atualização automáticos podem ser
Usado pelos atacantes para introduzir o PC do usuário
Módulos de Trojan.

Com o programa modifica as configurações do sistema ou interfere em
O funcionamento de outros programas sem o conhecimento do usuário.Por exemplo,
O módulo espião pode alterar o nível de segurança nas configurações
Navegador ou alterar as configurações de rede.

P O programa modifica os fluxos de informações ou informações.
Exemplos típicos são extensões diferentes para o programa
Oitichokk Ehrgez $, que, ao enviar uma carta, atribui seus
Informação.O segundo exemplo comum é a modificação de
severa da Internet (uma publicidade está incluída nas páginas
A formação, algumas palavras ou frases se transformam em hiperlinks).

Nesta classificação, deve -se observar especialmente que o programa
Categorias de zru \ idade não permitem controlar remotamente o computador e não
Senhas e informações confidenciais semelhantes por conta própria
Criadores - ações semelhantes são específicas de outra categoria de programas -
"Tgodap" e "Vaskooog".No entanto, em muitos parâmetros do programa de categoria
5ru \ "Age são parentes dos programas de Trojan.

Tendo falado sobre os programas da categoria Zru \ Age, vale a pena se concentrar em
No rastreamento implícito do usuário.Suponha que o usuário
Um programa inofensivo foi instalado, carregando banners de publicidade um
Uma vez por hora.Analisando os protocolos do servidor de publicidade, você pode descobrir como
frequentemente e há quanto tempo o usuário trabalha na internet, a que horas, através
Qual provedor.Esta informação estará disponível mesmo sob condição que
O programa apenas enviará dados sem transmitir nenhuma informação
ção.Além disso, cada versão do programa pode baixar publicidade por
um endereço único, que permitirá que você descubra qual programa está sendo carregado
Anúncio.

Zru \ m!

Quase todos os programas para a busca de programas aa \\ Age/5Ra \/Aga Detecti-
o So -chamado "Zeru \! Age construído5" (em alguns casos deles
Ligue para uma hora 8).Como teste, o autor verificou seu computador
Com a ajuda do conhecido ad-a \ mago ze reghopa!, E ela descobriu e

pagina: 15

Classificação de programas nocivos 9

oferecidos para remover 164 "Haskkshe host5", e a maioria dos encontrados
Prokents foi criado por sites bem conhecidos, em particular: gatyg.g., N $ e.gi,
Noport.Como resultado, muitas vezes em várias conferências que você pode
Leia mensagens sobre este conteúdo: "Eu tratei o computador e
encontrou várias centenas de espiões que meu antivírus perdeu/anti-
Espião " - e então a análise mostra que era sobre o edifício5.

Em relação à construção, você pode definitivamente dizer que estes são texto comuns
arquivos que não são programas e não podem executar nenhum
Ações Shinon ou Trojan no computador do usuário.Apenas
Operação unida "espião", realizada com a ajuda de construir, consiste em
A capacidade do site de salvar algum texto no computador do usuário
Dados da tabela que serão transmitidos durante a visita subsequente das vendas
Aquele que manteve.Classificações, balcões e fitas de banner podem
Use o edifício para um tipo de "marca" do usuário.

Site no site de classificação
sistemas

Contador contador

Computador do usuário

Arroz.1.1.Esquema de interação

Suponha que o usuário visite dois sites contendo em seu
Páginas medidor do mesmo sistema de classificação (Fig. 1.1).No
Pelo menos duas operações ocorrerão - a página carrega de
Site A (Etapa 1) e Entrando em contato com o site do sistema de classificação (Etapa 2).Na explosão
Snoles nttr A resposta do sistema de classificação contém um campo, prescrevendo
Para manter o navegador para construir um sistema de classificação para o site, no resultado
O navegador Tata retém o Strave em seu banco de dados.Então o usuário
Visita o Site B (Etapa 3) e há um Site de Re-Contatação
sistema ting (etapa 4), durante o qual o edifício é transmitido, preservado
Na etapa 2.

pagina: 16

70 CAPÍTULO 1

Tendo recebido e analisado a extensão, o sistema de classificação reconhece o uso
Calle.Para isso, em regra, o atribuído ao usuário é armazenado na construção
Número único.Como resultado, o sistema de classificação não pode apenas consertar
sutura o fato de visitar o site, mas também rastreia a "trajetória" das transições
Em sites cujas páginas contêm contadores deste sistema de classificação.
Além disso, o sistema de classificação pode resolver várias estatísticas interessantes
Tarefas - por exemplo, determine o número de visitantes únicos para
um certo período, o número de usuários permanentes, periódicos
visão.Além dos estudos estatísticos, identificação
Usuário com ajuda, o respeito permite que você lide com o "envoltório"
Niy ou Banner Shows.

É importante observar que, com a ajuda da construção, qualquer site pode se registrar
o fato de uma visita repetida, mas não pode determinar nenhum pessoal
Dados do usuário.A exceção é o caso ao usar
O próprio Tel entregou quaisquer dados ao servidor, preenchendo formulários de registro
On-line.Mas mesmo neste caso, esses dados são muito raramente armazenados
medíocre em Zea - geralmente eles são inseridos no banco de dados do lado
U!

Assim, acontece que, na opinião do autor, o perigo, que
É fervido pelo "espião" construído, condenadamente exagerado.PKEGIYG EKHRYUGA ALL
versões permite que você desconecte a técnica do ZIU, na versão 6.0, existe um possível
cenário mais sutil - todos são divididos no principal
(preservado pela página visualizada) e terceiros (re-preservados
recursos carregados de outros sites).Uma possibilidade semelhante de aviso
Assistindo aos navegadores alternativos de Mo'Sh Eeneuh e Oreugh.

AA \ M!

Aa \/aga (sinônimos Ada \ Age, Ad-U/Age, etc.)-Este é um aplicativo,
As informações para o usuário PC Informações para um personagem de publicidade
Thera para a demonstração subsequente dessas informações ao usuário.
Duas categorias do programa AA \\ Age podem ser distinguidas.

Sobre os programas distribuídos de acordo com o AZ / License.Dados do Programa
reproduzir a publicidade como pagamento implícito para seu uso,
Ao mesmo tempo, a publicidade deve ser mostrada apenas enquanto estiver usando
Programas no contexto de suas janelas.

Sobre um aplicativo independente projetado para reproduzir publicidade
Nós.Tais programas, como regra, são disfarçados de detecção e
O usuário pode ficar irritado com o usuário.Anúncio
A formação é geralmente exibida na forma de janelas pop -up, embora conhecidas e
Shchiroko aplica métodos mais exóticos para demonstrar o

pagina: 17

Classificação de programas prejudiciais 11

LAMAS - Por exemplo, a introdução de informações de publicidade na área de trabalho em
o tipo de papel de parede ou usando as possibilidades de implantar
Elementos na área de trabalho.

Você pode formular várias regras que devem aderir
Programa de rios distribuído por licenses de AA \/AGE.

C Ao instalar em um PC, o programa deve alertar o usuário sobre
o que é ach \/aga-aplicação com o esclarecimento do fato de que
Batizado pelo termo "inferno \/aga".Ao mesmo tempo, o instalador é
As esposas proporcionam a possibilidade de se recusar a instalar um aplicativo (e
É melhor oferecer opções de instalação- AA \/idade
Opção ou conhecimento pago \/variante de idade).Um exemplo típico de "correto
As instalações de Noah "são o gerente da inclinação da lacuna, que honestamente
Oferece duas opções de instalação - AZ \ Magic ou ZPVAG \!
Não é acidental como exemplo-um número de programas anti-zru \/aga
Por um motivo desconhecido, eles consideram o software de espionagem e removem).

Com ACh/u/módulo de idade deve ser uma biblioteca carregada com AZ \ Age-
programa durante o trabalho, ou parte inextricável da idade
programas.Nesse caso, o carregamento da ACH \ Age-Module deve naturalmente
prosseguir ao iniciar o pedido, descarregamento e rescisão do trabalho -
Ao descarregar o aplicativo da memória.A introdução de Achu \ Age- é inaceitável
Módulos para outros aplicativos ou sua instalação para a AutoStart.

Com o módulo AA \ U/AGE deve reproduzir informações de publicidade apenas em
O contexto do aplicativo chamou.A criação de adições é inaceitável
Janelas ruins, lançando aplicativos de terceiros, abrindo alguns \ e5-
Páginas.

Com o módulo AZ \ uag não deve executar as ações inerentes aos programas
Categorias zru \ Age.

Com ACH \ Age-Module deve ser encontrado com a instalação dele
aplicativo.

Como é fácil notar, para o aplicativo AZ \/AGE nesta classificação
Existem requisitos sérios e praticamente nenhum módulo de ACh \/AGE
Satisfaz todos esses requisitos.

TGO] AP-Bomb

Programas da categoria de tgodap-oou/Tuoadeg (o termo "tgodap-oo \ upyadag"
Introduzido pelo Kaspersky Laboratory} já mencionado, então você deve dar
Definição para esta categoria de programas.Tgo} ap-oo \ chishoadeg-this
programa (módulo, asiuh, biblioteca, etc.), o principal objetivo
O Torra é uma carga secreta unanquizada de um software

pagina: 18

12 Capítulo 1

Provisão da Internet.As fontes mais famosas
O \ pyuadeg são sites de hackers.O próprio Tgodap-Dodepoa4eg é
A regra não representa uma ameaça direta ao computador - é perigoso precisamente o que
que produz carregamento de software não controlado.
Tgodap-oo \ ishoadeg é usado principalmente para carregar vírus, Trojan
e programas de espionagem.O mais famoso em estatísticas do autor é
Tgodap-ooo \ new.19 vag, tgodap-ooozisishoadg.
Para \ moadeg.Tgoap-ro \ vyodoadeg.u/p32.19vag e
TGOAP-OO \ IPOADEG.LP32.
para várias modificações e sua prejudicação - sua aparência em
O computador leva a um aumento acentuado no tráfego e à aparência no PC de muitos
Programas estrangeiros.

Todos os programas da categoria de tgodapoo \ revogam podem ser condicionalmente divididos em
Duas categorias.

Com o Universal Tgodap-Bomimoa4eg-can, carregar qualquer programa
o código de qualquer servidor.As configurações podem ser armazenadas localmente (em
arquivo de negócios, registro) ou carga de um site específico.

Com TGOS especializado;
Tipos estritamente definidos de programas de trojan ou espionagem.Endereços
e os nomes de arquivos neste caso são rigidamente fixos e armazenados no corpo
programas.

OAEG

Categoria P!
Os nomes do Rog-Buayg, atribuídos a eles na classificação do laboratório
Persky) são bastante difundidos e destinados a resolver
Várias tarefas associadas à proibição do servidor especificado e ao estabelecer
com ele comunicação moderna.Os programas dos programas são usados ​​principalmente
sites pornôs, mas todos sofrem com eles- muitos programas
RII POEAG Use métodos de instalação muito degustados (usando
Asnuah, tgodap-vulpoa4eg), e a instalação pode ser iniciada
É e ao visitar quase qualquer site.

A organização de uma conexão moderna com o servidor do proprietário do pino pode
produzir de várias maneiras:

Oh disque o número e instale as conexões com seus próprios meios;
C criar um novo composto de acesso remoto;
Com alteração compostos existentes de acesso remoto.

Nos dois primeiros casos, o PES, em regra, atrai atenção de todas as maneiras possíveis
o usuário para si e a conexão que ele criou - se copia para todos

pagina: 19

Classificação de programas prejudiciais 13

Lugares disponíveis (nas pastas rggat eisa, umaaoo \ u $, \ utam5 \ zit, start
isto.p.), Cria rótulos, se registra no início automático.

Freqüentemente, além de resolver o principal problema do programa do tipo OUEEG,
Tarefas inerentes a programas de outras categorias (AZ \ Age, Zru \/Aga,
Tgodap-ro \ puadeg).Alguns Reg se preparam para o AutoStart,
Introduzido em outras aplicações- por exemplo, o autor é conhecido pelo Rbuzeg, Reg.
Cortando -se como uma expansão da linguagem!
TII de qualquer aplicativo M! Uma zombaria do AOS usando scripts.

Alguns programas como Gumeg podem ser atribuídos com segurança ao Trojan
Programas (e muitos fabricantes de antivírus consideram O1a [
O programa- no local dos fabricantes de Mopop Alu sobre Ouayg, ele diz
Xia “Programa de Trojan destinado a Lly ...”), na classificação do LABO-
Kaspersky Paramedia é uma categoria especial de tgodap.playg,

Além dos utilitários, as permissões para a categoria de O14EG são frequentemente referidas
NY Utilitários para assistir sites pornôs.Eles se comportam de maneira semelhante a guaeg,
Somente em vez de uma conexão moderna estão conectados a sites fechados por
Internet.

Em uma nota

Você não deve confundir o OM!
Discando tomético para o provedor.Eles também são chamados de "Oh; a! Por exemplo", mas em
A diferença do malware é definida pelo usuário e trabalho-
mas de acordo com suas configurações.

Vno (agora não! Reges {)

VNO (nomes alternativos - VGO \ Zegeg Naveg Ochen, Vggzeg Rivt,
Vagzeg Vag, [E Wag, Oe Wag, etc., na classificação do Kasper-
Há uma subcategoria de reboque, por exemplo, az \ y/aga.ToaG.a2 Seaags) - este
Expansão de um navegador ou programa de e -mail, como regra,
Pólen na forma de um painel de controle adicional.VNO tem vários
Recursos estímulos -ilegais.

Com os VNOs não são os processos do sistema- eles funcionam no contexto das sobrancelhas
Zer e não pode ser encontrado no despachante de tarefas.

Com VNOs são lançados com o navegador e podem controlar eventos,
relacionado ao trabalho do usuário na internet (de fato, para isso e
pretendido).

Eles trocam uma rede sobre o VNO, usando a integração AR1T com um navegador.Por-
Isso do ponto de vista da maioria pessoal de troca de Erie \ Man
Um navegador lidera um espinho.Como resultado, para detectar essa troca e
É muito difícil interferir com ele.A situação é sobrecarregada pelo fato de que muitos

pagina: 20

74 CAPÍTULO 1

VNO, declinando na categoria "zru \/aga", transmitir informações após
Millet User - isso torna praticamente impossível detectar
troca estranha com a Internet.Porque vai contra o pano de fundo de útil

Tráfego.
73 erros no trabalho do VNO podem desestabilizar o trabalho do navegador e
Desenhe para diagnosticar falhas em seu trabalho.

Apesar dos recursos descritos, o VNO não é necessariamente prejudicial
A aplicação do nariz- por exemplo, são executados por
painéis de ghnology para e, simplificando o trabalho com os mecanismos de pesquisa

(Fig. 1.2).

& AVOSH: Mike _ Mkgoza 1 Togrey Ekryuga

Arroz.1.2.Navegador com o VNO instalado

Vários VNOs universais são conhecidos, que são configurados
A maneira das ferramentas.A configuração geralmente é armazenada no formato
HMA e pode ser editado pelo usuário ou desenvolvedor.

Nuaskug

A tradução literal deste termo parece um "ataque", "ladrão",
Pirata aéreo.
o usuário é indesejável para ele, perseguindo os objetivos de seu

pagina: 21

Classificação de programas prejudiciais 15

funciona.Fabricantes de muitos agentes antivírus incluem programas
Somos as categorias de programas NTSaskag para Trojan.

A tarefa mais comum da classe da classe do ntzaskag é
Renastação dos parâmetros do navegador, e-mail ou outros aplicativos
NY sem permissão e conhecimento do usuário.Em fontes estrangeiras de automóvel
RU Havia uma definição de nuakug, como utilitários que mudam
Configurações do navegador sem o usuário sabem.

Na maioria das vezes, os programas da categoria NSPAGEG são usados ​​para mudar:

Na página inicial do navegador - a página inicial é substituída pelo endereço
Site dos criadores de Ntsaskug;

A partir das configurações do sistema de pesquisa do navegador (essas configurações são armazenadas no registro).
Como resultado, quando o botão "pesquisa" é pressionado, o endereço é aberto,
Pista pelo programa NTSASKKEG;

Em prefixos de protocolos;
Com níveis de navegador e configurações de segurança;

Da reação do navegador a erros.Por exemplo, várias variedades são conhecidas
Nuaskug, substituindo páginas padrão piegpag ehr |
em particular, descrevendo um erro com o código 404) por conta própria;

Da lista de endereços ("favoritos") navegador.

Em sua forma pura, Nuaskegg é relativamente raro, porque na maioria das vezes
O programa realizado pode ser atribuído além da categoria
"Nuasaskug" para as categorias "TGOAP", "P1EEG" ou "AZ \ U! Age/Zru \\ Aga".

TGO] AP (Programa Trojan)

O programa Trojan é um programa que executa ações,
Frone contra o usuário.Ela coleta e transfere para os proprietários de con-
Informações de fêmeas sobre o usuário (esta categoria também é chamada
Tgoap- $ ru), executa ações não autorizadas ou destrutivas.
É fácil perceber a partir da definição de que o programa de Trojan é
"Relativo" de programas da categoria de $ ru \ aga - a diferença, como regra, em
O fato de Zru \ Age não ter uma ação destrutiva pronunciada e não
Unte informações confidenciais sobre o usuário.No entanto, a questão de
atribuir o programa a uma categoria específica bastante controversa (geralmente
Acontece que uma empresa antivírus considera um determinado módulo az \\ Age,
O outro - o programa Trojan, o terceiro - geralmente ignora).

pagina: 22

16 Capítulo 1

Vaskaog

Vaskk4oog é um programa cujo principal objetivo é
Controle secreto do computador.Vask4oog pode ser dividido condicionalmente
Nas categorias seguintes:

Com o Vask4Oog, construído usando a tecnologia cliente-servidor.Tal Vask4oog
Consiste em pelo menos dois programas - uma falha do programa,
instalado secretamente no computador surpreendido e programas
Gerenciamento instalado em um computador de um atacante.Às vezes em
O conjunto de configurações também está em andamento;

Com vaskaogs usando teps construídos para controle remoto,
\\ EB ou servidor 1KS.Para gerenciar esse vaskdoog, não é necessário
Software de cliente cyal.Por exemplo, conhecido
Vaskkaoog, que estão conectados a um determinado servidor 1b e use
ele para troca com um atacante.

O principal objetivo do Vaskdoga é um controle secreto de um computador.Como
Regra, Vask4Oog permite copiar arquivos do computador afetado
Por outro lado, transfira arquivos e programas para o computador afetado.
Além disso, geralmente o vask4oog permite que você obtenha acesso remoto para
ESTR, execute operações do sistema (recarregando o PC, criando novos
Recursos de rede, modificação de senhas, etc.).Vaskdoog está se abrindo essencialmente
O "fundo" de ataque no computador do usuário
O Vaskocho aumentou recentemente devido ao fato de que muitos
troca de redes e vermes postais ou contêm componente vask4oog,
Ou instale -o após a infecção do PC.

Noé

Noah é uma família relativamente jovem em desenvolvimento de maliciosas
programas.Eles ficaram generalizados em 2005, observar
Sia uma tendência constante de crescimento no número de suas variedades.

Na tradução literal de Noah - "Decepção; mentiras, mistificação, não verdadeira",
A tradução do termo reflete com precisão a essência de seu trabalho.A ideia de Noah -
Decepção do usuário, na maioria das vezes com lucro de gelatina.

Considere o trabalho de Noah em um exemplo.O exemplo mais típico de
Esta categoria é Noah.Consiste em um único
O arquivo preenchido, que após o lançamento carrega e instala e instala
Programa "anti-shpion" de $ Ru \ uagemo cerca de 900 kb e re-
Ele abriga no início automático.Depois disso, Noah.
O desktop faz um menu inacessível da mudança de papel de parede.Aparência
A tabela de impulso é mostrada na FIG.1.3.

pagina: 23

Classificação de programas prejudiciais 17

-.

Burrmlagay
Vesmagemo "em ribfesnop (vobiteiuu flgoausia}

V

Arroz.1.3.A área de trabalho de um computador afetado por Noah

O programa estabelecido por ele é Zru \ Agemo, por sua vez, exibe no TRIA
ícone.Quando o cursor do mouse está pendurado nele, uma janela pop é removida
com a mensagem "Não. RGOISNOP" ("Não há proteção") indicando entre parênteses
Extremamente perigoso para o computador.

Clique neste ícone abre a janela de Zru \ AGEMO, no qual o re-
Além de "varredura".A palavra "digitalização" não é indicada acidentalmente em
forragem, porque na referência licenciada uddo \ $ xp este scanner
Encontrou 15 programas de Trojan (incluindo vários espiões do teclado
Novo, conta -gotas, inundantes).Em frente a todos os supostamente encontrados maliciosos
Os programas no protocolo foram uma nota de que há um risco mais doloroso de seus
Disponibilidade no PC do usuário (Fig. 1.4).

É verdade, há uma sutileza zru 'atrás não mostra o caminho e os nomes de encontrado
Os arquivos feitos, que não permitem que o usuário exponha imediatamente a fraude.
Para o tratamento, é necessária uma chave licenciada e uma licença de um ano
Custa 38 euros.Após o recebimento de uma chave gratuita para três lnies, este
um grama cura os vírus inventados por ele e elimina a substituição da imagem

pagina: 24

18 Capítulo 1

Desktop, criando a aparência de tratamento rápido e eficaz.Ana-
Toges de Noah.
Todo mundo tem a mesma imitação de infecção por PC e um anúncio para pseudo-pagamento pago
antivírus.Essa publicidade é naturalmente uma ordem de magnitude mais eficaz do que simples
Achu/y/aga, já que o usuário criou artificialmente uma situação em que
O enxame que ele precisa de um produto anunciado.

Uriagemo!Sogygo!Rava!

Beck & eu e mas rei beshz tbogtafop) 18
Ennie Remaeu e Bara Toya Bull Rog)

4

Loadchmat Cho

Arrasada e?

$ ela

Eu grito

Zee EUA Sonyae VA.

Aiis ss ex

Fraude ao ar livre de Zrobolkia: Ale tauv 5 nozes] Zositgy Beki Seva Relagi Ola Tez

Arroz.1.4.`Antishpion" Zrumagemo e os "vírus" encontrados por ele

Outra direção de Noé é o engano direto do usuário- por exemplo
Medidas, o programa pode se passar pelo gerador de códigos de códigos para pagamento de serviços
Operadores divididos (na maioria das vezes MTS ou Veep), um programa para hackers
sistemas de pagamento eletrônico.Um recurso de todos os programas disso
novidade é a necessidade de entrar no usuário de não ativo
um cartão de pagamento, números de cartão de crédito ou para- similar
medidores, que são então transmitidos ao criador deste programa e podem
ser usado por ele a seu critério.De fato, esse programa
pode ser considerado Trojan, mas, por outro lado, ela não a mascara
presença e não rouba dados pessoais, pois os benefícios ingênuos
A própria Vatel lança o programa e insere as informações necessárias.

Outro tipo de Noé pode ser chamado de letras nas quais, como
regra é relatada sobre a detecção em um determinado sistema de pagamento (mais
total \\! ebtopuu) vulnerabilidade, que consiste no fato de

pagina: 25

Classificação de programas prejudiciais 19

santuário em uma carta para enviar uma certa quantia para a carteira especificada,
Depois de um tempo, o pagamento retornará, mas de forma dobrada.Natural
mas que não há vulnerabilidade no sistema, e a carteira indicada nas letras
Pertence ao atacante.No entanto, usuários crédulos de
cair nesse truque.Como em outros tipos de Noah, os dados de cartas
não pode ser considerado prejudicial (uma vez que neles, de fato, mesmo programas
nenhum código).

Chamado estatística
Vários tipos de malicioso

Considere as estatísticas coletadas em 2005.É baseado em re-
Análise da imprensa de casos de infecção de computadores e redes de computadores,
estudou para o ano.Com base nos resultados, você pode construir um diagrama refletindo
A porcentagem dos programas maliciosos detectados (Fig. 1.5).

Chasamage
Não. Vaskaog |
Erro
Eta aa \ ogt |
Sh
m namtos
Sh Noah
Amém \ Just apenas
Wa ap]
m toap-spskog
|Eu sou o AP-Bomioaceg
2% 13% 3% em Tichap-OGORRRE
-1% No. gozi-rgohu
0% sh toal- Rem
Não. Rob-5ru
Vp

Arroz.1.5.Estatísticas para 2005, refletindo a prevalência
Vários tipos de malware

Nesse caso, cerca de 8 mil programas estudados são considerados,
do que todas as amostras são ttu!(Sh-ta-\/e, isto é, um programa malicioso,
descoberto em condições reais em computadores infectados de uso

pagina: 26

20 Capítulo 1

lei).Deve -se notar que essas estatísticas refletem não a quantidade de
computadores de esposas e o número de variedades detectadas são prejudiciais
programas de nariz.

Como pode ser visto nas estatísticas, a categoria mais comum acabou sendo
TGOAP-POS \ EUDEG (carregadores de malware) e depois vá para o AD \\ Age,
Programas de Trojan e Vaskdog.O resultado do grupo por categorias
Mostrado na FIG.1.6.

Arroz.1.6.Estatísticas com um grupo por categoria

A parcela dos programas de Trojan de vários tipos foi de 57% dos estudados
Amostras, 21% - ah \/aga.Com base nesses números, pode -se argumentar que para
O ano passado foi descoberto por um grande número de variedades de prejudiciais
programas que não possuem mecanismos de auto -proliferação.Grande
O número de variedades de tgoap-oo \ loa4eg confirma esta conclusão e
nos permite falar sobre uma tendência estável de infectar um computador em não
Quantas etapas:

1. A introdução de um pequeno programa da classe TGODAP no computador.
Rompyadeg e seu lançamento, que podem ser realizados usando vulnerabilidade
Vimosti ou engenharia social.

2. TGOAP-OO \ Luadeg envia secretamente
conjunto de computadores de componentes nocivos - como regra, é ou
AZ \ Ate Programs, ou TGODAP/VASKDOG.

3. Com um dano de dois estágios a um computador, você pode observar frequentemente
Dê "o efeito do coma de neve" associado ao fato de que carregava e definiu
Os próprios programas portadores de vreel de nozes são o TGODAP-RO \ ITUADEG.
Além disso, alguns tgodap-po / loadeg estão registrados no início automático

pagina: 27

Classificação de programas prejudiciais 21

e restaurar os programas de Trojan carregados por eles no caso de seus
Remoção pelo programa de usuário ou antivírus, dificultando
O próprio tratamento de um computador.

Tendências de desenvolvimento
programas maliciosos

A análise de programas nocivos nos permite argumentar que existem
Tendências estáveis ​​de Stereon.

Com a prejudicação dos programas de Trojan aumenta- muitos deles são
Lena por roubo de senhas e outras informações confidenciais.
Um vazamento de tais informações pode causar danos graves e em
Muitos casos associados à perda de informações, um vazamento de configuração
dados de negação ou perdas financeiras.

O uso comercial do Trojan e Vaskdog-
programas.Os líderes são os chamados bots- esses são híbridos
Programas Yang e Vaskdouge projetados para girar o
Esposa computador em zumbis.Computadores infectados podem ser exemplo
para resolver vários problemas, como regra, para conduzir
RRRO $-é ou um boletim informativo de massa de spam.

Com desenvolvedores de malware, exótico exótico
Métodos de início automático e implementação no sistema.Por exemplo, três
Programas Yang instalados como um monitor de um sistema de impressão,
Prov 8 $ $ P/MP [, Expansão do Condutor e Uldurop.Alguns
Programas maliciosos usam tecnologias virais, introduzindo seus
Código em componentes do sistema.Um exemplo clássico é
U! Gi $ m!T32.M No. AB, atingindo a biblioteca do sistema mipteg.p.Isso é por
A essência não é um vírus, mas um pequeno código de Trojan, implementado em Mshesega!
Princípio do vírus.

C em vários programas maliciosos trabalhando com a Internet e uma rede
Um código de programa foi descoberto, o que permite neutralizar o interno
Rima] uipdo \ $.A base da metodologia é que as configurações
Este \ maio é armazenado no registro e uma modificação do registro pode ser ou
Desative -o \ ma | n ou adicione um aplicativo arbitrário à lista
leal.

C em vários malware, um código destinado a
Detecção da presença no sistema de monitoramento de fundos (CESM,
BETAGE) e Debuggers, lançar em um computador virtual (mais frequentemente
No total, o lançamento da mente \ aga é detectado).

pagina: 28

22 Capítulo 1

C] Para o envio em massa de programas de Trojan, seus desenvolvedores começam
Use os serviços de spamers.Como resultado, torna -se possível
um programa malicioso para um grande número de computadores para
Um pequeno intervalo de tempo.

Além dessas tendências, uma ampla disseminação pode ser observada
Tecnologia Goky.COO \ e tecnologia são bastante simples em desenvolvimento, em
A Internet pode ser encontrada muitos textos iniciais do estado pronto
Wok e bibliotecas para sua construção.Como resultado, desenvolvedores de prejudiciais
e os programas de espionagem levam a Goo {Ki-Technology em serviço e
Eles mudam para mascarar a presença de seus programas no PC infectado.
e a introdução do código do software em outros processos.

pagina: 29

Capítulo 2 = P

Tecnologias de programas maliciosos
e os princípios de seu trabalho

Neste capítulo, consideraremos os conceitos e princípios básicos, exemplo
consultas em programas prejudiciais.Atenção particular será
Diletado três tecnologias.

Sobre os bosks.Esta é uma tecnologia, amplamente utilizada, lírio é costurado de prejudicial
programas de detecção e exclusão, bem como para a espionagem para o benefício
Vatel.

Com espiões e tecnologias de teclado que são pretendidas, pretendidas
NY para rastrear secretamente o trabalho do usuário.

Sobre outras tecnologias, em particular, métodos para proteger os programas da remoção
nia, tgo] ap-ro \ mupua4eg ​​e tgoap-ogorrgeg, métodos de uma paixão \ ma |E
Rastreando a atividade da rede.

Deve -se notar que este capítulo descreve os mais distribuídos
Métodos nativos, a maioria dos quais de uma forma ou de outra se encontram
Xia nos Pu \ u/-Doters.

E -ki

O termo "ki ki" historicamente veio do mundo do MX, onde sob este terminal
O NOM é entendido como um conjunto de serviços públicos que o hacker define em um hacking
Eles têm um computador depois de receber acesso inicial.Isso é em regra
Lo, ferramentas de hacker (túneis, scanners de rede) e todos os tipos de
Programas de Trojan que funcionam autonomamente ou misturando o principal
Utilitários OMX.Ki Ki permite que o hacker ganhe uma posição em um sistema de hackers
E esconde os traços de suas atividades.

pagina: 30

24 olhos 2
-
No sistema \/!
É introduzido no sistema e intercepta funções sistêmicas, ou aleatórias.
Substituição de bibliotecas do sistema.Interceptação e modificação são de baixo nível,
O AR1-Functionia permite que você resolva vários problemas: |

Com um disfarce da presença de Rutkin e programas relacionados a fortes
O Rutkit moderno pode mascarar processos avançados, abertos ..
Portas tsr/ur, chaves de registro, arquivos de disco;

Com proteção contra a detecção e remoção do software antivírus.
Leitura e utilitários destinados à Llya da pesquisa do sistema, PS.
Boa proteção consiste em bloquear a modificação de certa chave,
Registro, proteger os arquivos da abertura e exclusão;

Sobre rastrear ações do usuário.Por exemplo, várias rotas são conhecidas.
interceptar as funções de bibliotecas que garantem o trabalho do
Zhniya com uma rede.Isso permite que Rutkin analise o Exchange Exchange.
Modificar as informações recebidas por aplicativos.

Recentemente, a ameaça de rotas se tornou cada vez mais relevante, pois
Desenvolvedores de vírus, programas de Trojan e software de espionagem
O apoio começa a incorporar ruttes-technologias em seus prejudiciais
programas.Um dos exemplos clássicos é o Trojan
TGODAP-5RU Programa.
um sistema com a ajuda da rutka-technologia.Este programa é interessante
Que seu mecanismo Rutkin funcione perfeitamente em \/taomz 95 \ 98 \ iu \ 2000 \ xp

Por uma luta eficaz com oblíquo e é necessário entender os princípios '
mecanismos de seu trabalho.Condicionalmente, todas as tecnologias de cookies podem ser separadas por N8
Três variedades:

Sobre trabalhar no modo de usuário (Shzegmoda).Esta variedade com "
Convidado para a interceptação das funções das bibliotecas do regime de usuário;

Sobre trabalhar no modo núcleos (Kagpe! Moda).Baseado no driver Keti
Moda que intercepta as funções do núcleo ou o conjunto
como filtro de motorista;

Sobre trabalhar no modo núcleos e em Zegmod.Um típico em
Interceptador de fechamento, que reage ao lançamento do processo
Carregando e executa a biblioteca modifica a instalação do NLI
Modos-overclocks.

P O termo "rootkit" implica uma aplicação prejudicial.KOTOR
Usa interferência no sistema para atingir seus objetivos."..
A tecnologia de interferência no trabalho de Ar1-funcin (o chamado Rutkt-Techno.
gia) pode ser usado para resolver problemas úteis - por exemplo.=
Monitorando o sistema, resolvendo os problemas de depuração e perfilirs8 ""
garantir a segurança e várias outras tarefas.

medidas =
sa "
Ser "

pagina: 31

Programas e princípios maliciosos de seu trabalho 25
Eh

|/Zegmode oo \ ki

Antes de considerar os princípios do trabalho da trança do regime de usuário
Está lotado para considerar brevemente o princípio de chamar as funções misturadas em
M são conhecidos pelo método BASIC LVA e em aplicações reais frequentemente

Ambos os métodos são usados.

Vinculação precoce (funções estaticamente importadas).Este método é
novo sobre o fato de o compilador ser conhecido pela lista de importados
grama de funções.Com base nessas informações, os formulários do compilador
A chamada tabela de importação de EHE.A tabela de importação é
Uma estrutura especial (sua localização e tamanho são descritos no cabeçalho
EHE-FILE), que contém uma lista de Bib-
Liotek e uma lista de funções importadas de cada biblioteca.Para
Cada função na tabela tem um campo para armazenar o endereço, mas
O endereço de compilação DII não é conhecido.No processo de carregamento de EHE-arquivos,
O tópico analisa sua tabela de importação, carrega todos listados em
Seu Osh.e faz da importação de endereços reais para a tabela
As funções destes O. a ligação precoce têm uma vantagem consequente - em
O momento de iniciar o programa todo o reu necessário é carregado
esposas, a tabela de importação é preenchida - e tudo isso é feito pelo sistema sem
participação do programa.Mas a ausência no processo de carregamento especificado em seu
Importar Tabela 01. (ou ausência em 011. A função necessária)
leva a um erro na carga do programa.

Posterior ligação.Difere da ligação precoce naquele carregamento
SERIA.É dinamicamente com a ajuda da função do AR!Toaaagagu.
Esta função está no Kegp!
Técnicas de Skim, então Kegpe!Usando
Toa94igagu um programa pode carregar a biblioteca de interesse nele
A qualquer momento.Respectivamente, para obter um endereço de função
Função de tecla é usada!SetRgoslagzez.Para não ligar
Vespoles Thez antes de cada chamada das funções de Osh, programador
feridas para determinar uma vez os endereços das funções de interesse nele e

Existem em uma matriz ou em algumas variáveis.

Esquema geral

Tarde

Sh

||e a esposa do esquema corresponde ao preenchimento de endereços na tabela de importação
Ka é 1º.Esta operação é realizada pelo carregador de inicialização e o erro
Plataformas para carregar uma das importações da biblioteca descritas na tabela
O anexo para interromper a carga do aplicativo.Chamando a função (Etapa 2)

Você é controlado no endereço que é retirado da tabela
G `

Sobre MA chamando as funções da biblioteca no caso de usar cedo e
A ligação é mostrada na FIG.2.1.

pagina: 32

R
<

Capítulo

26

„R ipyanaf

Vadotia
Epiioe1

Ir'irum

niHoloid iohoevimenii iiphyanaf e30 = 199 EMEKHO ‘1.*e 'ema

$ $ a: pp \ uzo1 429
Avalem
Prssechau

Arl Iipyanaf
Ir'irum

$ $ Earruzoklae
Keyuro7
Ir'eaeiu

Iiphnaf
Zoya Ichnitsy]

V. Docia

= Donoch epicde1

FUN1

Ichaloidid
Iipyanaf
Ai!969296

"Waokh Ianniyi]

pagina: 33

Novi de malware e princípios de seu trabalho “27

Aqueles

Ligação tardia, o aplicativo deve primeiro carregar o babador
inchaço com a função do goaat+betac e depois determinar os endereços do inteiro

Suas de suas funções existentes usando a função de Berygosaaasez (Etapa 4).Então

E a chamada da função desejada (etapa 5) é invadida pelo maduro na etapa 4

endereços.
Em uma nota

Carregando da biblioteca usando Goai!
É universal e funciona em \ m/pd $ 9x e \ u/pd $ mt.Forma-
Os sistemas são possíveis uma segunda maneira de carregar bibliotecas e trabalhar com eles- com
Poder das funções de B* de m9n.chi.Em particular, a função do kommersant permite
Faça o download da biblioteca, tagbsesrgos4 igeayayezze retorna o endereço da função
por nome.

No OVCH

Independentemente do método de ligação do sistema, é necessário saber quais funções
PII Exporta 014. Para isso, cada OM.Há uma tabela de exportação.
Esta é uma tabela especial, que lista o O. exportado.
Funkini, seus números (águias) e endereços relativos das funções (KUA).
A localização da tabela pode ser encontrada analisando o título da biblioteca.

Bibliotecas dinâmicas, por sua vez, também têm uma tabela de importação e
pode carregar dinamicamente outras bibliotecas (etapa 6), a este respeito
A luta entre a lógica da biblioteca e o aplicativo não é a essência
e.Portanto, a maioria dos métodos descritos posteriormente pela interceptação de função
Viy ar!Aplicável para bibliotecas.

A derrota do processo do chzegmode-rutkita de qualquer tipo pode ser condicionalmente
Divida em duas etapas principais:

Introdução no espaço de endereço do processo do código do motor do rootkit, em
Em particular, contendo funções interceptadoras;

a moorificação do processo ou as bibliotecas usadas por ele é assim

para que, ao chamar as funções interceptadas, a gerência recebe a função
Tsnya-interceptor.

Métodos para introduzir o código da máquina no processo
Juízes
Maioria
Perelih

Azdel

Utes Vários métricos de introdução do código da máquina, considere

é comum e popular deles.Na colocação do código

tick, independentemente da metodologia de interceptação do osegomode-rutkita, você pode

Dois grupos.

Rutkuts u

º?
B

babador;
Lyo
Na corrente

que são o código da máquina dos interceptores no Dyna
Ibliotek.Nesse caso, o problema é que tal
C OP deve ser carregado no espaço de endereço de interesse

Ssov.A vantagem do método é a simplicidade do desenvolvimento e depuração

pagina: 34

28 CAPÍTULO

- ddchianba> y> rbf rplialula
Funções interceptadoras.Desvantagem - a aparência de um estranho
Teki no espaço de endereço de todos os processos é muito perceptível.

Com o código da máquina é introduzido diretamente no processo de processos

A introdução da conta.Usando armadilhas

Este método é o mais simples.Interceptores de código da fundação.
Ele é registrado na biblioteca OSH e a biblioteca é carregada com ajuda.
Eu costuro o mecanismo de armadilhas u/lpdo \ m.

Considere o exemplo mais simples da introdução da biblioteca de Trojan em todos
Os processos de ST executados.Para fazer isso, precisamos de um pequeno
TKA com a única função do subside, cujo texto é dado na raposa.
Ting 2.1.

] 1rgaGu Seze_*9;

// Exemplo de demonstração da introdução de Trojanskaya
Izd

IztptUser,

\ 1prgosz,

Meszatez;

Uag
Não -OKNAP] 1E: superior;// ataque devolvido por beti1 poshnook

// Function-Processor do interceptador
Eapse1op nookrgos (psode: 1GPAEDEG;
IRAgash: poderia;Tragap: topatpe): GoPoste;Ztas 1;
Bedp
// chamando o próximo na corrente do manipulador
Vezi] {: = sa11111mehehenoheh (nooknepa] e, psode, escória, tragalm);
EPA;

// Instalação do interceptador
Rgosediga zenoookk;Zeyasa11;
Bedt

// Instale um interceptador como em setmeszas - para todos os eventos

pagina: 35

Nomers de malware e princípios de seu trabalho 29
Aqueles

Nosknapa1e = 0 kep
: = Zeo \ e1paosmnoke (in_tmeszas, @nookhrgos, ntpztaps, 0);

2

Nooknapa1e

PA;

}/ Remoção do interceptador

Re1Nook;5%9S11;

Esse
;Nskosnapa1e <> 0 ENEP OF TROURS
WOLVES1 PAOCHESOSKOKH (NO -OKNAP] 1E};
Rooknapa] e: = 0;
ETA:

[comeu

E funções exportadas:

Chry5
Ze-nok,
B1NOK;

E
Yuknapa1e: = 0;

A biblioteca de feridas servirá como um modelo para exemplos subsequentes (no caso
m para o espião do teclado), por isso consideramos isso com mais detalhes.
“O edema contém três funções: interceptador e duas exportáveis
Ulcations Zesnok e Ra1nok.O interceptador executa a única tarefa -
O interceptador a seguir chama o seguinte na cadeia e retorna o controle.

\ Kion ze <Nook é responsável por instalar um interceptador com a ajuda de uma função

Noé.Antes da instalação, é feito um cheque que blocos

Instalação de energia.A função de OE1nok, respectivamente, remove o interceptador
SE CHAMADO AR1-FUNÇÃO OPPACOOKOCHOCOST.

E

Observamos que a instalação e o interceptador liquidado

Em ‘Wow, pode ser colocado no próprio OM.(como neste exemplo)
Imagem OE, Apêndice.

Zann

Este exemplo é uma instalação do tipo Nook em setMezzasa -

NYA.A função de chá dos Nookrgos é causada antes do processamento de todos os relatórios
"Participou das funções de Semeszade e Rexesade do aplicativo.

pagina: 36

30 Capítulo 2

Em seguida para verificar o trabalho de nosso OSH.É necessário criar um não rolo
Lugus-carregador, uma das opções de implementação é mostrada na Listagem 2.2.

_ Listagem 2?Carregador ob

SOP5E

Munookonmat = '6º $ 9,911';

EOPSE1OP BEYONOK: Gopaz p;$ E9SA11;Ehhegpa1 munooo mate;
RORSSE1OP BEPHNOK: GOPA1TA;ZE4SA11;ECHFEGPA1 MUNOIL para mamãe;

($ 8 *. Ay}

Rghosedige togp .5 epbeeNoxss11SK (5 7: Tobessa);
Hack

Peso1fr1epez: oioovo;
Problemas1p

// Instalação do interceptador

Senoocke;

Peso1r1puz: = placas de ab.

// forçado enviando a mensagem
VGOAASAZ+5UZEEPEPMEZADA (B5E_ ROVSETENOMOMS DE FIREUTHMENSEVEVEVEVEVEVEVEVETAZ,

@Weight1rlepuz, Mind Mom, 0, 0);

Véspera;

RGOS de Theopia1.
Problemas1p
Oh] recanto;

EPA;

comeu.

Neste exemplo, depois de instalar o interceptador usando
O carregador VGOADSAZAZ5UZZHEPMEZADA envia a todos uma mensagem a todos para todos para todos
Para garantir o carregamento do nosso OA.Em todo o processamento co-
sendo processos.

pagina: 37

Programas e princípios maliciosos de seu trabalho 31

Ele é apresentado.usando fluxos remotos

A introdução de O. criando um fluxo remoto deve
Recursos tímidos:

Este método não funciona em \ umpdz 9x - define uma função
Sgeaheeecofothotheaaa, mas não é realizado e é um plugue,
médico ao chamar Ragze;

C] Este método permite que você apresente.em quase qualquer processo
Os sistemas, enquanto o uso de armadilhas permite introduzir OG.
Somente em processos C;

Com a implementação seletiva da OM.um ou mais lançados
processos;

S], se necessário, a introdução do OI, nos processos lançados
O gargalo de Rutkin deve implementar o rastreamento do lançamento da fuligem.

O algoritmo de implementação O. usando um fluxo remoto parece:

1. O processo é aberto com a ajuda da função dos ovarGosezs.

2. No processo do processo, um buffer é distinguido usando uma função
U1GSIA1A111SH para armazenar o nome baixado 01.1.

3. No buffer usando Ig1HergoSZEZZMEPOG, uma linha com o nome é copiada
SOBRE..

4. Crie um fluxo remoto que execute uma função
Goaa11ytahu.

5. Se necessário, aguardamos a conclusão da execução do controle remoto
atual, após o que liberamos o buffer selecionado e fechamos a lancet.

A implementação dessa metodologia no idioma é demonstrada nos piolhos
Ting 2.3.

Listagem 2.3.Uma função que apressa o processo GibPiotek usando
Cem chatice
Eipsetop tkogi].Tpzeseooorgosuz $ (art: @muoga;
A01] MATA: ZEG1PA): BOO1EAP;
Uag
} Rgosezz: tnap] e;// NAP@1º processo
WETOTETAKEA &: TNAPA1E;// Nap@1e Remote Stream
Mateviere: Rosee;// Endereço de boofer chamado OB
Toaat1rgahureg: Rosaeg;// alres funções goa@11.
MopyEvussep1esep, tngeadtie: zygoga;

pagina: 38

32 Capítulo 2

corte
Dirigindo \: 1e: = eaz;
Vrgosezs: = 0;BVeposetgea: = 0;Mamevviereg: = p11;
+gu
// 1. Abra o processo
Vrgos5 $: = iprgoseuse5 (US $ 5 cinzas, assez $, eashe, argo};
1e vrGoseze = 0 ENUPS OF TOURS1P
Azyatog.D ('Erro de abrir o processo');
Ex1;
EPA;
// 2. Crie um buffer para o nome do BS na memória do processo
MateVieg: = u1gsza1a] OSECH {rprgosaz, p11,
Tepdev (JSC 1, +1,
Meme Sommtt, raça de veaomatta);
1e mashevyersg = p1] bedtp cego
Azayatom ('Erro de destacar o buffer na memória do processo');
Ex1 {;
comeu;
// 3. Copie o nome no buffer
1e Poe (Iggsergosezmetogu (Prgoszz, masheverig,
RSRG (mãe AO),
Hepen (AB1] Mashche) +1,
Moleguevuseszismg1tep))
Azesu {'' Erro de gravação na memória do processo ');
Ex1;
EPA;
// 4. Realizamos a determinação do endereço Kegpa132.911!
ToA913IGUGUREG: = BeerHosayagzz (BEMODODI1NAPA1E ('Kegpa132.411'),
'Goya1ygagua');
1e toaa!
Achtodogod ('errato de determinar o endereço 1yuad111rgagua');
Ex1s;
EPA;
/!5. Crie um fluxo remoto
Imory -Based: = sgeaseVeto+etvGead (Prgoszz, 0, 0, 0,
Toaa1gugureg, mapeviereg,
0, Tweata);

pagina: 39

Tecnologias de malware e os princípios de seu trabalho

1e ausetegaya <> 0 problemas ePep

// 6. Esperamos o fim do fluxo (esperamos 5 segundos)
MA1REROG51P91E0B] EU (PVETOSETGEA I, 5000);

Ve5z] e: = ehgaea;

EP E15E

Achtodogod ('erro de criação de um fluxo remoto');

p
// Libertação da memória e fechamento do fluxo e processo NAPD
1e matevaureg <> p1] EPEP

1 tepa1 vetebh (vrGoseze, maschevireg, 0, mem de vegaz);

1e betosetNetgeaya <> 0 "vep

C1ozenap 1e (peretotheeaa);

1e nrgoseUse $ <> 0 b

C1ozenap] 1e (prgosez);

EPA;

EPA;

A função do tp] eyoyokhorgosezes deste exemplo é introduzida por pl.com indicado
o nome no processo fornecido.Neste exemplo, isso é realizado em
Cinco estágios:

1.

O processo de abertura é aberto.Em nosso exemplo, abrindo
O processo é realizado com a bandeira do Dragusa de $ $ $ ag asse5 $, o que dá
Somos o nível máximo de acesso ao processo aberto.

Após a abertura bem -sucedida do processo, o buffer é alocado em
Memória do processo usando a função \ u1ger1a111h.Esta função
Semelhante às funções \ u1gea1a11os, mas recebe outro parâmetro -
Processo de lançamento.Em caso de execução bem -sucedida, a função retorna
O endereço do buffer selecionado da memória.Um ponto importante é que
Este é o endereço no espaço de endereço do processo afetado e para gravar em
Ele precisa usar funções como o IG1HerGosezzMeToge.Tamanho
Um byte é alocado pelo buffer do que o necessário- adicional
Bayt é necessário para armazenar a linha de acabamento de zero.

Usando a função de ig1eergrosezzzetoge, fazemos uma gravação do nome
Oh, em um buffer dedicado.

Realizamos os preparativos para o carregamento da biblioteca.O buffer com o nome dela foi criado
E preenchido, resta determinar o endereço da função do Boad111IGAGU.Em que
Deve -se lembrar que essa função existe em duas versões -

pagina: 40

34 Capítulo 2

Tokyzgagua e Roadt4ygakui.Nosso exemplo usa
Goach1gagul, no caso do uso de roadezrgakuya no buffer, é necessário
Coloque uma linha chamada O. no formato do opyode.

5. Uma chamada é feita por Kommersant com a ajuda de Sgeeveopovetheaa.
A função Goaagzgagu nos parâmetros coincide com a função de fluxo -
Ela recebe o único parâmetro como Ochovo (o endereço da linha com o nome
Bibliotecas) e retorna ao mesmo, contendo o nal@{e carregado.

Em uma nota

Neste exemplo, há dois pontos não totalmente corretos-
É que o Kegpe!
Cheio da etapa 5 e carregado no mesmo endereço que o KETA!
o processo.

Introdução do código da máquina usando UTIA!

Este método é muito fácil de implementar (Listagem 2.4), mas o principal
A dificuldade está relacionada à preparação do código implementado - deve ser
misto, ou antes da introdução do código, é necessário fazer
construção de endereços.

Pysting 2.4.Um exemplo de introdução de uma memória de código da máquina do processo

RAPS 1OP TRAGES].
Avy $ 12e: 1 Pedee;Akipsode: Boo] 1EAP): Rospbeg;
Uag
Vrgosezs: tnap@1e;// NAP@1º processo
Betzhegaya: tnap@1e;// Podpy1 do fluxo remoto
Mipentusitos da complicação, Tugeayata: Dromo;
Hedzl
LESSE E: = 11];
Vrgosez $: = 0;Naepustengeaa: = 0;
Esu
// 1. Abra o processo
IrGoseze $: = oosparGoseze (Raoshesis $ Ash, Assez5, Ertze, Arto};
3e vrGoseze = 0 snap Bell4T4T
AAYATEL4D ("Erro de abrir o processo ');
Ex {;

EPA;

pagina: 41

Programas e princípios maliciosos de seu trabalho 35

// 2. Crie na memória do processo do buffer
Vezi: = u1Lgets1aposh (prgosez $, p11,
Avi $ 4 aqueles
Mem Sommtt,
Ras ekhoSota_veoiyetta);
1e vezo16 = n} 1 6 neps de problemas
Azatom ('erro de destacar o buffer na memória do processo'};
Ex1 {*;
EPD;
// 3. Copie o nome no buffer
1ª vitória (deles1berhgosmoka (prouossez5, ve501t,
Aviereg, Avae $ 1,
Miper'Goevusig1e b)) PEP TROURLOS
Escultura 9 ('Erro de gravação na memória do processo');
Ex1s;
EPA;
// 4. Nós realizamos a criação de um fluxo remoto
+E AVIPSODE Sparter} p
BVETOSETAIA;
8za11] 1 <, p11,
0, tigaata);
1e BayPoseTeaaa = 0 EPEP
Azayatoy9D ('Erro de criar um fluxo remoto');
EPA;
E1pa11u
{E pvoposetigay <> 0 EPEP
C1ozenapa1e (nepogetvgea);
1º $ $ <> 0 "pep
C1O5enapa1e (PCHOS $ 5);
comeu;

EPA;

Como é fácil notar, a função do GP] essosbodorodurosezz em comum com o pré-
Um exemplo respeitado (consulte Listagem 2.3), no entanto, há vários excelentes significativos
Chiy.A principal diferença é que, ao chamar uma função
O buffer alocado U1A1A111SAH é atribuído a atributos de proteção

pagina: 42

36 Capítulo 2

Rase_ehosote veaoivtte, que permite que você execute neste buffer ma-
Código dos pneus.A segunda característica desta função é que
O buffer de linho da memória não é liberado quando a função é concluída.
Em caso de chamar a função com o parâmetro do Awesode = Egiy,
A integridade do código registrada no buffer com a ajuda do sgeevveto+etnkeach.

Métodos de interceptação de funções

Vários métodos de interceptação de funções são conhecidos.Os principais são:
Na interceptação da modificação do código da máquina do aplicativo;

C) interceptação da substituição dos endereços das funções;

Com a modificação de interceptação do código da máquina de funções.

Cada um desses métodos tem suas próprias vantagens e desvantagens,
tanto do ponto de vista de sua eficácia quanto do ponto de vista da simplicidade,
o trabalho e a confiabilidade do interceptador.

Modificação de interceptação
O código da máquina do aplicativo

Esta técnica é baseada na modificação direta da máquina
Código responsável no programa de aplicativos por chamar uma função específica
ção arg.Esta técnica é complicada na implementação, pois há um nível multinível
Na linguagem da programação e versões dos compiladores.Além disso,
Um gramista pode implementar uma chamada AR]!-Funções de vários métodos.
Mas teoricamente é possível, desde que a implementação
Entre em um programa pré -dado da famosa versão.Neste caso, já
Dutel Rutkita pode antecipadamente seu código de máquina e
Trabalhe o interceptador (Fig. 2.2).

A vantagem indiscutível de tal método de interceptação é um complexo
sua detecção e neutralização.

Intercepção da substituição de endereços das funções

A interceptação das funções do arg usando a substituição do endereço é um dos
mais conhecido, em particular, graças a uma descrição e exemplos detalhados
No Livro de Richter [1].

O princípio de operação de tal rootkit é baseado no fato de que Rutkit encontra no memorando
as informações da Tild Teden do programa e modificam os endereços daqueles de interesse
suas funções para os endereços de seus interceptores (ver Fig. 2.3).

pagina: 43

Tecnologias de malware e os princípios de seu trabalho

Eo ozonniptei izipechifichoi 1eahe43 \ 1 2-2 `EIA

$ 5a1rrru20ldeo $ 59: pp \ u50.499
“Arl iipyanaf av: confie“ ar iipyanaf yedreot
IR "Pruum IR`2E18U2EU AH,

Iiipunaf
Wahh ichnnitva {

E1boi

V. DOTSIM VADOTSYE EPICDE.
Epiidv/ epicdv

pagina: 44

Capítulo 2

EODEE IONZITOTZ IIPHNAF 1ZHA4 ETS *$ *2 ‘EMA

$ $ 91RR \ U/ 202199)
Arl Iipyapanaf Yuezareol
Ir'irum Ir C1EASH

Izymyanaf
Uaz Ianni |

E1Docy

E440C9H
Epiitoi/

Epizde]

38

Nie)
„Art Iipyanaf Azdvkv
Ir'irum iresheshchekh

IEE1oidid
Iipunaf
Iitoevchech
‘Oh Iannity {

pagina: 45

Tecnologias e princípios de seu trabalho 39

Os endereços iniciais das funções interceptados são lembrados, o que permite
O editor para transferir o controle da função interceptada.Respectivamente c
O momento de chamar o programa interceptado de ar [-função lê seu endereço
Da tabela de importação e transmite o gerenciamento para este endereço.No momento do
Funções WA (Etapa 2) O aplicativo transmite o gerenciamento no endereço indicado
Na tabela de importação - como resultado, o controlador recebe o interceptor Rutkin.
Tendo concluído algumas ações, o interceptador de raiz pode causar interceptação
a função e, se necessário, altere os resultados de seu trabalho.
Por fim, o interceptador retorna o gerenciamento do aplicativo e
O aplicativo nem suspeita da presença de interceptação.

A modificação de endereços de aplicações avançadas pode ser realizada dois
eu por métodos.

Com uma construção periódica de uma lista de processos e processamento de suas mesas
importações.Este método tem uma desvantagem- o programa pode determinar
despeje os endereços das funções com a ajuda do Seergosadagzz e lembre -se deles em alguns
Macacão interior de Thorus.Portanto, a modificação de endereços na tabela é
Porta desta aplicação e interceptação de besrgosayadgzz depois de alguns
O tempo depois de iniciar o aplicativo não terá o efeito não o seu trabalho.

Com a instalação de um interceptador para criar um processo ou carregar osh.E
A inicialização do programa do programa (tabelas de importação/exportação 01.) em
O momento de carregar.Em particular, pode ser colhido pela interceptação
Funções PEE11.411: Koahroaa011.Existem opções conhecidas em que
O motorista está envolvido no motorista - instalando a interceptação de segling
conduzido pela moda Keta, o exemplo mais famoso são as variedades
TGODAP-ZRU.M/P32.VAPKEG.

A interceptação da substituição do endereço em qualquer caso envolve a modificação
Exportações no momento do carregamento de Osh.e instalando interceptores em
Sbergosazagzz- para substituição de endereços no caso de sua determinação dinâmica
escada.

Deve -se notar que a interceptação da substituição do endereço pode ser realizada como
no nível do aplicativo e no nível de qualquer um dos biblos
Texto (neste caso, o esquema da Fig. 2.3 permanece relevante, apenas a raiz
ET na tabela de importação da biblioteca).Essa interceptação é mais difícil de detectar,
Como é necessário analisar as tabelas de importação de todas as bibliotecas
Cess.Na maioria das vezes com rutcetas desse tipo, a tabela de importação é modificada
Kegpa!
Funções de 91.91.Uma das rotas mais comuns como
O tipo é az \/idade.
O método de interceptação para mascarar da detecção, o próprio interceptador é colocado
Está no arquivo pt 914e70.ac.

pagina: 46

40 Capítulo 2

As vantagens dessa abordagem (do ponto de vista dos criadores do Rutkin)

Mnnnes:

Sobre nenhum imposto na interceptação do Syerhosadagzz - Aplicativo de Usuário
Os endereços reais das funções são emitidos;

Sobre não há perigo de que até a introdução do interceptador o aplicativo
Conseguiu determinar os endereços das funções e lembre -os de algum lugar;

Sobre o ponto de vista dos anti -respondentes básicos, essas interceptações são menos
perceptível.

Então, vamos passar da teoria para a prática.Considere um exemplo, realize
Intercepção de qualquer conjunto de funções em um ou mais apego
EU.Ao mesmo tempo, apresentaremos vários
Requisitos:

Com um exemplo deve ser feito na forma de 0] ... tal implementação é conveniente
Do ponto de vista acadêmico, uma vez que vários métodos podem ser aplicados
Introdução deste OG, em processos.Além disso, colocado em Osh,
O código é fácil de rastrear e depurar;

Sobre a modificação da tabela de importação deve ser feita como em
a localização e em todas as bibliotecas usadas por ele.

Listagem 2.5 contém o texto inicial da função do ver1aseTelech,
A modificação ágil da tabela de importação do módulo especificado.

Voriniaaai aaa agat gararachevai saari easi aaaa para olaelali

Pisting 2 5, Fumitia Rardasetatvleu |

ROPS1OP GADE GESKOKUEPHUTORAK (VASE: R1PIECH;
Marredaztate: Vuesevo!
03 HESSHGHUYOPUGA: Mosha;Uah $ 1 = e: queimado): rospeykhg;3%e 4CA11;
EHEGP] '1TADER1R.A11' PAMA 'TGADA01HESSOCHUEPUGUTORAK';

/!Substituindo o endereço amodi do módulo TAT O1 \ Aarops em MEMRAPS
EIPSETOP VER1ASEAGADEPEKU (AMOA1E :; Mododo] E; Arlmatsche: Zyokh1pa;
Olaraeus, memripoe: rolleg): booseap;
Uag
TAT_612E $ O NO.;// tamanho tat
Tyrochoisse1reogrek: p \ \ iAda1irogeozskareog;// assinatura para tat
Zb srozieBese1Reog: rgpada1 treogeozssurog;
Trolkrek: Rochovo;
O1arayosee, pneu: ACOM;

pagina: 47

Programas e princípios maliciosos de seu trabalho 41

Problemas1p
Kezi1+: = ya] ze;
// 1. Pesquise tat
Tyro'Vezskareogrek: = ttader1kheshouhuepegutobach (r1piech (amodi1e),
TRÊS,
Tmase vaity emteu tmrokt, tat_ $ 12e);
// não encontrado - a continuação da análise adicional é impossível
1e trocherezstaregkreg = p1] 1 ex1 {;
Gzparoubezskareog: = p11;
// 2. Pesquise a seção de importação de O o nomeado Au1ymat
M511E TProgeBessagoGograg.
1e (1zhegstft (rspag (amodo1e + gpirogoogeozsu1reogreg. Masque),
Rsvag (ag1mapma)) = 0) Evep Bund1p
Gabtprogerest4reoga: = progebezsa1reogreg;
// 3. Procure o endereço da função interceptada na tabela
Tropcrekh: = Bromovo (amodi1e + 14bttrogebezkarsog. P1 khazetpopk);
I611e llopkroh^ <> 0 para problemas
// Endereço encontrado?Nesse caso, cumpriremos sua substituição por um dado
1e (rofpeieg (tthlkreg^) = o1arops)
// Configurações de proteção - vamos escrever nesta página
U1 Gep1rokoyesee (Namelkrog, 4, Rase Vearitte, O19RGoves®);
// Registro
E: 1 -YOKESMETHHU (BESAESKAPERKOSEZZ, TIDACREKHG, @Mecheapse, 4, tar};
// Restauração de atributos de proteção
U1gktsa1rkhoeesee (tbopkrog, 4, o1arkhko®es, galeria de tiro);
VE5 $ 01E: = EGAI;
EPA;
TLS (TBAPKROH);
EPA;
EPA;
Tppa (progbeza1rtokreg);
EPA;

EPA;

Esta função é semelhante à função descrita no livro de Richter | 1), mas
Tem uma diferença radical no algoritmo do trabalho.Ela recebe o endereço

pagina: 48

42 Capítulo 2

Módulo Gram na memória e parâmetros da função interceptada - nome
Bibliotecas Au1ymama, o endereço atual da função O1EAPS interceptada e
O endereço do nosso interceptador de função Menropskh.O trabalho começa com uma pesquisa
[No módulo especificado.O TAT pode ser encontrado de duas maneiras principais:

Com a ajuda da função TTADA0: Gescohujujethutorat Library pparr.p.
Esta função é muito conveniente porque fornece documentação
um método para encontrar um endereço da estrutura necessária na imagem de um re-arquivo
em mente.As informações sobre esta função podem ser encontradas em M $ zoma.
Em nosso exemplo, passamos para o parâmetro dela para a vastidão do vasto.
Solicitar o endereço de AT;

P analisando a imagem do re-arquivo na memória.Para conduzir um semelhante
A análise é necessária para o conhecimento da estrutura dos cabeçalhos do cabeçalho.

Em seguida, vê todas as seções de importação, para cada seção do
Uma comparação do nome da biblioteca com o nome dg1shmashchi, transferido para o par
Medidores de funções.No caso de coincidência, as bibliotecas coincidem
Assistindo endereços de funções - no caso do endereço do endereço com o endereço O1AGIPS
Sua substituição é feita em memórias.

Deve -se notar que a implementação de uma função semelhante dada em [1]
Contém erros e deficiências suficientemente significativos.

No exemplo de Richter, a visualização das seções do TAT é feita antes da detecção
A primeira seção de importações da biblioteca com um determinado nome.Ao mesmo tempo,
Supõe -se que essa seção seja a única que não corresponde
realidade.Um exemplo visual é o aplicativo,
Bonnoye para Ora, - Um compilador de reinado pode criar em |No AT
seções para uma biblioteca.Portanto, para a interceptação correta
é necessário ver todas as seções de 1AT- é isso que faz o dado
Naya na Listagem 2.5 Função.

No exemplo de Richter, a busca pelo endereço da função interceptada é realizada antes do
Entrada Vogo.No entanto, o padrão não impõe uma proibição clara de muitos
Uma indicação maluca na tabela de importação da mesma função.Incluindo
Para confiabilidade, é necessário visualizar todo o endereço do endereço
funções.

Antes da modificação da memória com a ajuda do chh1 tergosezzmetoga, é desejável
Obviamente, defina os atributos de proteção por meio de U1: = P1RGOTYK.

Para instalar os interceptores mais simples na maioria dos casos descritos
Listagem 2.5 é suficiente, mas não garante interceptação de todos
funções.A razão está no fato de que o re-arquivo pode ter um segundo
Paradise Latch, projetada para implementar o mecanismo de carregamento atrasado
(Por analogia com o PSPI@hez $ (zat) Esta tabela pode ser reduzida
Mas para ligar para o RT (Realidade [Tapa Trail)).O princípio de operação da carga diferida

pagina: 49

Programas e princípios maliciosos de seu trabalho 43

consiste no fato de a função importada usando a carga diferida
As ções estão listadas no re-arquivo.No momento de iniciar o programa,
Chick não processa o OL, carregando as bibliotecas descritas nele e pesquisa em
Não há funções.Já que não é conhecido com antecedência.Quando At-
O decice precisará dessa ou daquela função, de contém sinais em
um pequeno serviço de função de serviço, o que aumenta o
Compilador de grama.No momento de chamar a função, o adaptador recebe gerencial
Lamentação e sua tarefa é carregar a biblioteca necessária, pesquisar
funções e a introdução de seu endereço no git (para mais detalhes, consulte a função
__e1aagroaan1reg2 No arquivo Aoyauir.crr, o arquivo pode ser encontrado em Izia!Ministério das Relações Exteriores).
Uma característica importante da implementação desse mecanismo é que
A carga falsa é baseada nas funções padrão do KEGP!
TOZ@T1GAGA e SEGOSADAGZ5.Portanto, interceptação dessas funções
afetará a carga diferida.

Em uma nota

A carga diferida é implementada pelo aplicativo, não pelo sistema operacional.
Portanto, se desejado, o programador pode alterar o trabalho - funções
_ e1aagroaaan1reh, tendo percebido sua função úmida e conectando -a a
o mecanismo da carga diferida.Nesse caso, o programador pode ser implementado
Pegue qualquer metodologia para carregar a biblioteca e procurar funções, incluindo não -an
Dardo.

Portanto, além de interceptar funções editando [em
Analise e modifique os endereços no OHT.Algoritmo de análise de análise
Análise lógica do TAT e é dada na Listagem 2.6.

Listagem 3.6.Zunction, ‘Naucing Modelation _P Modepy determinado
em mente

// Substituição no RT do módulo Amoda] E Endereço O19EAPS no Menrops®

Ropsesop ver1tase puttapagu (amodo1e: nmodi1e; Atlmasche: zeg1p9; o1araps,
Moiropse: rolpeeg): boo] 1ep;

Waah
OTT $ 1 = E: OTOMUS;// Tamanho do GT
Gpore1aubesk: ryoao1au0zsk;// ponteiro para ott
Glttara1Aubezsg: rtisoba1aurovsk;
Tiopcree: BRriovo;
O1arGoses, pneu: Amoka;
Voive1;BMOACHECH;

Problema p

Vezi1%: = #a] ze;

pagina: 50

44 CAPÍTULO 2

// 1. Procure PT
Tta0e] Aubezsg: = ttada01 kutobak (ro1 ped (amodi1e), seu, seu, seu,
Tmase_ polostovu_tvu reaU tmrovt, ott_ $ 12e};
// bt não é encontrado - uma continuação adicional da análise é impossível
1e a0e] aubesk = p11 e kopep ex1 {;
bgp9be1aurassk: = n41;
// 2. Procure a seção B1au Trphe de Osh, com o nome Aymate
IR11E G9BE?Juar para mamãe <> 0 para problemas
// Contabilização do método de endereçamento VOA/\ UA.
1º ipob1aubesk.
E15e voive]: = 0;
1e (135 kgstr1a (rsbag (voava] + gid0e} aubesk. Guab mãe), mãe),
Rsbau (ag 1ymamama)) = 0) Evep Brow1p
TAIPARE1AU0ZA: = 190E1AZSK;
// 3. Procure o endereço da função interceptada na tabela
Trillech: =.
\ p1] e creige^ <> 0 para problemas
// Endereço encontrado?Nesse caso, cumpriremos sua substituição por um dado
1e (r1piech (Creig^) = o19ropse) Enpin
// Configurações de proteção - vamos escrever nesta página
\ U1ueia1kophys* (Vuokreg, 4, Ras Voarmatt, O1argkesses);
// Registro
MU1 Serkhosezazmetogu (Besudoeperhosezz, Tpiprekh, @memrapse, 4, Galeria de Tiro);
// Restauração de atributos de proteção
U1GELA1 CRUCOSIOS® (Twilkreg, 4, O1arrokoyes®, pneu);

FIRs: = vinco;
EPA;
Tps (tumlkrsg);
EPA;
EPA;

TS (90E] AU0ZSU);
EPA;

comeu;

Nesta função, o chamado dos Tatadeos do Keskokubpugutata é realizado com par
Medidor tmase_ proobvotov emtvu oybach tmrorort (o valor dessa constante é 13).

pagina: 51

Programas e princípios maliciosos de seu trabalho 45

A estrutura do giab1aubessg difere da estrutura do tmadegirohezeskareog,
Como para a implementação de importações atrasadas, você precisa de uma gorjeta de adicional
Tel estruturas.Ao analisar os campos da estrutura de Tidbe1aubesk, é necessário
Considere o significado do campo Dhakshz.Se dtaaesgz = 1, então todos os sinais na estrutura
Ture são kua (keaiuu ushpia | ah@ges $, relativamente virtual
Endereço), se 0, então ma (whitza! Inferno@ge $, endereço virtual).

É óbvio que a modificação da tabela de importação tardia não é não
Caminhando, mas condição insuficiente - permite alterar o endereço
Funções interceptadas às quais os apelos já ocorreram.Para
A interceptação de outras funções deve ser interceptada por Toaatlgag e
Beerrgosayagzz, que retornará os endereços molificados para
o carregador das importações diferidas e o código do software, que está de acordo com um ou
Outros motivos usam um carregamento dinâmico de bibliotecas.Mas mesmo em
Nesse caso, a interceptação da função substituindo seus endereços nas tabelas de importação não é
Fornece 100% de garantias de interceptação.Esta técnica tem pelo menos
Dois lugares vulneráveis:

A partir do procedimento para inicializar as bibliotecas - o problema se deve ao fato de que seu
O código do programa é executado no processo de carregar a biblioteca e neste
O momento da tabela de importação ainda não foi modificado;

Do endereço das funções determinadas pelo aplicativo até a modificação de sua guia
importações de importações - isso é especialmente verdadeiro no caso de conexão
O interceptador para um aplicativo já funcionando.

Assim, para interceptar a função do aplicativo e todos usados
Eles podem aplicar o código do programa fornecido nas folhas
GE 2.7.

Listagem 2.7.Instalador CELER em todas as bibliotecas de processos

RipSelop tpeegseroPseZOP (AU1ymat: 365x119; O1araps, MemRaps:
Ro1pheg): boo] 1ep;

Uag

Em $ parzpo: TSPA1E;

Caca: tmoda1Eleguz2;
Ser p

Vi01+: = ya1ze;
// Criando uma "imagem" dos módulos do processo atual

BBPPARNO: = SGEATTOOO1N1R32 $ PARDEN (TNZ2S $ ZMARMOROT, BEHSOGGEEP-
Rhosez314};

12 yu5 -part = tmumayto namga uagsheyu evep

Ex1;

pagina: 52

46

Capítulo 2

P32.4M52E: = $ 1H0E (tmodi1eOptsgku32);
3E (mod1e32e1xz* (nbPrust, p3z2)) ‹vep
Aqui no
// Modificação da tabela de importação

Ver1aseetatepsu (thez?

// Modificação da tabela de importação atrasada

Ker] aserttephu (me32.modi1e, atamato, o1araps, Menrops);

I1e1] poe (mod1e32mekh+ (bild, Cheek2));
S] oznap1e (bzparpeSu {);
Veso1 {: = gie;

EPA;

O primeiro molul da lista criado com a ajuda da função
SGEASETO111P1R325PRAPOS, é o próprio aplicativo.Seguindo em frente
A lista de módulos é feita pela chamada da função dos modi2mers, que em

O caso de execução bem -sucedida preenche a estrutura do canto2.

Usando a função do tpegserReROPSE1OP, você pode executar o mais simples
Interceptação - Primeiro, interceptamos a função do meszadevokh, responsável por
Conclusão da mensagem na tela.Código do interceptador

Dado na Listagem 2.8.

Listagem 2.8.Um exemplo de interceptar a função de Mesvyvok

Ture
Timezadevoi = eOPSE1OP (VIPA: NIMO;
Tracthe, 1rSare1OP: rapz1svag;
OTUR: OTMT): TPSEDEG;Z &@9S11;
Wagh

019 Mazzadevo: tmezzadevoha;

// função - interceptador
Ripsozop pummeszadevoi {VIP: nimo;
TRADECH, 1RSARE1OP: RAP51SVAG;
OTUR: OTMT): TPEDEDEGK;Ze@sa11;
Bebê
Vezi] e: = o019 mazzadevoi (nip, 1rtech,

pagina: 53

Programas e princípios maliciosos de seu trabalho 47
No Systoooo Ooo OOSOSSOSSLYO LLC LLC LLC LLC Soso Soso Soo Soso LLC LLC com Sosoooooooossoss OOS OSO Soso OOS Sost OOS OOS SSO SSS

Rspat ($ 5119 (1rSare1OP)+'(função interceptada!)'),
atura);

EPA;

Vermelho p

Meszadevokh (0, 'Mes5ade1 ‘,' vsook: ze ', 0);

// Lembre -se do endereço da função

301 yaimezazadevo: = cyrgsayazgaz5 (bandomodenapa ('115 $ USK32.4911'),

'Mezzadvoha');

// Nós interceptamos

Tpbegserips1op ('e $ eg32.411',
@01amezadevokha,
& Tumeszadevoi);

Meszadvoha (0, 'meszade2', 'asotk1s', 0);

EPA.

O trabalho deste exemplo é reduzido para interceptar a função de Meszachevo.Ré-
A aderência aumenta a mensagem exibida no cabeçalho do texto "(função
interceptado!) ", neste caso, o primeiro desafio exibe a janela da mensagem antes
Interceptação da função, a segunda - após a interceptação.Para baixar osh.interceptar
Chika é necessário um pequeno aplicativo de carregador, cujo texto original
Rogo pode ser encontrado no catálogo com este exemplo.

Nosso exemplo se aprofundou no desempenho das funções de interceptação, mas
Ele realiza apenas metade do trabalho - as funções de Toaatyakaku e
Bersadkezz ainda não está interceptado e o aplicativo pode ser metade
Leia endereços reais das funções interceptadas.Portanto, é necessário
Retorne nosso exemplo adicionando o seguinte funcional a ele
Nost:

Sobre o tempo de interceptação da função, as informações com ela devem ser inseridas na tabela
O rosto de nossa rutkita.A presença de tal mesa permite que você remova todos
Interceptores instalados, bem como reinstalar
Rebors;

Oh, é necessário interceptar a função do Beergosadakezz e no momento do pedido
o endereço para verificar se coincide com o endereço de um dos interceptados
funções.Em caso de coincidência, é necessário devolver o endereço do correspondente
Sech;

É necessário interceptar a função de Toaat4Gagagu e depois de carregar o Bibli
A Teki modifica suas tabelas de importação.

pagina: 54

48 Capítulo 2

Considere um exemplo melhorado com este funcional
nomes.É baseado no exemplo anterior, então seremos
Veja apenas as diferenças entre o novo exemplo do antigo.Vamos começar com
Para um interceptador de Sterchosadakez, você precisará de uma tabela em que
Os nomes e endereços das funções interceptados são adicionados (Listagem 2.9).

Listagem 2.9, uma tabela de fungia sobreposta

Claro
// informações sobre a função interceptada
TikegSersetteo = Hesoga
Gagagumac: Z6G1PA;/# Nome da biblioteca
O1aripszzop: ro1puekhg;// O endereço de origem da função (antes da interceptação}
MememaooPseetop: Rosifika;// Endereço do função-resector
EPA;
Uak

NiegserserSheAgops 1OPZ15E: Aggau Oyo ttlpbegsertteo;

Consequentemente, ao interceptar a função, as informações sobre a interceptação são metade
Envie na tabela tpeegserKeyaripse1t $ 115+.Esta operação é convenientemente co-
Coloque com interceptação e execute na forma de uma função separada (listando 2.10).

_Pistimg 2-10.A função de melhoria

OPSEDOP TPEEGSERIPSA1OROREH (AI1OMATE, AGOPSMESCHE: 3114; UAHG O19EALES
: Ro1lseg;MEMROLS®: ROSOTEG;ABOGOAT1ZHGAGA: BOO1EAP = Yoa] 1za)}:
Boo1eap;

Ed
Vezi1+: = ea] 5e;
O1agoips: = besrgosayayagzz (Begmodo1enap 1 e (rsvah {Ata b)},
Rsrvag (aropmama});
3E (O19 Rapse = 111) APA ABOGOA91 TAG & PEP
O1yaarps: = Seergosyagis $ (Toayag1zhgaku (Rspah (A] BMate)),
Rsvat (ArapeMama))};
1+ o1arips = p] Stop ex1 {;
// A função já está interceptada?
1e o1 yaraps = meyrgaps epep ex11;
Lets1e: = tpbegseroPsetop (Almate, O1arips, Memrops®)};

pagina: 55

Programas e princípios maliciosos de seu trabalho 49

Ze epo "em (1 peegersyarols1op $ b1 $ 0, tiroteio (1 piegsereyarilsezop3113e) +1);

Muie tobereeeeeeeoops1o1 $ 11 56 [gapasve (tpsedeips $ opz1 $ e} -1] AO
Ed

1AGAGUMAMAM: = abmape;
Otaaripse1ot: = o1eriris;
Memrips op: = Memrips;
EPA;
EPA;

A função do TPEEGSEREROPSE1 Open recebe o nome da biblioteca que contém
Uma função agarrada e o nome da função interceptada.Produção adicional
Há uma tentativa de obter o endereço da função interceptada usando
Beersayagzz.Um recurso do código é o uso de um grau1Enapa1e,
E não ttoaaaagaga - trabalhamos com bibliotecas já carregadas.Se
A biblioteca não está carregada ou uma função com o amarrado
Em nome, então O19ols receberá um valor de 111 e mais trabalhos da função
perde seu significado.Em seguida, você pode tentar baixar a biblioteca que contém
Função interceptada- esta operação é feita dependendo do valor
O parâmetro do arog.SAA11GAGA.

Se o endereço for definido com sucesso, então estaremos comparando o endereço com
Complete Chanter.Se os endereços coincidem, isso significa que a função já está
Interceptados - neste caso, bloqueamos outras operações.Em seguida, somos
Realizamos a interceptação com a ajuda das funções do tpeegsereepsezop.Esta função
foi examinado em detalhes no exemplo anterior (consulte a Listagem 2.7),
Isso não precisa de comentários especiais sobre seu trabalho.Finalmente, o último
Etapa é a adição de iamização sobre isso na mesa
Tpeegsereyaeopse1op $ 113+.

Então, agora a instalação de interceptores é conduzida por uma função universal,
que protege contra interceptação repetida e mantém um banco de dados de
Funções reimportadas.Em seguida, é necessário usar esta base de pista em
O interceptador syergosazagzz (listando 2.11).

Pistmong 311, o impressionador da torre

Tilsefol Pubergosadagzz (nmodo1e: nmoboba;] rrgosmate: yerszt): eavrox;
324S11;
Emirados Árabes Unidos
1: Jaedeg;
Besp
Vezi1s: = o1abergosaaisais $ s (bmodi1e, 1rgosmap);

pagina: 56

50 Capítulo 2

// Ligue para Sybesrgosaagzez retornou o endereço?
// se sim, verifique se esta função é interceptada
1e vesy1e <> p11 tmep
GOG 1: = 0 CO B "TGIBEGERSYAROPSELOP3T180) -1 Z
1 goehsehsedripseop3z1136 [1] .01arripsa1op = vezi] e bass4p
// A função é interceptada, retornaremos o endereço do interceptador
Eu tomo] t: = rolpeeg (tpeegserSyagats1OP3115% [1]. Memropso1Uop);
Vgeak;
EPA;

EPA;

Este interceptador causa a função sistêmica do sesthosayagzz (seu ad-
Remonsado no momento da interceptação na variável O19 Bergosaagezz) e
Então ele olha para o banco de dados preenchido durante a instalação da interceptação
Chikov.Se a conformidade for detectada, em vez do endereço correto do retorno
Há um endereço do interceptador correspondente.A aparência deste interceptador
leva a um trabalho completo do exemplo- agora os endereços são alterados
Superior em [AT e substituído quando solicitado através de Sejergosaagzez.

Resta resolver o último problema-esta é uma modificação de 1a-bibliotek,
baixado pelo aplicativo.Para isso, duas funções serão necessárias (listando 2.12).

Pistmne 2.12.Perkoetchik com tags de tag m fumitia, funky,
ToBagorory ok uagcostsot "
Folse1 opegereda1erips1t $ (bmoyy :; tnpai1e}: roo1eap;
Uag
1: Jaedeg;
Bedp
Buzina 1: = 0 GO GROD (TPBEGSERSEY GYPSUM 1013115%)-1 AO
Ulsv tpeegserfeargops15 $ 113e [1] zri1p
// Modificação da tabela de importação
Ver] asetateta gu (nmodi1e, gabgagumam, o1yaripse1op, memkops1op);
// Modificação da tabela de importação atrasada
Ver1ase Podtepeku (nmodo1e, gabhagumam, o1aropsezop, meigops1op};
EPA;

EPA;

pagina: 57

Programas e princípios maliciosos de seu trabalho 51

Bopse1OP Pugoaa1bgagud (1Ra Kommers: Rap $ 1SVAG): nomogot;Z%@sa11;
Bruxa

Toyaaaaa: boo] EAP;
Red1p

// Um ​​sinal de que oy.Já carregado

Toadeus: = Bemodody1NAPA1ea (1P3ye111Mazha) <> tuaabeo wrap uaBoe;
Vezi: = o19 tuaat15hagud (1rteza 1mate};

// está carregando um novo O?

1e (vesi <> tmuabto uagoya) ara cantar (toaadea)

Gzegser mod] eripse1op $ (vezi1+{);

EPA;

A função de tpegSerodi1erips {optz permite que você modifique [at-
Um módulo dedicado para todas as funções interceptadas por nossa raiz.Para
Executar esta operação aplica dados da tabela
TpeegseroPse1OPZT1ZE.Função-interceptor Pugoa9?
Está relacionado a rastrear o carregamento dinâmico das bibliotecas.Usando
Caramento wemodod] enapa1ea verifica o interceptador, carregado no presente
O momento solicitou OTR, ou não.Em seguida, uma chamada sistêmica é feita
Funções de Toaa1ygagui e verificação - se a biblioteca for carregada com sucesso e
Não foi carregado antes (o resultado do cheque é armazenado na variável
Toaaaa), portanto, sua modificação não foi produzida - então este
A operação é executada usando a função do TPEGSERODI1EGIPS {OPZ.

Portanto, a peça de trabalho de um interceptador universal está pronta.Para verificar
A visita considerará um exemplo de interceptação da função.Neste exemplo
Iremos interceptar a função do Khnipamee11, a biblioteca de Kegpe!
Monstruações de arquivos e pastas de mascaramento no disco (listando 2.13).

Pislyg 2.13.Perekhuyatchik realizando uma Maschirose.Arquivos e pastas |

Ture
Talpamekhsa1ea = rolselop (fã do PE: tnapa1e;
UAG 1Re1P9E1111RASA: Tutchz2e10oyarasaa): vog;Z%49S11;
Aqueles111i = eols op (v1pae1e: tneara] e;
UAG 1REREP9R111RAFA: TITMZ2E1PAARAFAI): VOG;3E9S11;
Uag
OTHEG1P9MEHER11E^: aqueles 1PameHee1
O1CH4 PDMEHSA11E \ -: aqueles 1PAMEKHSA11E (;

pagina: 58

52 Capítulo 2

EorsoSol murzpamehsa1111111111e (b1p9711e: Tanta] e; ug] Reelpaeg:] Erasa:
TEMMZ2E1PCHBABAA): Em geral;Z1AAS11;

Bebê
Vezo1 <;
ue vezu] 1 © para bedzp
De roses ('gooseeta', tomegsazaz (1re1pa111111ebaga.ses])) = 0 +vep ehzs;
Ve5i1e: = o] ae1pamehee111ea (vepag11e, 1O1P9E111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
EPA;

EPA;

Duas funções são interceptadas - EazpameHeleed e E1meHeg111eii.
Os interceptores são idênticos, apenas para economizar espaço na listagem é dada apenas
O interceptador da função de E1oenaea11eaa.O trabalho do interceptador é uma chamada
A função inicial (seu endereço é armazenado na variável o1ae1pmehega1ea) e
Análise do resultado.Se a função retornar a sua, a pesquisa foi bem -sucedida e
Na estrutura do Titm32e1 parafa, há informações sobre o arquivo encontrado.
O interceptador está em nome do objeto encontrado da palavra -chave "desejo" e em
Em caso de detecção, as re -recursos o13e1PaneHea11d.Em caso de sucesso
A próxima detecção de arquivo do processo de verificar seu nome repetir
É e, no caso de um malsucedido, o ciclo é interrompido e a função retorna o
Eaza mentindo, sinalizando uma tentativa malsucedida de pesquisar.

Este algoritmo de mascaramento de arquivo não está totalmente correto, então
como contém um lugar vulnerável - a função não intercepta
Eupae1gzee11e, portanto, os dados retornados a eles não são verificados.
É muito simples eliminar esta desvantagem - você precisa adicionar um interceptador
Funções de PvylyA1 Gz (Listagem 2.14).

Pistimg 2.14.Voz do interceptador de função de

Faure
Tetpaeezea1ea = bolse1op (1re11mashche: rapz1skak;
UAG 1Re1LPAG: 1RATA: Titmz2e1parafa}: ttp] e;$%@sa11;
Uag
O1ZE1RAR1YE11EA;Aqueles1pi1e5ea11e4a;

EIPSELOP Tue1TPAZESGSS RA 1EA (1Re11Emama: Rapzasvag;
UAG 1 rupae111ebata: titmz2e1p0aasaa}: tnapa] e;3%@sa11;
Puffer
Eu tomo] 1e: = o1za1pchezhezhezhe1111ea (1re1] emate, 1re1tde1111eraga ;;

pagina: 59

Programas e princípios maliciosos de seu trabalho 53
E NY AZA

/ {/ Pesquisa é bem -sucedido?
1e vezi1 $ <> tmuatzt nakoye uzheyu eenep
// O resultado retornado contém 'goosk1 {' '?
1e rosas ('koosk1e', tyimegsaza (1re1p9e111eraka.se11Emate))> 0 Enp
1e pos (elp9mehsa11ea (keza16, 1re1pche1] ebafa}) Treep be1p
M1 pom, e1p9s105e (keza1e);
WE1 $: = tmuo
EPA;

EPA;

O dispositivo deste interceptador é mais complicado que o de E: Pamehee11e.Ele chamou
a função inicial de e1p9e1kzee11e e analisa os devolvidos
significado.Se o Rap9e1gzee11e retornar tmuatto wab
significa que a tentativa de busca não teve êxito e uma análise adicional
Isso não faz sentido.Em caso de pesquisa bem -sucedida, a função retorna a soneca,
Nesse caso, o próximo cheque é realizado- a estrutura é analisada
Tura 1ReRepae11Raka e o nome do arquivo contido nele é verificado.Se
Ele contém a palavra -chave "estado ki", então uma tentativa de pesquisar
O próximo arquivo usando e1pamehee11ed.Deve-se notar que você-
A função interceptada por nós é chamada - portanto, ela encontrará
Um arquivo cujo nome não contém a palavra -chave "gooki" ou retornará
Eaz, sinalizando que não há arquivos adequados.Nesse caso, produção
O fechamento do NAPFA e o retorno do valor armazenado em Kez
Tmuaoto namoye uata.Se a função for e1pameheer, você retorna a sua, então
O arquivo adequado é encontrado e seus dados são retornados ao aplicativo em
Estrutura 1Re1 Paya: 1ª mulher.

OBSERVAÇÃO

Duas opções idênticas para a implementação do código LISS são colocadas no CD
Tings 2.5-2.14 (On Be! E no MSGOZA C).

O trabalho deste exemplo é fácil de verificar, complementando o exemplo pequeno
Aplicação - carregador.O resultado do trabalho do exemplo deve ser
"desaparecimento" para o momento da operação do nosso treinamento de rootkit de todos os arquivos e
Pok contendo a palavra "gooki" no nome.Ao mesmo tempo, as aplicações são anti -
As baleias devem detectar a aparência de um interceptador de função, como
Exemplo, considere o protocolo AU7.(Listagem 2.15).

pagina: 60

54 CAPÍTULO 2

}
PISTMMG 3.45, protegeu o analisador da AU?com um exemplo negligenciado |

Análise de Kegpa132.011, a tabela de exportação é encontrada na seção.

Kegpa function132.a911: chá rupagless1 (209) interceptado,
RGSAZAZATEZ $ N1FASK.SERGOSAAAGUZ5 $ -> с624808 <> 7S813559

Kegpa function132.911;Elochmehee1] ea (218} interceptado,
RGSAZAGEZE Método) Ask.Sertosaaayagezza;-> C62880 <> 7S839013

Função Kegpa132.911: E1o9mexgl1m (219) interceptada,
RGSAAAAGEAREVAZASK MECLOD.SERGOSAZAZAZAZAKEZ $ -> C6295C <> 7S8zazza

Kegpa function132.911: Sejegosayathesz (408) interceptado,
RGSAAYAYAYAZASKISE Método.

Funky Keele] 32.911: TOA@11yhgagua [578} lerevaty,
RGSAADEZNEZASK METOD.SERURUSAYA 9 -> C62830 <> 7C801077

Kegkte function132.911: Goatababum (581) interceptado,
RGSAYA Método $ 5N1] = SK.SBERGOSAAGEZ5 -> C62870 <> 7C80ASOZ

Como comentário sobre o protocolo, pode -se notar que, neste caso
Kegpa!
em C500001.Do protocolo, fica claro que o analisador AUI.definiram
Tods como um RGSAAAZAZ®N1ZAS* (substituição de endereço), Subtyp SustoSayagzez - T. ©.
a variedade de rutkin, interceptando a função do sincerehosachiyagz $ para
Substituições de endereços retornados a ela- isso confirma que nossa interceptação
Chick funciona regularmente.

Interceptação da modificação dos primeiros bytes da função

O princípio da operação é baseado no fato de que os primeiros bytes da função interceptada
O TSI é substituído pelo código interceptador (Fig. 2.4).

Uma característica importante dessa interceptação é que, ao instalar
O cortador não analisa o código de função interceptada, isto é ..
O primeiro byte é alterado, não as primeiras equipes de máquinas.Investigador-
Mas, esse interceptador tem dois recursos:

0 O código interceptador pode ser definido apenas no início da função;

SZ para cada chamada da função interceptada das necessidades interceptadoras
Restaure seu código de máquina da chamada de LO e re -intercepto após
Conclusão de chamada.

No caso geral, o algoritmo Rutkin tem o seguinte garfo:

1. No corpo do interceptador, cria uma tabela na qual o primeiro
M bytes de cada uma das funções interceptadas.Como regra, o tamanho do
O código fixo não excede 20 bytes.

pagina: 61

55

Tecnologias de malware e os princípios de seu trabalho

Zolyeo hchadai iiphnaf 1eyheyo a "u" *oia

$ 9/2p \/30.
“Ru Iipyanaf Ale
R Ira r'eem: eh

Z5arrusolleo
Cedarot
Nr'Veh

“RL IPYANAF
Iroirum

Iipyanaf
Oh Iannigtvy |

Ikhazoidid
Iipyanaf
IitazMchencha

Oh, exaustão

E1doii
Epiidide1

E1DOCAEA
Epiidide1

E4zoui
Epicet

pagina: 62

56 Capítulo 2

2. Esta tabela é preenchida com um código de máquina de referência interceptando
funções.

3. No início de cada função interceptada, o código é registrado,
Transferência de controle do interceptador.

Consequentemente, o algoritmo de trabalho do interceptador tem o formulário:

1. O interceptador executa algumas ações.

2. A restauração do primeiro por bytes de função interceptada é restaurada.
3. Um desafio da função interceptada é feita.
4

Modifica repetidamente o código da máquina da função interceptada, no primeiro
Bayt, registrando o código transmitindo o controle do interceptador.

5. Análises e, se necessário, modifica os resultados do trabalho
funções.

6. cumpre o comando úmido, retornando o controle da função de funcionamento
programa.

Na maioria dos casos, uma modificação do código da máquina interceptou
As funções são reduzidas a uma mudança nos primeiros 5 bytes em seu lugar, os registros
O comando é um comando] MR, que transfere o controle do interceptador de Rutkin.

Deve -se notar que os sistemas mais simples são costurados para programas de hackers e
Tracer, bem como vários anti -abistentes, verifique o primeiro byte do
Funções para a presença do código da máquina da equipe LAR ou TT 3 nelas.
Se esses códigos de comando forem detectados, eles acreditam que a função do intercâmbio
Chen.Além disso, uma análise simples permite definir o local
um interceptador de memória analisando a lira contida na equipe
Nia.Como medida de contra -ação, os desenvolvedores do Rutkuts usam
Métodos "mascarar" do código registrado no início da função da interceptação
Ka- em particular, casos do uso de comandos do tipo de rebelião
Cem ZMR, colocação em frente à tradição de vários operadores ou lixo da mora
Código do tipo de risz ah/ror ah.Essas medidas visam principalmente garantir
impedir o analisador mais simples para determinar o endereço da função
interceptor.

Esta metodologia para interceptação de funções tem várias desvantagens, a maioria
dos quais eles estão associados à necessidade de restaurar o código da máquina
Funções relacionadas antes de serem chamadas e re-interceptação depois de você
Zova.Essas operações reduzem a velocidade do sistema e podem levar a
Funcionários no trabalho de aplicações de MOP -Flow.

Em uma nota

Se no processo de chamar a função interceptada, por algum motivo, não é
retornará o controle do interceptor de função da raiz (por exemplo, haverá excluir
Situação de limpeza), então a "cura" desta função ocorrerá, o que é

pagina: 63

Programas e princípios maliciosos de seu trabalho 57
Soso Stoso Soso Soso Ssoo como Tostov

Um dos lugares vulneráveis ​​de uma metodologia do dia.Este efeito é devido ao fato de que em
O momento de chamar a função interceptada Rutkin restaura sua máquina
código.Há pelo menos um anti -bruts que usa esse efeito é conhecido
Para restaurar as funções danificadas pela raiz.

Considere um exemplo de interceptar a função para modificar os primeiros bytes.Por
o nome das funções e a estrutura do módulo manterão a continuidade com o
Exemplos de leitura.Antes de desenvolver a instalação de interceptores
As funções devem ser declaradas a estrutura do TTPEEGSERTY (Listagem 2.16).

Listagem 2.16.A estrutura de ttisekoseretigo com informações ^ interceptadas
divertido
// informações sobre a função interceptada
Ttdeegsertyae = hees
T1rgagumate: $ s & g1tpa;// nome seria,
Gopse1opmatians: US $ 61119;// o nome da função
ROPS1OPAAGA: Rolpee;// Endereço da função

Nookaaah: Rospeks;// o endereço do interceptador

ROPSED: Aggau Raspecker [0..4] BUBE;// Primeiros bytes de funções
Noocomore: o artesanato de Anghau [0..4] Oh;// MR para interceptador
EPA;

Esta estrutura foi projetada para armazenar todas as informações sobre o intercâmbio
uma função funcional - um nome que contém a função da biblioteca, nome e endereço e endereço
funções, bem como dois buffers em tamanho de 5 bytes.Buffer gypseso4.
Chen por armazenar os primeiros bytes do código da máquina da função interceptada
Ção, e Nookdmm - código da máquina do comando MR, transferindo gerenciamento
Raiz de funções-interceptor.O uso dessa estrutura é muito
conveniente para depuração, pois contém todas as informações necessárias
Para modificar o código da máquina da função interceptada.A própria Modi
A ficção do código da máquina pode ser realizada na forma de uma função separada
Zesnoksoae (Listagem 2.17).

Pistina 2 17, a função do yaoseso3

// modificação da função do código da máquina

EOYPSUZOP 5ENOOOOOKSOD (TPBEGSER para: ttpeegerteoo; abeenok: boo? EAP)
: Boo1eap;

SOP5E

Sode512e = 5;// O tamanho do código modificado

pagina: 64

58 Capítulo 2

Uag
Tire, O1ararkhoses: Loga;
Puffer
// 1. Configurações de proteção
\ U1geoa1kokes {tpgegSeret*sobre.Eapszzopayag,
Sode51 ge,
Correr para EkhoSota Veapmatte, O1argokess);
// 2. Registre nos primeiros bytes da função do código da máquina
1 AZEENOOK SNP
Vesia1e: = mx1 tergosmeloga {bessoggepergos $,
GPTEGSER® 11.RIPS: Ohaaga,
Ztpsegsersetpeo.nokomor {9], sodeb1he, tyr}
E15E
825115: = agulha -sizesMepog (CiggePerGoseUse $,
TPSEGSERTAY pe.Caps 1Opaaag,
@TptegSerSteteo.eorSose [0], Sode51 = XE, TPR);
// 3. Restauração dos atributos de proteção
Ulgema] rgbest (TasegSersetpeo. ROPS1OZAAG,
Combinado51g, o] chrgosees, galeria de tiro);

comeu;

Dar uma função recebe uma estrutura concluída como um parâmetro
Ttpeegser1too.A modificação do código é reduzida para configurar atributos de proteção
Você é um fragmento de memória que contém um código modificado, modificação
Code com a ajuda do reservatório de 1 -Yokers e a restauração dos atributos de proteção.
O parâmetro do AZEENOK indica as funções de que o buffer de usar.
Se AZEENOK = dobrar, o comando UMR está instalado, que transfere
Controle de interceptores - Para isso, o buffer é usado
Tobesreto.nokummr.Se Azeknok = ya1ze, então um buffer é usado
Tpegserstpeo.ripsesed e o código do motor é restaurado
Funiii.Agora consideramos a principal função dos tlegserroPse1opers
(Listagem 2.18), responsável pela instalação de interceptores.

Pisting 2 18. ‘Função de Tl-Etoer Gapotz ov;n

EIUPSESTOPOP TPEEGSEREAAST1OGECH (Atlkama, Eopsumato: Z2G1T9a;
UAG TPSEGSERTO: TTPEGERSTPEO;NOOCGIPSE: ROGPSEG): Boo] EAP;

Watg

Pneu: cegonha;

pagina: 65

Programas e princípios maliciosos de seu trabalho 59

Umr_va1: acomu;
Problemas1p

FIR: = ea1ze;

// 1. Procure o endereço da Fuccação

Tibugersetpto.RGOPS1OPAAHK: =

Berygosachagzez (Beenodi1enap 1e (RSNYNYG (az bmama)),
Rsvat (ArgopsMame)};
1º Tasegsersetleo.GOLSE1ORAZAK = P11 SNP EHZ*;

// 2. Preservação de parâmetros na estrutura

Tpsegsereta.Bmate;
Tosegseretiyo.GopsS1olamat: = AGAPS & MAP;
Tpegsere111eo.nopazag = nookopsg;

// 3. Lendo a função de código da máquina
Eu tomo It1 {: = Vedrgosmeloku (SessiggePerGoseUse $,
Gosegsere1tteo.Galsa Zopadag,
@Tisegsersetpto.ROPSUSED [0], 5, range de tiro);
1e POF {vezi] e) ECH1E ECH1E;
// Preparação de um buffer com uma equipe de MR, formato ee xx xx kh kh
Mr VE]: = OMOVO (Nookgsa} - (Biovr (tlkegseretiyo. Golse1opaag) + 5);
Tpbegser tero.
Sorometoga ( @tpegsersetpeo.noklmr [1], @0MR VE1, 4);
// gravação do código da máquina do FMR, transferindo o controle do interceptador
WE11: = ZetNooxode (1TPHEGSSEX {teteo, & gay);

EPA;

A função dos Tokegsers ropseetopa está procurando o endereço da função interceptada e
Define -o em tpeegsersetteo.Gypsum1opdaa:.Se você determinar o endereço não levar
Moose, isso significa que a biblioteca necessária não está carregada ou não é
Contém a função indicada.Nesse caso, mais trabalhos são encerrados
isto.Em caso de determinação bem -sucedida do endereço da função, o preenchimento é feito
Os campos do campo da estrutura de TleySersetpeo e lendo os cinco primeiros bytes de máquina
a função interceptada.Comerciante ao ler um código de máquina
Também inaceitável e quando é detectado, a função da função é interrompida.
Em caso de leitura bem -sucedida da função interceptada do código da máquina
O código da máquina da equipe de AR é formado, que será
Transferir o controle do interceptador.A equipe SOMR contém uma mistura,
Além disso, ao calcular o deslocamento, é necessário lembrar que
é calculado entre o valor do contador de comando após a execução da lira

pagina: 66

60 CAPÍTULO 2

e o ponto em que a administração é transferida - portanto, uma emenda é necessária
deslocamentos pelo comprimento do comando z “r, igual a $ byte.Depois que o aplicativo é formado
MR -CUT Código da equipe de RM no buffer Noocâmero permanece para ligar
Senooxse, que modifica os primeiros bytes da função interceptada
ção.Para verificar o desempenho do sistema para instalar a interceptação do
Olhamos para o exemplo mais simples, interceptando a função
(Listagem 2.19).

Pistimg 3.19.Um exemplo de interceptação de mebas

Waah
Meszadvochokhtpsegsere1tto: ttoegser então;

// Interceptor de Meszadevokh

Epsuzop tshumzzadevoha (n®pa: nimr; 1rthe, 1rSare1fop: rapz1svag; itur: itur:
Itmt): tpeedeg;Z59S11;

Bedlp

// 1. Restaure o código da máquina da função

Zee Nookso4e (meszaevo -vychokhtepegsersetpeo, yoa15e);

// 2. Chame a função

Vezi16: = Meszadevokha {pmpa, 1rtehf,

Rspag {ze g1pd (1rSare1og)+'(LERAVRE!)'), TURE);

// 3. Restaure o OMR ao nosso interceptador

Zesnokxode {meszadovochtpehegser (tpe, venha};

ETA;

Ed] p

Meszassevo {0, 'Meszade1', '' supua ', 0);

// interceptação de meszadevokh

TPSEGSEROPSE1OPERS ('13 EG32.41] ',' mezzadevokha ',

Meszadvochokhtpegser®tpeo, @tumeszadevoha);

Meszadevo! 0, 'mezzade?*,' Vsoeckze ', 0);
Por exemplo,

A função interceptadora funciona de acordo com o clássico para Rutkita deste tipo
Esquema - restaura o código da máquina da função interceptada, então
o chama (neste caso com parâmetros modificados) e depois

pagina: 67

Programas e princípios maliciosos de seu trabalho 61
ni

Retorna aos primeiros bytes da função interceptada do código de comando ZMR.Você-
Zovsi Meszadevokh antes e depois de instalar a interceptação permite que você verifique
robô.Como um exemplo mais difícil, você pode considerar o interceptador
funções de e1pamehez1ea, mascarar arquivos e pastas que contêm a palavra
"Tosks" no nome (listando 2.20).

EAPSE1OP PUE1111EA (não spa9e11e; tnp 1e;
Uag 1re1p9e11] ebas: tu1mz2e) pabasaa};Era;$ ze@ASA11;
Sem?
Sim
// 1. Restaure o código da máquina da função
5ENOENOXODE (E1PAMEHE1 1EATLEGSERSTETETEO, YA15E);
// _ 2. Ligue para a função
Ve5i1e: = Rapehaea11ea (nelpae1] e, 1re1t9eg11reeaa);
UR11E VE5O1E AO Bedp
1e Roses ('Gosek1e', KommerSaz (1Re11111Rata.se11em \ AME)) = 0 EBEP EX1E;
Vezi: = gapameheea1ea (paalpag11e, 1re1 teshaz1epas);
comeu;
E1pa11u
// 3. Restaure o ZMR ao nosso interceptador
Zesnoksode (rlpamehee1 1eatpt%etgSerseteo, ele);
EPA;

EPA;

Uma característica da função é uma abordagem mais correta para a restauração
A equipe LMR no início da função interceptada- todo o código de interceptações
Ka está fechado no design ‹gu ... elpa11u, e o trabalho final é
A aderência é colocada na seção E1PA11U.Caso contrário, trabalho
O interceptador é semelhante à função na Listagem 2.13, a análise de interceptações em
O trabalho do Rootkit de treinamento confirma o fato da interceptação (listando 2.21).

Função de Kegpa] 32.411: E1pamehee111ea (218) interceptada,
Método ARTSODEN13ASK.Trto

Função ts5eg32.4911: Meszadevokha (477) interceptada,
Método ArtSoden1ASK.Irto

pagina: 68

62 Capítulo 2

Em conclusão da seção, deve -se notar que em comparação com a interceptação
As funções de substituição do endereço interceptam a modificação do código da máquina
Algumas vantagens.

Com a modificação de interceptação da tabela de importação, não pode dar 100% da garantia
Interceptação de função, sempre há uma ligeira probabilidade de que
o aplicativo de uma maneira ou de outra receberá o endereço real do interceptado
funções.O método de modificar o código da máquina é livre disso
Statka.

(Com a interceptação da modificação do código da máquina em alguns casos, ele permite
Cheire o número de funções interceptadas.Por exemplo, se Rutkit
É desenvolvido para \/mt4o \ s $ 2000 e sistemas subsequentes, então você pode
Para levar em consideração que as funções *a são adaptadores nas funções utsodod *h,
Portanto, basta interceptar apenas!

Interceptação da modificação das primeiras equipes da função

Este método é semelhante ao anterior (ver Fig. 2.4), mas em vez de modificar
Casio dos primeiros bytes da função interceptada, a modificação é feita
suas primeiras equipes.Para implementar esta técnica em Rutkit deve ser
O analisador de código mais simples é montado.Como regra, como uma análise
O congestionamento é o "Dizassembler do time da equipe".Ele está em co-
em pé para reconhecer o comando da máquina no endereço especificado e calcular
Seu comprimento em bytes.O uso desse analisador nos permite considerar
o código da máquina da função na forma de um conjunto de comandos da máquina, e não na forma de
Baytov.Isso dá ao desenvolvedor de Rutkin uma série de vantagens e
O algoritmo de interceptação terá a aparência:

1. A variável M1 é adotada, que armazena o tamanho da análise
Código Creded.

2. O comando da máquina é analisado no ponto de entrada na função.Atrás-
Cottage - Determinando o comprimento da equipe em bytes.O comprimento calculado é
É baseado no tamanho do código analisado M1.O tamanho é analisado
O banheiro é comparado com o tamanho do código interceptador (geralmente este
5 byte - código da máquina da sua equipe).Se o tamanho do analisado
O código é maior ou igual ao tamanho do código interceptador, depois a análise
O código termina, caso contrário, o seguinte comando é analisado.

3. Copiar os primeiros bytes M1 da interceptação do código da máquina
A função no buffer de Rutkin.

4. Para o código da máquina 3 da função interceptada.
O código da máquina do comando lear é adicionado, que transfere o gerenciamento de
Endereço [ponto de entrada na função afetada + nº 1].

pagina: 69

Programas e princípios maliciosos de seu trabalho 6:
E eu é

5. No início da função interceptada, o código da máquina é gravado,

Dando controle ao interceptador.O comprimento deste código nº 2 <nm1.A diferença e
O comprimento pode ser preenchido com lixo para disfarce;Além disso, o comprimento de M2
(e, portanto, determinado nas etapas 1-3 m1) pode mudar no
Namik, já que, em vez de um TMR frontal, um certo poli-
Código morfoso.

Código de funções da UMR Machine

3 |
1 |Boofer com as primeiras equipes de funções |/Sr. 4
, *>}

você
Código Rutkin

Arroz.2.5.O algoritmo do interceptador

O algoritmo de trabalho do interceptador é mostrado na FIG.2.5 e consiste no seguinte
operações:

1.

O código no início da função interceptada contém o comando RM (ou
Valência para ela no significado das equipes) que transmitem o gerenciamento de
A aperto de Rutkin.O interceptador pode executar algumas ações,
Como nesta fase, os parâmetros de entrada da função estão disponíveis para ele.

Rutkita Interceptor pelo comando sag, chama o código do buffer- no resultado
Tata primeiro executou comandos de motor de
Função reimportada.

O LMR é feito no buffer após o código copiado de
função interceptada.A gerência é transferida para o primeiro
A equipe cortada de código interceptado.

Retornar pela molhada da função dá o controle da rotina, e pode
a necessidade de ajustar os resultados da função.Depois
A função deste interceptador completa o trabalho da equipe molhada.Retornando
Gerenciamento do aplicativo que o chamou.

.Este método é mais complicado na implementação, pois requer integração na raiz

Keith do analisador de código.Como regra, o LLA da análise de código é usado
O dizassembler constante de equipes construídas com base na tabela.Esse
adiciona cerca de 1-2 kbytes ao código Rutkin, mas significativamente
melhora a qualidade e a velocidade de seu trabalho ..

pagina: 70

64 CAPÍTULO 2

Em uma nota

Uma característica do trabalho de Rutkin desta espécie é que as primeiras máquinas
As equipes de função pvrevated são executadas no buffer de Rutkin.Vestígio
- Se no início da função interceptada, os comandos da máquina acabaram sendo
Usando endereçamento relativo.então sua implementação no buffer de Rutkin
levará a um resultado imprevisível.Portanto, escrito corretamente
Rutkin é obrigado a reconhecer o endereçamento relativo
equipes e modificar as eletas relativas que eles usam, levando em consideração
Nova localização das equipes de máquinas.

As implementações simplificadas dessa metodologia de interceptação são conhecidas.Eles são fundados
van sobre o fato de que os primeiros comandos do código da máquina das funções AR1 não são
Mudar de versão para versão e, em vez de uma análise de código relativamente complexa
Uma verificação elementar é feita, seja os primeiros bytes de interceptação coincidem
uma função em funcionamento com um dos desenvolvedores de assinatura.Este método
Menos universal, mas significativamente mais fácil na implementação.

Considere um exemplo de construção de um interceptador desse tipo.Para iniciar
Precisamos de uma estrutura na qual informações sobre o trans-
Função compreendida (Listagem 2.22).

Listin 2.22.Estrutura descrevendo interceptação

Claro
Tutobegsere Theo = Hesoga
11 bgakuming $ 567119;// nome de Osh,

RIPS1OPACH: 5%: 119;// o nome da função
Rilse1opayag: rolmeeg;// Endereço da função

Nookayag: Rosseg;// o endereço do interceptador

EOPSESOAE: Aggau Raspecks [0..20] BUZE;// Primeiros bytes de código

COPSESSESODE $ 1HE: BUEUE;// O tamanho da função da função movido pela rutkinita

NoOCE: Aggau Raspecker [0..20] BU*E;

Noocomore: Aggau Raspecker {0..4] ooe bu*+e;// MR para interceptador
EPA;

Fields t1bgagunama, ripsa1opachech e ripsopaadag são semelhantes aos campos
TTELEGSER®1too Tours dos exemplos anteriores e contém o nome da biblioteca.
O nome da função interceptada e seu endereço.Nookaaka Field foi projetado para
armazenamento do endereço da função interceptadora.A matriz rupsed é usada
Armazenamento da função de código da máquina de origem.Esta matriz não é
Ele muda no trabalho de Rutkita, mas permite restaurar se necessário
Código da máquina da função interceptada.Campo do EopSode $ 1 ele pretendido

pagina: 71

Programas e princípios maliciosos de seu trabalho 65

mas para armazenar o tamanho do código da máquina, copiado desde o início de
Uma função compreendida (esse tamanho não é conhecido com antecedência e pode mudar).
A matriz Nookvi foi projetada para armazenar os primeiros comandos da máquina
Sim, as funções complementadas pelo operador “r para transferir gerenciamento para o primeiro
a equipe inalterada de funções e o maciço nookumr contém 5 bytes com
O comando do UMR, introduzido no início da função interceptada.

Em uma nota

No Lintsil para instalar a interceptação, a maioria dos campos descritos anteriormente
não requerido.Mas este exemplo é destinado a fins educacionais e a disponibilidade de
Essas informações são úteis para depuração.Em particular, você pode bloquear
para a função 5e {soksode e analise a correção das configurações de
Estrutura de lei sem instalação do interceptador.Em um exemplo real, suficiente
Somente o buffer é nobreza.

A modificação do código da máquina da função é semelhante ao exemplo anterior
e se resume à gravação da equipe de RM preparada com antecedência no início da função
ção (Listagem 2.23).

Pisting 2.23.A função da instalação do excesso
// modificação da função do código da máquina
EOPSE1OP ZENOOXODE (TIBIGERSERS1PEO: TTPBEGSER1TTEO;
Abufnok: yuo1eap}: boo1eap;
Uag
Pneu, o1argobes: DOGA;
Demônio
// 1. Configurações de proteção
U1theia1rgosees (tpeegsersetpeo. Gopse1opache,
Tibegser é como.Rapsaode $ 12e,
Rase_ eHesote_ vasivtte, o1achrtosk);
// 2. Registre nos primeiros bytes da função do código da máquina
1e Azeensk Enep
Vezi] e: = m16ergosezeno (BeshegepPergoseuse $ 5,
Tibegseretaeo.ROPS1OPAZAK,
@Tpegsersetpeo.
E15E
Vezi1 {: = igsggosmo i (bessigggeperGoseUse $,
Tglbegsetsetteo.Kopselopadyakhg,
@Ttptegseretpro.Gapststosode [0],
Tieegsersetpeo.

pagina: 72

66 CAPÍTULO 2

// 3. Restauração de atributos é costurada
1 geoa1rgobes® (tpeegsersetpeo. Rops1opazag,
TLEGSERSTETETO.GypSesSode $ 1He, O1argkesses, Tyr};

EPA;

Esta função pode definir o interceptador (neste caso, no início
As funções são registradas 5 bytes do buffer Nookzr) ou Máquina de restauração
O código de função interceptado (neste caso, os dados são retirados do buffer
Gopsoda).A instalação da interceptação é um pouco mais complicada do que no caso do modificador
Casio dos primeiros bytes do código da máquina (Listagem 2.24).

Pisimne 2.24, instalação de um centavo

ROPSEZOP TOBSERAPS ZOLEH (Atlmashche, Aropmama: 361719;
Uag tptegerttpio: ttpegerteoo;

NOOCGOPS: ROSPEPEG): BOS1EAP;
Uag
TIR: ACOM;
Morreu VE1: @Moga;
Dificuldade

WE11E: = #A15E;
// 1. Procure o endereço da Fuccação
Nuegseretiyo.Gapselzopayagg: =
Seergosyages $ (semoda] enapo1e (rsvag (agzmate}}, rsvag (akopsomama));
1º tabigseretaeo, ropsefopaayu = p11 euger ex1e;
// 2. Preservação de parâmetros na estrutura

TPEGSER TIIO.1ABGAGUMAP: = aglmamama;
TithEgSersetpeo.EOPS1OPMAL: = AROPMAMA;
NIEGSERSETPEO.

// 3. Determinação do tamanho dos dados copiados

Tisegseretiyo.RipSesode $ 12E: = 0;
INU INOHGGSERTPRO.GoPSesode $ 1 T <5 a Bedzt

Pneu: = besoda $ 1 le {ROOPE (9 CAR (TPSEGERSTPEO. GAPSEZOPAYAG) +

Tpekhseretaeo.CopissodeB heh});

1º intervalo de tiro <= 0 TNP ECH1E;

1ps (Tasegsersetleo. ROPS "Sode $ 12E, campo de tiro);
EPA;

pagina: 73

Programas e princípios maliciosos de seu trabalho 67

// A. Lendo a função de código da máquina
Vezi] e: = um rankrgosmosmo (BessigggeperGosez,
Teeugersetteo.Gopse1opadag,
@Trsegserteoo.Eoipsooae [0],
Tibegses (TPE. GypSesSodeB12E, Galeria de Tiro);
1e wn (vezi1®) {nech1 {;
// Preparação de um buffer com uma equipe de MR para uma função de transcrição
Emr_ve1: = bmovo (nookropse) - {vmoovo (tpbegserteoo. Gapps1opaag) + 5);
Tibugersetpeo.nokommr {0]: = $ 029;
Sorometoga ( @tpegsersetpeo.nok] mr [1], @0MR VE1, 4);
// Copping do código da função no buffer rutkita
Sorumememog {@tpsegerstpeo.nokvi [0], @TPechgSerSteteo.GkOpssesoda [0],
TibegserserTeoo.RAPS® SO51TA);
// Preparação do buffer com a equipe LMR
EMR_VE1: = (BMOVO (tpexereteo. RAPS®1 OPASAK} +
Tgpeahsersett ro.EopSodeSode512e + 5} -
(OMOVO (@TPECHSERSTETEO.NOKOVO [0]) +
Tibegsertio.Gopsode $ 12e+5+5);
Tpbegser Tao.Nookvoy |TpberStoo.Gypsesoda512e]: = $ 0e9;
SorumePog (@TPSEGSSERTEPO.
@Lur v1, 4);
1 geoa1rgoesy® (@tptegseretiyo. Nookva [0],
Tibegserotpeo.Gils® Cose $ 12e+5,
Ras Ekhosota Veomwtte, pneu);
// Instalação do interceptador
WE11E: = BehEnoksoche (tpeegserSersetpeo, & gcc);
EPA;

Esta função na etapa 3 analisa o código da máquina do interceptado
funções.A análise é feita no ciclo e se resume a determinar o comprimento
a próxima equipe de máquinas usando uma função beissuche de US $ 12e e adicionar
Lamentação do comprimento obtido no balcão do tamanho do código analisado.
No caso de uma determinação malsucedida da duração da próxima equipe, o trabalho da função
ção é interrompida.O ciclo é repetido até que o tamanho seja analisado
O banheiro não excederá 5 bytes que precisamos gravar a equipe
PERCORRER.Quando o tamanho fornecido é atingido, a máquina está copiando

pagina: 74

68 Capítulo 2

A função da função no buffer do eipSesod e a preparação para a interceptação começa,
envolvendo duas operações:

Com a preparação do código da máquina da equipe UMR, gravado no começo
função agarrada.

Com a preparação do buffer com as primeiras m equipes da função interceptada e
A equipe ZMR na primeira equipe de interceptação de máquinas inalteradas
uma função.

S Depois de preparar o buffer noocle para ele, os atributos são instalados
Rase_ehosotee veaBivtte usando \ u1 ge1rgobes®.Instalação de atributos
É necessário camarada, pois, no decorrer do trabalho, transferiremos o gerenciamento
colocado neste código de máquina buffer.

Em uma nota

É importante observar que neste exemplo, depois de instalar a interferência, a estrutura
TPtegerttpeo se torna não transmitido.Isso se deve ao fato de o buffer
A bolsa contém pelo menos um time com o endereçamento relativo
{Esta é a nossa equipe MR no final do buffer).

Para determinar a duração do comando, faz sentido usar o di- acabado
Zassembler dos comprimentos dos comandos e chama -o da função do Besode $ 12E.Um de
Exemplos da implementação de tal Dizassembler podem ser encontrados livremente
Biblioteca estendida Arch Kosokka 2005, que pode ser baixada por
Endereço nr: //mm.gobki.sot/uash/fegezarven/aehkoo 2005.22r.Dizas
O seqüener dos comprimentos dos comandos está localizado no arquivo absodenok.
$ 1He0#CO4E.Esta função recebe como o único parâmetro
Endereço da RA no qual a equipe analisada está localizada.No caso de
A determinação do pé do tamanho.
Assim, em nosso exemplo, a função de seesode $ 12e terá o formulário -
Listagem 2.25.

Listagem 2.25.Fuyaziya russo

RBIPS1OP BOBSODE $ 12E (AREG: Roice): ZiCEG;
Sem

// chamando funções de arhsodenok.ra $

Vezi: = 512E0THO (AREG);
EPA;

Considere o exemplo mais simples de interceptação da função com a ajuda disso
Todiki - interceptaremos a função do Meszadovka (Listagem 2.26).

pagina: 75

Tecnologias de malware e os princípios de seu trabalho

Pistimg 2.26, interceptação da função de Mahzhas® em O®A

Claro
Timezaevoi = eaps1op (nipa: nimo; 1rtyty,

1RSARE1OP: Rapztsvag;

UTUR: OTMT): tpeedehg;5 e 9S11;

// Interceptador de Meszaevoha
Bipsey1op mumezzadevoha (n \ pa: nimo; 1rthekh, 1rsarefop: rapz1svag;
UTUR: OTMT): Nighted;$%9S11;
Problemas
// Ligue para a função
VEZO1E: = TMEZAZZAZEDOVOI (@MESZADVOCHTPEHEGSERSETPTEO.
(Bipa, Tracthe,
Rsvahg (5eh1pa (1rSare1OP)+'(interceptado!)'), Centro);

EPA;

Problemas1p
Meszadevokha (0, 'mezzade] 1', 'vkosok1e', 0);
// interceptação de meszadevokh
Gibegserops1 OPEKH ('ZG32.411', 'Meszadvoha',
MeszadvochokhtepegSersetpeo, @pumeszadevoi);

Mezeozadevo (0, 'meszade?', 'Vosok1e', 0);

EPA.

O interceptador pode executar quaisquer operações de que precisa e depois
Chame uma função interceptada.Este desafio é reduzido a um anúncio

Tmezzadevo e chamar a função interceptada como:
Tmezazadevoha (@Meszadvokhochokhtpfegseretiyo. Nosov [0]}

Você pode fazer sem um anúncio do tipo, mas depois com a ajuda do assembler
As inserções deverão ser colocadas nos parâmetros de vidro da função causada.Para
Verificando a correção do trabalho do nosso interceptador, você pode Dizassemb
Toque o código da função Meszadevokh antes da interceptação e depois dele (folhetos

2.27-2.29).

pagina: 76

77470505 na FSU

7791050A 55 UP
779705 do BES
77470510 833A1S04997700 STAR
77470517 7424 =>
77970519 64A118000000 POV
7797051 Ba00 Razo

E91, OT!

EBR

EBR, dirigindo

Yanogya Reg [\ 15x32!
\ zeg32!
Eah, e: [00000018}

0x0

77970506 E94S399088 ER
77970510 83341504497700 p
77970517 7424 32

77970519 64A118000000 POU
77A7051E 6A00 ROSE

Gooekse 13+0x13e5c (00A73Ebs)
Yaro reg [izh32!
Izkh32!
EAH, #3: [00000018]

0x0

O0A0A768AA ZEYEE
00A768As 55 Ruzv
00A768A@ Vess POV
00A768EE E95S9S2E77 ETAR

00A76854 0000

Listagem 2.27 mostra o resultado do dizassembing dos primeiros comandos
a função afiada do meszadevokh (em várias versões de ulpvo \ z-
O código dos pneus desta função pode diferir naturalmente, este
foram recebidas medidas no WHIPD;XP $ P?Após a interceptação, as três primeiras equipes
Substituído por um operador MT, e fica claro que o EMR transfere o gerenciamento
O interceptador na biblioteca de gosoki_sh.Análise do conteúdo do buffer Nookvoy
{Listagem 2.29) permite que você tenha certeza de que ela contém os primeiros comandos
uma função compreendida e o operador do TMR, que retorna o gerenciamento ao primeiro

E91, EA1

EBR

EBR, dirigindo

IZEG32!

Avento a equipe de máquinas das funções de Meszadevokh.

pagina: 77

Programas e princípios maliciosos de seu trabalho 71

Intercepção de funções usando assinaturas

Métodos de interceptação descrita anteriormente, modificando o código da máquina
Functionia tem um recurso comum- transmitindo o gerenciamento de
O código do carro deve ser registrado no início da função.Rutkin s
O analisador de código pode pular os primeiros comandos, que
Sua segurança está tremendo da detecção.No entanto, para introduzir o código em qualquer
Não pode ser um ponto de função arbitrário.

Esse recurso simplifica a pesquisa e a neutralização de
baleias desse tipo, no entanto, há uma técnica livre disso
STATKA, - - As assinaturas são usadas.

O método baseado em assinatura é o que para cada intercepto
As funções de Rutkin têm uma base de assinatura.As assinaturas são o criador
Rutkita manualmente, usando desmontagem e rastreador de código
funções.

O algoritmo com a introdução do interceptador se parece:

1. O código da máquina da função afetado é digitalizado do ponto de entrada para
A função até o fim ou até que o comprimento do pré -conjunto seja atingido.
Dentro do site digitalizado, um ou mais
Assinatura.Se a assinatura for detectada (que seja o ponto VA11) de
Os pontos VA11 estão copiando o aquecimento de bytes para o tampão de Rutkin (comprimento
O CCAP1 é determinado pelo desenvolvedor de Rutkin com antecedência).

2. O código no endereço VA11 é substituído pelo código Rutkin- a tarefa deste código é
O controle do controle do processador Rutkin é transferido.

3. O código no buffer de Rutkin é complementado por comandos para transferir gerenciamento
Ponto [ponto de entrada na função + ve11 + No. ep1].

Recebendo controle, o processador Rutkin executa algumas ações e
Em seguida, transfira o gerenciamento das equipes no buffer - isso levará a mais
Código da função.Se Rutkin quiser receber gerenciamento depois
Conclusão da função da função, ela pode alterar o endereço do retorno na pilha.

Este método permite que você implemente seu código em qualquer local de função.Em ba-
casos de DE, esse algoritmo pode ser implementado sem gerenciamento
fora da função interceptada - em vez de colocar código na função
Para a transferência de controle do interceptador, o Rutkit pode modificar o MA-
Código dos pneus da função afetada para alcançar
suas tarefas.

As vantagens de tais algoritmos são a possibilidade de modificação
a função da função em qualquer momento e a introdução do interceptador (um ou não
quantos) em diferentes pontos de seu código.Desvantagem- é necessário com antecedência
Analise a função da função e forme a base de assinatura.Por outro lado-

pagina: 78

72 Capítulo 2

nós, a análise do código de várias funções sistêmicas mostra que eles praticamente
Não mude de versão para versão, o que faz um método semelhante
ter.

Outro ponto importante na introdução do código com a ajuda do mecanismo de sinalização
Tour é a capacidade de modificar o código de programas e bibliotecas em
O processo de sua leitura no disco.Implementações práticas dessa metodologia em re-
Nenhum programa malicioso ainda não foi registrado, mas teoricamente
não há obstáculos para isso e os exemplos atuais de tal
Rutkitov.

Um dos desenvolvimentos conceituais mais famosos nesta área
É o shee shee beskoog (vv r: // mche \.
90 \ shua95/oeg/TODEH.Este é um rootkit colocado no setor de carregamento
disco.Após o lançamento, essa rotina intercepta a interrupção do TMT 135, que
Permite que ele rastreie a leitura e a gravação dos setores de disco.Nesse caso
Ao desempenhar as funções das informações de leitura, a varredura é realizada
Boofer contendo informações individuais.No caso de um sinal de sinal
O interceptador de turnê modifica o código da máquina definido no buffer
Queimado pelo sistema de módulos.Uma descrição detalhada da metodologia e um exemplo disso
A implementação prática pode ser encontrada no link especificado.

Interceptação por pontos de parada

Este método não é muito diferente dos métodos baseados na modificação
Código da máquina.A idéia do método é que, em vez da equipe de OMMR para
transição para um interceptador ou modificando um endereço de função na tabela
A porta é usada um software ou hardware da parada.Encenação
os pontos de parada e o controle sobre a operação do aplicativo podem ser mantidos com
Eu costuro osianos, o exemplo atual é o oerepdepsu u/asheg deste último
Versões, mais precisamente, seu sistema de perfil de código.Aqui está um exemplo do protocolo
Antirutkita a \ u7:

Função e $ eg32.411: 03zahs!
Artsoden1] pergunte.TPEOSV

Deve -se notar que em rotas reais um método semelhante de espalhar
Niya não.

Sobre a modificação da conta.No disco
ou no processo de carregamento

Este método se assemelha à infecção do programa com um vírus de computador.
No entanto, se o vírus preparar seu corpo para o programa afetado e
O ponto de entrada bica nele, então, neste caso, Rutkit está dirigindo a máquina
o código de seus interceptores e modifica a tabela de exportação.

pagina: 79

Programas e princípios maliciosos de seu trabalho 73
E morre puxe e m riia

Assim, a técnica é semelhante à interceptação da substituição do endereço com dois
Diferenças:

(Com a interceptação é realizada editando o arquivo no disco;

Com em vez de modificar a tabela de importação de aplicações afetadas no memorando
A modificação das exportações da biblioteca é feita.

conclusões

Então, examinamos os conceitos básicos da construção das rotas,
Derretimento no modo de usuário (Zygmode).Em conclusão da seção,
Roma, que funciona mais frequentemente interceptada pelas rotas (Tabela 2.1).

Tabela 2.1.Funções interceptadas por tsuz/mod-bighting

Funções interceptadas funções interceptadoras típicas

Kegpa132.411!

Hegpe132.911!
Interceptores

411.911!

411.911 |!Eu epimegeaeUa1ikeeu ra (apenas em mt-systems}

Achuar132.911!VEDEPIMKEU CHAVES E VALORES DE REGISTRO
AAUAR132.411!
A9UAR132.4911!VEDEPOMA A}

No. 911.411!Meopargos $ 3 $ Proteção de processos e fluxos da análise
411.911!

KEGLE132.911!RHOSEZ $ 32MECH Processos de processos

911.911!

Kirovka acesso a arquivos (apenas

12911. Para MT)

411!
P6A11.491]!
P5911.911!

Kegpa132.411!
{aplicável para \ mpdo \ uz 98 e mt)

Mealt., Distorção de informações do sistema -
411!
6911.Módulos (apenas MT)

91115 1BESMAK1UEBUZKATTPEOGMA1OP

pagina: 80

74 CAPÍTULO 2

Função interceptada

A4 \ UAR132.911!

Tabela 2.1 (final)

Funções interceptadoras típicas

Serviços de camuflagem, bloqueando seus
Começar e parar

A9UAR: 32.911!

Achuars 32.911!

PE911.4911!

Interceptação das operações de leitura de memória
Cess.Permite mascarar ma-
O código dos pneus do interceptador da análise
Torov, interceptação de operações de gravação,
Mudanças para proteger contra anti -cortes

16911.91]!Meysteuu1 GBOA1 metros

Frente.411!Nesr5pdedsezt schlionage para trocar com a Internet,
modificação dos pedidos transmitidos,

Bloquear a atualização de antivírus

Itpzer.911!

KegpeMoeee oo \ ki

Uma desvantagem comum do combate Yu5egMode é a necessidade de implementar
Interceptores em cada uma das aplicações secas.Além disso, qualquer
O regime do núcleo de Rutkin é fácil o suficiente para se locomover- para isso você precisa carregar
Faça seu próprio motorista que executará a análise necessária de re-
O supino de bancada.A partir dessa desvantagem, os rutkuts que trabalham no modo são gratuitos
Os núcleos, pois recebem o controle de todo o sistema.No entanto, Kegte |-
Modest-Ratkita é um significativo menos (do ponto de vista do desenvolvedor
Rutkin) - o usuário deve ter privilégios para instalação e
Carregando drivers.Além disso, muitos sistemas proativos modernos
Records de proteção de computador tentativas de instalar e carregar o driver e
Eles bloqueiam essas operações.

Para a compilação dos seguintes exemplos, Ook é cortado por (afundando
@oreg ki), com a compilação do motorista pode ser realizada por dois
Tyami:

Com a ajuda de um compilador do compilador- para o correto
Os bots do compilador precisam configurar as variáveis ​​do meio ambiente com
o poder do ze {EPU.

Com a ajuda de você!$ Shai- Nesse caso, é necessário nas propriedades de
ECT indicam os caminhos para oozhk e, nas opções do vinculador, indicam os parâmetros
/Emtau: "og1uegepugu" /bateuv /zozuz5vet: pa*1ue, 4,00.

A compilação usando OOCs é significativamente mais fácil, pois para compilação
Os motoristas, na verdade, além do texto inicial do motorista e da rocha não são nada

pagina: 81

Programas e princípios maliciosos de seu trabalho 75
- o

Obrigatório.No caso do desenvolvimento e compilação de motoristas em U1vy |
É conveniente usar o editor vermelho integrado com M $ Ohm.

Todos os exemplos descritos mais ativamente usam ativamente a conclusão de depuração
Um meio de o6eriyah.Para protocolo as mensagens de depuração são muito
É conveniente usar o OebRameuturmens \, que pode ser baixado gratuitamente de
Site Vir: // Michi Zuzuyegva SOT.

Antes de considerar as variedades do regime de núcleos de Rutkin,
Monte os princípios básicos de chamar as funções do núcleo.Considerar
Esquema simplificado de chamar as funções do núcleo em \ mtdo \ $ 2000 e subsequente

sistemas (Fig. 2.6).
Mton._ sobre

trança |- 58 "meu
—_ No.t2e bai goete moda
Para se

Funções nucleares

Arroz.2.6.Núcleo chama para chamar as funções

Vamos começar com o modo de usuário.Nele, no nível mais fodido, há um bib-
Liotek tats.a1.No entanto, a maioria de suas funções são adaptadores
Na função do núcleo.Esses adaptadores são diferentes para UIMDO \ с 2000 e XP.Uma vez-
O pessoal consiste na metodologia de transição para o modo núcleo- em \ compaixão \ 5 2000
Uma chamada de interrupção do IMC 2E está dentro e começando com XP - Zuzetheg.Considerar
O dispositivo da função do adaptador no exemplo da função 2msGereaferia: 1e
(Listagens 2.30, 2.31).

‚Pystig 2.30.Cultura!Dizassembping mik {aqueles @ ml om 2060

Suehes:;

“Seeh: 77evrova 2sgeata!
.

„

„.77Veeva Pore Eah, 205;№ sgeaeer \] e

.

pagina: 82

76 Capítulo 2

“Keha: 77evysz p.
„.
“Seeh: 77E8VR9S5 2USEAER11E DIRA

- Listagem 2.31.Desmontagem Resultados 21 ego: aqueles
Em umpf, mm $ xp 522 r

Seche: 7S900682;Echrogsie Epga 123. MRO.
„.ECHROGFEYA EPECH 933. 2MSGEAKE11E

.

“.

.THDS: 70900682 Ou Eah, 258;Mesgeatea1e
„.

„.

„.

„.

Na listagem 2.31 Ligue

SA} @mot @a reg [eax]

- Este é um desafio para a função K1 ProvezeechSSHSA11, que consiste em duas equipes:
Mou Erkh, ela e Zuzemtv.Analisando os resultados de Dizasseming,
Duas conclusões podem ser tiradas:

Sobre a função de WT* e 2i* em p9p.p são idênticos;

Sobre a função de transição são construídos de acordo com a mesma estrutura e são reduzidos
para a entrada na EAC da função da função e a transição subsequente para o modo
Núcleos.

A análise das funções-adaptadoras mostra que elas são muito simples em

Roying e, em princípio, nada impede o aplicativo do usuário

Para pressionar o código semelhante ao Pereber em Pan.an.Portanto, no diagrama

arroz.2.6 Há flechas mostrando a possibilidade de ligar para Zuzsai e

PMT 2E ignorando Man.ai.

Em uma nota

A capacidade de chamar as funções principais ligando para Zuzsey!e Mt 2e permite
Ignorar os Rutkitov Retings of the Uzug Fashion, instalados de acordo com a metodologia da perda
Somos endereços ou modificações do código movshinsky da função.

pagina: 83

Programas e princípios maliciosos de seu trabalho 77
Sessão de ooos oooooo skosoosooooooooooooooooooooooooOOOOOOOOSO É Soso Soso Soso Soso Soso SoosOSOSOSSSOSSSOSSO SOSSO SSSO SSSSO SSOSO SSO SSO SSO SSO SSO SSO SSO SSOS SSOS

Por sua vez, no núcleo há uma estrutura chamada Zegls Ozheriop
N (5ot) (Listagem 2.32).Contém quatro estruturas idênticas do tipo
BUMET ZEG/CEAST ($ $ T) (Listagem 2.33).A primeira estrutura na composição
Contém uma tabela de funções de manufatário!núcleos e chamados para! Zumetzhega-
1 mil (no utilitário AUI para esta tabela nos protocolos, co-
Color k1zt - de para! Zegiseta).A segunda estrutura contém uma tabela,
usado para chamar as funções do subsistema gráfico.Os outros dois
As estruturas ZZT ainda não foram usadas e reservadas para o futuro
O sistema do sistema.

Leni para 580 coruja 150 |
Gudrey Zekasa _Zevutsu Ozsvtratov Tavier
{
Zuzem Zeustsy Tavier Poozkgi1;// pab1ue AR:
Zuzema zeruts tavier e) p32k;// aa1/shog
Zuzem zeustsya tavier tab1z3;// não usado
Zuzem zeustsy tavier tab1e4;// não usado
} Zevutsu ozsvtrov_tave,
*Rzevutsu ozsvtratov_tavts,
** rrzevuts de beznvtratov tavier;

Pnsinin 2:33, Zuzchagt Zguso TV (951)
#Ragta ot (1) th

Sudesee Zekis _zuzem zevutsa_tavier
{

Rmtrovis $ esu1setai;// Matriz de pontos de entrada
Royovo Sopa -Up1e;// Matriz de contadores de uso
RMOVR - ZEGA1!// número de serviços na tabela

Ruwut Agitepeta1e;// Matriz de comprimentos de argumentos
} Zuzem $ zeusets tavge, rzuzem zevets tavier,
*+ Rrzuzuzema zevets tavga;

Um dispositivo esquematicamente $ de e $ t é mostrado na FIG.2.7.

O campo Zegisa em $ $ T contém o número de células nas tabelas deste US $ 5T.
O campo de Tai Zeguse contém um ponteiro para uma variedade de endereços de funções, SMOITSCHEG

pagina: 84

78 Capítulo 2

Tay- Um ponteiro para uma variedade de contadores do número de chamadas de cada uma das funções
TSI, AGTIP TAYA - Uma tabela com o tamanho dos argumentos das funções.Detalhes
Uma descrição das estruturas de zot e US $ 5T pode ser encontrada em [3].

$ 0t

Zuzem_ $ EVKMS_TAVIER

Zet

Zuzem_sevms_tave Endereço da função 2
Eles são Tai

Zegisa é
|T,
Zevus Tavi Tavi Dita TV
.
Zuzem_evmu!
`Tamanho do argumento 1

O tamanho dos argumentos 2

Arroz.2.7.Dispositivo $ de e $ $ t

Na verdade, apenas uma matriz é interessante para instalar a interceptação
Zeguse Tai em 55t.Para chamar a função, você precisa saber seu número- sim
pelo número da matriz, que é indicado pelo Zegus Tai, é o inferno
Re e a função é feita.

Os principais tipos de zagueiros!

Considere os principais tipos de Kegpa |

Sobre a interceptação da função editando endereços em K15T.Este é o máximo
Um método múltiplo, no entanto, um tipo semelhante de interceptação é muito perceptível e
Existem utilitários como o ZotVisoga que permitem restaurar o K1ZT.

Sobre a interceptação da modificação do código da máquina do núcleo.Intercepção desse tipo
É mais difícil de detectar e neutralizar, para que possamos assumir que
Este método substituirá gradualmente a modificação do CT.Um de
Os recursos do método são a capacidade de interceptar funções que
Não chamado por Kiz ou não exportado pelo núcleo.

A interceptação do vetor é o segundo e o zuzetet.
Instalação do filtro de driver.
Instalando a função operacional do download de arquivos executáveis ​​e O.

Oooo

Modificação de objetos de núcleo sem interceptação de funções.

pagina: 85

Programas e princípios maliciosos de seu trabalho 79

Intercepção de funções editando CT

Este método é mais comum e já se tornou um clássico.Instalação
O interceptador neste caso é feito de acordo com o algoritmo a seguir:

1. Rugkit recebe o endereço da tabela ZOT.O endereço desta tabela é exportado
O núcleo, portanto, receber o endereço $ não causa problemas.

2. Rutkit analisa o primeiro 55T - este é o kzumetzgiseta.

3. Do campo 5egis tai em k!
Funções endereços, o Índice de função permite que ele encontre a célula desejada
mesas.

4. O endereço da célula detectado da tabela é preservado em alguns
driver de troca, após o qual a função da função é inserida nela
interceptor.Antes da gravação do endereço do interceptador, o driver Rutkita é
As esposas proíbem interrupções e redefiniram o registro de bits do SWO.Bit ir (y \ tie
Rgmmeseop-Procomemion of Weding) é o 16º bit do registro de seu processo
Sora, ele é responsável pela costura do estrato da gravação ao lidar com o nível
Supervisor.

5. Depois de gravar em Zegus, o motorista deve restaurar a co- co-
Ficando um pouco e permitir interrupções.

Esta técnica é usada por rotas existentes (em particular
Vaskdoog.
Nitorando na operação do sistema.Além de modificar os endereços das funções em su-
Casuts são encontrados, com base na criação de seus próprios
Valnoye Zegis Tatz com a gravação subsequente de seu endereço em K \ zuchegtbeguseta
(Essa técnica, em particular, é usada pelo monitor do antivírus CAS
Pursky).

Considere um exemplo de um motorista que intercepta funções no modo núcleo.EM
Um exemplo interceptará a função 2mskaate11e para monitorá -la
Chamadas e demonstrações de bloqueio de acesso a arquivos.Para instalar o
O editor precisa pelo menos obter o endereço do zot e descobrir a versão
(mais precisamente o número da montagem) do sistema (Listagem 2.34).

Pisting 2.34, indicador para 507 e número de sb rct mt

ehegp "c" {
// ponteiro por $ 0t
Ekhegl rzevuts rezvrtov_tavier kebug1sebezt1reocht] e;
// Número de montagem MT
ECHFEGP ROOVO MEVO11AMOPIG;

pagina: 86

80 CAPÍTULO 2

O segundo passo é o anúncio do protótipo da função interceptada e
variável para armazenar seu endereço (listando 2.35).

Fooduye Nutztato $
(Mtart *p7msgeake11e) (
Opt rnambhe e11enapo] e,
Tm ascez $ mazk ozh1hedasszz,
TN está ansioso para anexar $ sobre] estaseg1rakes,
Oot rto $ tato $ vgosk tosaatozv1osk,
Rtavsa tMcesev a11osae1op $ 12e orttomats,
Otomus e11eaeg1yhezh,
OROMS ZVAAHAUSSZE,
Ottub sgaak01zroz1e1op,
Otomus sgeebeore1opz,
Ruto Eaveoye Orttomag,
Tm oms batepaev
);
// Indicador para função interceptada
P7 \ Seaeee1e1e 0192msgeake11e;

Ri- - - - - -

O próximo passo no desenvolvimento do motorista será escrever uma função
Znook, cuja tarefa é a instalação de um interceptador (listando 2.36).

Uoto zeek15ttnok ()
{
Omovo O1asvo;

/!Aumento prioritário
Kstrog o1aaly = keva1 zetha1 tobotsyeuye!();

// Redefinir o sr bit
_Azt {

Puu eah,

pagina: 87

Tecnologias de malware e os princípios de seu trabalho 81

POU O01AASAO, EAH
Apa Eax, Okeegheye

Sou, Eah

5i1esv {*"mvo19marekh) (
SAZA 2195: // P 2K
0142 \ stease11e =
{P2isgeakee11e) *kebugo1sezse1reogta1-> ptozktgp1.
Keshegu1sebezssg1reogta 1-> ptozkgp1, $ esu1seta1e [0x20] =
(No. TRADOS) *MUFESTEAEEE1E1E;

BGEAK;
SAZA 2600: // MA XP
0142 “steafrae?

(P2MSGEA *HER11E) *KEBEU1SEBEZSA1REOGTA1-> poozkgi].$ Esu1setA1e [0x25];
Kebekho1sezsk1reogt6] e-> p50 $ kgp] 1, zega1setab1e [90x25] =
(Mtrvos) *m2msgeatee11e;

BETAC;
SAZA 3790: // \ 2KZ
0142 vystaeee11e =

(P2msgeacher11e) *kzegu1sebezsg?run1setA] e [0x27];
Kebug1sebezsk1reogta1-> p605kgp1.ZEGA1

(Mraos} *muemesGease11e;
BGEAK;
}

// Restauração de IR
_A5t {
POV EAX, O1asvo
MOU SGO, EAH
}
// Restauração da prioridade

Kogethetka] 1 (O1ararog);
}

pagina: 88

82 Capítulo 2

A interceptação de configuração é uma operação típica, que envolve não
Quantas etapas:

!Prioridade crescente, o nível atual é lembrado na variável
Ottatny.

2. Redefinir o pouco ir (y! Giy rhusuded) no registro de seu processador, o que levará a
Desativando a proteção do núcleo a partir da gravação.

3. Lendo o endereço da função interceptada de Zegis Tasha e gravação
Em vez disso, os endereços de sua função interceptadora.

4. Restauração do bit IR e uma diminuição de prioridade para o nível inicial.

Em caso de interceptação de várias funções, é conveniente criar um sinal com seu número
Rami - neste caso, basta determinar uma vez a versão do sistema e
Escolha uma tabela de eco.Funções em k1zt para o sistema \ m-
Chow MT, 2000, XP e \ Umpdo \ 5 2003 podem ser encontrados no Apêndice 1.

A função interceptadora em si é bastante simples (listando 2.37), seu trabalho é
Beba na saída do nome do objeto através do reaidrx1px.Em seguida é a pesquisa
Goocks “Gooki” em nome do objeto- no caso da descoberta deste
O KI Interceptor conclui o trabalho e retorna o código do ZTATI $ ASCEZ $ _METEG.

Pistimg 2.37.Interceptação de fungos

Mtztato $ m2mstaeeeee1e {
Oot rnamoge e1enap1e,
Tm asse $ $ mazk o51hedasszz,
TM está aberto a anexar $ 10
Oot rto $ ztatoz $ WAX TOBHASAZV1OSK,
Tm ryavsa titesv 2a]} OS10OP512E ORTHOMATS,
TN OTTUB E1TYEAES4ROEZE,
14 Oboms zpagagassezz,
14 Tempo obrigatório obrigatório
TM O9GOMUS SGEEBEORE1OPZ,
TM Ruto Eavyueg Orttomat,
Tm otomus é eape

Obdre1 pe ("%® iz \ p", ozeses-asg1rossez-> o) ossmame-> ocidental);
// bloqueando o acesso a um arquivo que contém a linha "obliquamente para & e"

pagina: 89

Programas e princípios maliciosos de seu trabalho 83

1e (ozet (sobre] eupaex-> 06] eemate-> uivos, 1 "josk1e")! = Mãe.)
4

Berare1 pe ("Tosca E11e 11 !! \ n");

Hekogi Isso é $ Assez $ WRAP;

}

// chamando a função original

HEAIIP 01YA2MSTAASEI11E (E11enag1e, pintor -gedassz, sobre] Esteeg1eeza,
TOZBAEO $ V1SK, A11OSAE1OP $ 12E, E1} EAEU1BROV, ZMAYASSZZZ,
SGERAR1ZROZ1E1OP, SEASBEBRESOPZ, EAVYUEHG, EAFEPDEN};

O exemplo do exame de interceptação é muito simples, porque não analisa
Os dados retornados pela função e não o modificam.Considere mais
Um exemplo difícil e muito popular é um mascaramento interceptador
Cesas da detecção de acordo com uma determinada condição.O princípio de seu trabalho será
Baseia -se na interceptação da função do 2MoceguzuzuzuzuzEzketiteoisot (Listagem 2.38).

Pistmong 3,38;Sua função é UV

Mtgutato $ 2m0ceguzuzuzuzuzuzuzuzuzetpiegta1olp (
Tm oroms zuzettoyogt 1ops1az,
Tm ruto zuzesettiokh'i de,
Tm oms zuzettibogpa 1optepaev,
Oct Ritos webagptoeneNen)

Esta é uma das principais funções usadas para obter informações
Sobre o sistema.Chamar a função envolve a transferência do código de informação da informação
No parâmetro de zuzeeptpeogta1ops1a: 5 e buffer para sua colocação
(O ponteiro para o buffer é transmitido para zuzeseptiahiokhosot, o tamanho do buffer em
Zuzkettpoogtae 1 Ophypaen, o buffer é distinguido e liberado
processo).Se o tamanho do buffer for suficiente para transmiti -lo
Informações sistêmicas e, em seguida, função 7.
Este buffer e completa seu trabalho, retornando o código de status
Ztatiz _ $ 0se $ $.Caso contrário, o código de erro é retornado
Ztati $ tmeo temstn mttzmatsn, sinalizando o aplicativo que
Um buffer maior é necessário.Para obter uma lista de processos dados
A função é chamada com a classe da classe de zuzseprgosezeszapatngea 9 tpeogvas {op
(5), e no caso de execução bem -sucedida do buffer, está cheia de estruturas,
descrevendo cada um dos processos (listando 2.39).

pagina: 90

84 CAPÍTULO 2

LPasting 3. 39. Estrutura, processo de inventário

#Rhadta opa (1}
Foreaeo zsgosa _zuzftrgosezapapApaaa5ttetotot (

Ohhh@ mehhepuguba] wa;
Soms tatheayasochcp;
Corujas vetus1 [6];
Tavsa tmctesev Seast1e;
Tavsa_tmesv ozecht1 aqueles;
Tavsa_tmesev kegpe1ti;
OMTSOV_ 5TMS RGOSEZMASTE;
Kretovtt Vazerg1ot14U;
Rgosezsto aberto;
Otfravity tlueh1euhagomrtoseza que;
Otomus nnapo1suip;
Obetos vesheguyu2 [2];

} TzuzuzetGezazzapatiaheaa: tpohyee1op;

#Rogshishch opa ()

Urede Zegasa _zuzetrterszazapatyaaa1op
*Rbuzseprgosezazapatyatpeokhta1op;

Campo de Meheepugure1eaa contém uma mistura até a próxima gravação, no último
Seus registros de Meheeptgurbe1+, bem como zero.Campos do rgosezt e rgosezmamam © 0-
Mantenha os Rs do processo e seu nome.

A instalação do interceptador é completamente semelhante ao exemplo anterior,
Consideramos isso apenas o texto original do próprio interceptador (listando 2.40).

Listagem 2.40.Disfarce de perracelagem e agarração do processo

Mtutato $ MugMoceGubuseettheonta1OP (
Tn mumme zuzet1 peookhtae1opstaz,
Tm ruto zuzettpogta1op,
Tm soms zuztttttaetetetoposv,
Ott Horn vetoagkpuapan)
{
Mtutato $ dirigiu;
/!Chamando a função inicial

pagina: 91

Programas e princípios maliciosos de seu trabalho 85

Dree = o0142moluguzettpteogta1UOpt (zuzettpeoogta1ops1a $ 3,
Zuzkettpeottae1Uop,
Zuzesettpeotta 1Opepaen,
Webokpgepai);
// Análise do tipo de função e resultado
1e ((zuzesyutpoogva <1Ops1a $ 5! = 5) ||
(Menino! = Ztato $ 30Sses $) ||
(Zuzesettleogvai1opfpepaev == 0))
Kebigp VE5;
R5USTERGOSESIS ZEZAPATAEAAAA $ 1 Propotae {OP
5t 1 presunto = (P5USSEPRGOSEUSE5EZAPATIATHEOSTAI1OP) ZUZBELTPOOGT OP,
Zt_reugbet = wash;
// o volume da parte não infectada do buffer
{/ Volume da parte analisada do buffer
Tabela bsapipdaai = 0;
// Análise da matriz resultante
Ao {
Zsapepaen += 51 tsem-> mehsepegu;
Ozrge1 pe ("rgsu5514a = %a \ p", 5t teetm-> rgse5519);
// O objeto tem um nome?Nesse caso, estamos procurando uma linha "Gooek1 ("
1e (51 _theet-> rgosezh5 marentened! = Mamãe.)
1e (chs556t (5t_tem-> rgosez5mate. Veeeg, 1 "go6k1e")! = Mob) {
COLLAPSE1 PE ("H14E rgoseeeeee5 %m $! \ P", 51 _tbet-> rGosez5matma. Veeeg);
// máscaras do processo
1e (51 tgeep-> mehepex0e15a> 0) 0)
5t reeuthet-> mehhepuguba1 $ a += 5t_ttket-> mehsepaguba1ka;
E15E
5T_RGEUTEEL-> mehhepuguba1ka = 0;
}
E15E
Zt rgech1 Ter = 51 _t%;
// transição para o próximo elemento
1e (51 tbet-> mehhepek [e] ka> 0)
Zt tsem = (p5usBetSezeszapatiteaaaa; tpettae1op}
{(Ottub) 5t_th + 5t_tbet-> mehepskuye1 ‹a);

pagina: 92

86 Capítulo 2

E1ze

Buja;
} Iv11e (zsapiepd®y> = zuzestgolegtastopieps ev);
Hesite está dirigindo;
}

A função interceptadora primeiro causa a função inicial
7MoceGuzuzuzEzetvToProkta1OP.Análises adicionais são fornecidas, fornecidas
que a função é chamada com a classe 5, funcionou com sucesso e
O buffer possui um tamanho não zero.Verificação do tamanho do boofer em princípio
É excessivo, mas o resseguro não vai doer.Além disso, para a análise,
Dois sinais - um ponteiro para o elemento analisado atual $ 1_
O ponteiro para o elemento não dimensional anterior $ 1_rchkeut+Eat.Além do mais,
A variável Zsapgepasn é introduzida, contendo o volume do analisado
partes do buffer.O processamento de registros é realizado em um ciclo, a saída da qual
caminha de acordo com duas condições - no caso de processamento do último elemento
(Verificado por $ t_tkket-> mehhepshuba1) ou no caso de um fim
buffer (verificado pelo significado de Zsapgeepchen).

Mezhegudek -
BUZETRGOSEZE5APATIGEACHPYUPAYOP
Mezhepgueca

ZuzetRGoseUse5E5aparead $ poptayopt
Mezhtnguena,

Buzetregosezazapat pgaa9 $ 1pyugtaVOP
Moshelgueva
BuzetRGosezazapatgeioptatsop s

Arroz.2.8.O princípio do processo de processo

O processo é disfarçado (Fig. 2.8) também é realizado quando detectado em seu
Não é a palavra -chave "goo {ki" (é levado em consideração que o nome do processo pode
estar ausente) e é alcançado adicionando mehsepezur1h da corrente
O processo para o Meheephura1 do anterior.Nesse caso, dados sobre o disfarçado
O processo permanece no buffer, mas sua análise não será realizada, ou seja,
Um níquel para o próximo elemento do buffer é realizado usando um mehsepeture1+a.

Esta função é bastante operacional, mas há instruções para o seu
Melhoria adicional- por exemplo, adicionando valores
Garotas de desempenho de processos mascarados para os contadores de um e 3
Visível, ou disfarce de processos nos quais TPPEG: Ce4Korose;
Indica o processo disfarçado.

pagina: 93

Programas e princípios maliciosos de seu trabalho 87

Da mesma forma, um pode distorcer o outro sistêmico
Informações obtidas usando 7 ioceguibuzkettpoogta1ot.Naquilo
Caso no interceptador, vários blocos de análise são construídos, dependendo de
Código da classe de informações.Por exemplo, a classe zuztevmo@a1etprogva1op
É usado para solicitar informações sobre os módulos do espaço do núcleo,
5 UzhetNetsy1ETOGTA1SP - Recebimento de informações sobre descritores, etc.

Em uma nota

Esta função sem alteração pode ser usada no Zegmod.Diferença
Somente no fato de que as funções de meceoguzuzuzuzuzuzuzuemtpoogt 1op e
7MoceGuzuzuzuzuzuzuzEtaeogia {op in Pan.A.

Intercepção de funções modificando o código da máquina do núcleo

Este método é que, depois de determinar o endereço de interceptar
Minhas funções de acordo com K1ZT estão modificando os primeiros bytes ou per-
Equipes de máquinas expandidas de seu código.A técnica é absolutamente semelhante à consideração
Metodologia anterior para interceptar funções em chzegmeye usando
substituições dos primeiros bytes do código e naturalmente o mais correto
é a "substituição dos primeiros comandos", implementada usando
Dizassembler da duração das equipes.No início de 2005, essa técnica não tinha
propagação especial, no entanto, após o aparecimento de anti-infirtos com função
A análise e restauração de endereços em K1 $ t Esta técnica se tornou
Aplicado mais e mais frequentemente.

Considere a implementação da interceptação da função 2ChStacia11e usando
Código da máquina duals.O primeiro passo será a declaração de estrutura
RY destinado a armazenar informações sobre a função interceptada
(Listagem 2.41).

Verdade 2 41. Stectur, escreva -offs

#Read of (1}
Zegis ttpeegseretaeo (

Rusnav Kips & 1Fopaag;// Endereço da função

RSNAK - Nookaaga;// Endereço da função interceptadora

Elive por EripseSod [5];// Primeiros bytes do código da função

Elive - Nooczmr [5];// Código do comando MR para a função intercosa
};
Yarglata opa ()
// Estrutura de Totsegsertpeo Beed pela função superaquecida 7msGeaseya11e
TECYEGSERSET AO 2MSGEASE DESTE DIA;

pagina: 94

88 Capítulo 2

É conveniente modificar o código da máquina na forma de uma função separada
$ Yesnoxoire (listagem 2.42), que receberá como um parâmetro
a estrutura do ttpeCetSerttfo e a bandeira do Azeenok, indicando a execução
Operação de tipo.Se o Azeenoookk for igual a você, a função executa a instalação
Código de referências (no nosso caso, esta é a equipe OMR).De outra forma
A recuperação do código da máquina da função interceptada é realizada.

Listagem 2.42.O procedimento que é uma máquina de máquina 5
Função saltada

WATR 5ENOOOOOOODODE (TTPEEGER TPEO TISGSSSERTEPYO, OS AZEENOOK)
{
Tubovr O1askvo;
// Redefinir o sr bit
_Aet {
O / u eah,
Veh de O1asvo, EAH
Apa Eah, Ohoeeeeee

Mostrar SG0, EAH

1e (Abe (Nook)
Metsr (Tobehsersetleo. Kopse1opayag, & tpsegsere1peo. Nookomer [0], 5);
E1 ze
Metsr (tpeegsereto.
// Restauração de IR
_SOU (

TSOU EAX, O19Svo

Mostrar SG0, EAH

Função 5eenOoxso4e despeja o bit antes de modificar a máquina
O núcleo do núcleo e o restaura após a modificação.Para implementação
resta uma interceptação para implementar uma função que preparará a estrutura
TPEGSER®TPEO (Listagem 2.43).

pagina: 95

Programas e princípios maliciosos de seu trabalho 8 ‹
Orl Voyage of the Ininnichunnnyai

Watr ToBagServSegopse4ot (TTPBEGSERETORA TOTHEGSSERTEPFO, RSNAV Nooksag)
(

// aumento de prioridade

Nó.OLAASHNY = Keva15etha1 Torbrsyuyu!

// Lembre -se do endereço da função interceptadora

TPEUSE!

// Preparação da equipe UMR no buffer Nookummr

Ozhovr umr ves] b = (pmovo) tpegsersersetpeo.nokaa@g -

{(Oiovo} tpekhseretaeo. Kopse1 spadag + 5);

Tpkegsertpoo, noocomor [0] = 0hee;

Ntsru (& tpeegsersetpeo.no -komor [1], & zmr v1, 4);

// copiando o código da máquina da função interceptada no GapSesSod
Pepsru (& tpkekhsersetp pe.
// interceptação

Zesnoxode (tpeehsereto, 6º};

// Restauração da prioridade

Kezmett g] (o1avag};

}

A função da função é bastante simples:

1. No buffer de Noskor, a equipe ZMR é formada, transmitida
o controle da função interceptadora.

2. Os primeiros bytes da participação da máquina da função interceptada são preservados em
Bufer Gopssesode.

3. Usando uma chamada 5 lensooxo@e, é realizada a interceptação.

A função interceptadora no processo de seu trabalho deve restaurar o código
Função danificada antes de ser chamada e depois (listando 2.44).

Yutztato $ m2msgeeer11e (
Oot rnamoge e11enap] e,
Tm ascez $ mazk rezgedassze $,
19 ROVAGE ANEXO
Opt rto $ tati $ WAX TOBEEAAZV1OSK,

pagina: 96

90 CAPÍTULO

Tm ryavsa tmctesev A11OSS1OP512E Orttoma!,
Tm obums e'1eH1otsez,

TN 010 №B ZPAGAGAGASSZE $,

Tm oomb sgaas015ro $ 11ps,

Tm 01.o0oms sgeaesosopz $,

Tm ruto eaaveyeye orttomat,

TM Ontomb Eafepaev

Ryara1 pek ("%e $ \ p", cerca de] etesek1risesses> 06] es®mame->>
// bloqueando o acesso a um arquivo que contém a linha "Gooskai"
1e (MSEK (OZESESESES1YOSSEZ-> Obzeemama-> Viyoeye, t "Cook1e")! = Mob)
{
Bbarlia ("Tosca #e11e !!!! \ p");
Hesigp é $ ASCE $ $ REMTEEPO;
}
// chamando a função original
Ctztato $ dirigido;
// Restauração da função do código da máquina
Senookxce {2 \ Steam11e1tteo, #A15E);
// CHAMADA DA FUNÇÃO
Dree = 2/iegeaee1e (p`1enapa1e, corte -Hayussizz, cerca de] estasek1za,
Tobfaei $ B1SK, A11OSA & 1OP512E, E1111EAESG1RIEZE, US $ 5 $ 5
Sgeas015ro $ 1E1OP, Seseror1OP $, Eavieeeyee, Eaepdsy);
// Instalação do código Lear no início da função
Senooxoche (7mskaeeee111tpeo, venha);

Uesigp dirigiu;

Como no caso de uma metodologia semelhante de interceptação em Zegmod, vulnerável
O local é duas operações de modificação da interceptação do código da máquina
a função para cada chamada.Isso reduz a rapidez do sistema
Tópicos como um todo e podem levar a um mau funcionamento no trabalho de sistemas multiprocessadores
temas, então este exemplo nada mais é do que uma demonstração
Métodos de interceptação.A melhoria funcionará muito mais corretamente
A versão de banho desta técnica é interceptada pela modificação do primeiro
equipes de pneus.Este método é completamente semelhante ao correspondente
Metodologia no lago.

pagina: 97

Programas e princípios maliciosos de seu trabalho [*)
Rig lj Ate zhpppppppppzhzhpzhPhPozHzhpzHPHPPUnpodzHpodzHpodzHPUnpzhpppungpppppppppppppppppppppum

Interceptação do vetor 2º em Mumt4o \ с 2000 ou Zuzescheg em XP

Este método é baseado no fato de que o sistema chama \/PDO \ с 2000
chamado através de uma interrupção do PMT 2E1 e em Ulpdo \ 5 XP/2003 - através de Zuzescheg (ver
arroz.2.6).Portanto, é possível uma interceptação global de todos os sistemas
Os males sem editar o K1ZT e modificar o código da máquina das funções do núcleo.

Algoritmo para \/ptdo \ 5 2000:

1. O motorista está procurando uma tabela de vetores de interrupção (isso) com a ajuda da equipe
314+, após o que receberá o tamanho da tabela e sua localização.

2. O motorista lê da tabela o endereço do vetor de interrupção atual e
Ele está escrevendo o endereço de seu manipulador.O endereço antigo retém naturalmente
Xia para a possibilidade de chamar interrupção interceptada.

Algoritmo para uipdo \ $ xp:

1. O motorista lê o endereço do processador 5Uzshesh com a ajuda da equipe
Gatzg Cesser.No ECH, o número 1768 deve ser carregado antes disso -
Zuzemtv_tr_m $ b (lendo o endereço do processador de Zuzesheg).Encontrado
Kim, o endereço é preservado para uso subsequente na trans-
uma garra.

2. O processador do processador Zuzescheg é interceptado usando o comando igteg.

3. Fuccação-interceptor executa as ações necessárias para ele e depois re-
Fornece gerenciamento no endereço determinado na etapa 1.

Em uma nota

Nos US $ $ Mi, você pode (e precisa) PVRE o vetor 1mt 2en de maneira semelhante a Ulp-
até \ m5 2000. Isso se deve ao fato de que, em \\ ipdd $ xp, é permitido aplicar
Você é 1mt2e.

Interferência do sistema
Sem interceptação de funções

Usar essa intervenção no aplicativo não é
Rutkuts no sentido direto deste termo.Métodos de tal intervenção
Os corpos são chamados de olho (biesg ket!
baseado em manipulações com várias estruturas de kernel, que, em particular
Sty, permite mascarar os processos dos drivers, modificar os níveis
privilégios de processos e fluxos.Modificação de estruturas de núcleo, diferentemente
É difícil detectar interceptação de funções
O motorista pode ser descarregado imediatamente após o necessário
Manipulações, que complica ainda mais a detecção da "praga".

pagina: 98

Capítulo 2

92

$ $ venael imodalo aizhei jovvo *6 "2` eia

Hina.Anime 189
3413. Azamz 187 "

Yaiai.AZ1MZ 1 $ P
Ai.AZ1MZ 15 °

Iia.Achema 1 $ "
Hee.Aziz 157 "

55250.93 $ 5920493 $ 5990,93

pagina: 99

Programas e princípios maliciosos de seu trabalho 93
Pen Vordenosny de RI e em um momento

O "ro \ ki", tão chamado, recebeu a última prevalência,
Com base em manipulações com as estruturas do YervOS $ dólar.Essas estruturas
existe para cada um dos processos e forme uma lista dupla - para
Isso em cada estrutura da yrvosesse, existe uma estrutura de ase1uergosez 14 pcz,
contendo dois sinais - para os elementos subsequentes e nos anteriores
(Fig. 2.9).

A estrutura do ervOS $ s é diferente em \ μdo \ с 2000, \ mtao \ $ xp e \/2kz,
Este campo é e -zook (ponteiro para a próxima estrutura) e o ISO (ponteiro para
Estrutura anterior) e outros parâmetros estão localizados na memória
Vários deslocamentos desde o início da estrutura de Yervos $ s (os deslocamentos são dados
Na tabela.2.2).

Tabela 2.2.Deslocamento para vários elementos do dólar

Asnuergosevztskpz nome Ruo Tukep
processo de processo

Mipdoms 2000 AOO O1esn 12CV

Es
WHIP: $ XP, 088N 01741 O84N
MMPDD $ XP ZR1,
Uypamz 2003, OE8N 01644 [9.4]
U/pd $ 2003 zr1

U/pd $ xp zra

Em uma nota

A estrutura do Yrvosez $ é subcondecida;
Encontre informações interessantes sobre a página vir: /mlilm.pstoza.sottzrgsez/
Bookz/Obstrar/4354.azr.Há o texto do capítulo 6 do livro "1p51d
Misgo5, Wipamz 2000, T | Ha Ezhop ”com informações úteis sobre estruturas
Ervos55 $ e etnyao.

Para estudar a estrutura do YRVOS $ $ e de outras estruturas de núcleo, é conveniente usar
Depurador \ mp0ob;De!Você pode baixar o depurador do oficial
Site do MSGOZA.A versão mais recente no momento da redação do livro está disponível em
Endereço NIR: // $.
Este depurador é conveniente, pois se espalha livre e tem
a função do carregamento automático de arquivos fusos para o sistema estudado com
Site M!Para estudar as estruturas do núcleo, é necessário mudar de
Sknchik no modo de depuração do núcleo (Shee | Kegpe!

pagina: 100

94 CAPÍTULO 2

Maneiras de armazenar arquivos fusos e dar um comando para atualizar o simbólico
Informação:

1. Com a ajuda de uma equipe, Zuprazn deve definir o caminho para a pasta,
para o armazenamento de arquivos fusos.Por exemplo, uma equipe pode ter
VISUALIZAR:

Zupraev ezva*o caminho para a pasta com
ROV*fã: / / pz1.1 Begzoe.su/dowls] oayu/zutr1 $

2. Realizar informações simbólicas usando um comando
.Esta operação pode levar muito tempo, no entanto
Para um pesquisador de sistema, é útil ter um conjunto de fosso para todos
Arquivos principais do sistema.

Depois de atualizar informações simbólicas, você pode fornecer o comando:
O que é!Ervosa $ dólar

que exibirá a estrutura do yrvoseuse5.Chave -Displays dados no
devolvida.
O algoritmo para trabalhar com Yrvosez $ consiste em três etapas principais:

1. Com a ajuda de Keta!
O ponteiro para a estrutura do Yervosezz do processo atual.A estrutura é diferente
Para versões diferentes do sistema operacional, então você deve primeiro determinar
a versão do sistema e descubra se nosso motorista tem informações sobre
A estrutura do Yrvosez $ esta versão.

2. A pesquisa é feita da estrutura necessária dos Yervosezs, com base em
O fato de essas estruturas estarem relacionadas à ajuda de indicadores e formulário dois
Lista calma.Portanto, encontrar Yervos55 de seu processo de acordo com
Runnits de EG: ZOK (ponteiro para o próximo elemento da lista) e wok
(Ponteiro para o elemento anterior) pode ser passado por toda a lista.
A lista é surgida, o desvio está chegando ao retorno à nossa estrutura do Yervosez $.

3. Uma modificação de estruturas de US $ 5 encontrada por YRVOS é feita.Em particular.
Pode:
= Alterar os processos RGO, valores dos campos de ttadecamam e ttadee11mamam,
que todos os analisadores padrão confundirão;
»_ Altere o nome do processo;
»Para disfarçar qualquer um dos processos que são alcançados com a mudança
Links de elementos m - ti M + |Ignorando o elemento M.

Ao conduzir uma análise das estruturas de Yervosezz, deve -se ter em mente que
TobyessOlepergosesis;retorna o ponteiro para o início da estrutura da corrente
O processo e o endereço em E1lik indica ascA1Uergosezz1apzs do subsequente
Ervosez $.

pagina: 101

Programas e princípios maliciosos de seu trabalho 95

Existem muitas implementações prontas deste método, conhecidas pela preparação
componentes e drivers para executar essas operações.Em particular
Estágio, no mi \ u. mabtgi, você pode encontrar um exemplo de implementação pronto para o original com o original
Texto:% s.

Deve -se notar que essa técnica é aplicada ativamente por alguns
Produtos comerciais.Em particular, o Anticlogger Riuasukeuboaga
Assim, mascara seu processo.

Considere o exemplo mais simples da implementação do trabalho com estruturas
EROS5 $ 5, que funciona de acordo com o algoritmo descrito anteriormente (Listagem 2.45).

Listagem 245, ignorando a estrutura do processo de disfarce de Urosvea m
Uoto Naergosezsvurto (} PTO)
4
// deslocamentos dos campos da estrutura de Yervos $ $
Ascea1Uergoseza spomshelezee = 0;// estrutura ask1uergosuz pc
Oms rgosezmeteeeze = 0;// o nome do processo
Otomus repreyeveye = 0;// Processo de PTO
Zmzesn ("mevigamopieg) {
SAZA 2195: // IT 2K

Asezuergoseztapkkho -sea = 0hao;
Rgsezzmaneoeoeye ze = 0x01s;
Representante = 0x09c;
Kommersant;

SAZA 2600: // em XP

Ase1uergosazazeze = 0x88;
Rgosezmatoooe ee = 0x174;
Rgooeye ze = 0x084;
BGEAC;

Saza 3790: // i2kz

ASE1UERGOSUSOOKOYEZEE = 0x98;
Rgosezmeteooe ee = 0x164;
Representyenee = 0x094;
BGEAC;

}
1e (ass1uergosuz 3] pkoezes == 0} gegagp;

Cerv.

pagina: 102

96 Capítulo 2

1e (! DIA PERGOSEUSE $) GUBIGP;
Rtzt emtva SIGHEPERGOSEZARG =
({Rytzt emvu) ((ioms) sikgeperGoseza + ase1uergosezz 1lekoyezee);
Captura de Ralzt do rgsezzari = siggeperhosezarg;
Otomus rgosezzrto;
Rsnav rgosezmitar;
KNROG OLAROG = KEVA1 ZETGA1 TOBRSYE!();
Ao {
Rksezzrto = * (rogob) ((gaoms) rgosezar -
ACS: Uergosez 1 1p1 Mouneezef + rtooezek);
Rgsezmasha = (rsnav) ((01yum@) rtosezar -
Ase1Uergosezz111pkokyeld + rgosezmeteooooeeses};
Obaretpe ("%", rgosezzrro};
// máscaras do processo
1e (rgosez $ 5r1tr == rto} {
Rcose5arg-> e13pk-> b11pk = rGosezar-> b11tk;
Rgos?
Zzrg1 p ("h1@e rgsezz %e", rgosezzro});
}
Rgse55arararar, = rgosezar -> epk;
} Mr41e (rgosez5ar! = SiggePerGoseze5ara);
KuGomegtga1 (O1ararog,);

O dispositivo desta função corresponde ao algoritmo descrito anteriormente.
A primeira ação é a análise da versão do sistema e preencher uma mistura
O NYY precisamos analisar a estrutura do YervOS $ dólar.No caso de não
A possibilidade de determinar o deslocamento mais trabalhos da função é interrompida.
A próxima operação é receber um ponteiro em Yervos $ 5 da atual
Processar usando a função rzbezigkepercosês e o cálculo do endereço
Estruturas de ASE1 tergosezzh1pk.Em seguida, é preso por todas as estruturas em
O ciclo, a condição da saída- o retorno ao YervOS $ dólar no processo atual, o que significa
ET que percorremos toda a lista.O disfarce do processo é reduzido para dois
Código de código, comutação de links da estrutura anterior do yerboseus5 $ on
Próximo e vice -versa.Um ponto importante é um aumento na prioridade
em frente ao ciclo de contornar estruturas, o que é necessário para proteger
para a conclusão de um dos processos no momento do trabalho
ciclo.Sem aumentar a prioridade, há uma ligeira probabilidade de

pagina: 103

Programas e princípios maliciosos de seu trabalho 97

Que no momento da análise de alguma estrutura, o processo terminará, o processo terminará,
descrito pela seguinte estrutura, neste caso, uma tentativa de analisar isso
Estruturas parecerão.

Qualquer um dos processos ocultos dessa maneira pode ser visível.Para
garantindo essa possibilidade no momento do disfarce, é necessário lembrar
o fio do ponteiro para a estrutura do processo processado boramente (ou
TEL ON ASA1UERGOSUZ1 PC NESTA ESTRUTUÇÃO).A abolição do disfarce reduz-
para o fato de que o processo oculto de Yrvosez $ está ativado em qualquer lugar
Lista dupla, geralmente após um elemento cujo endereço retorna
Rzbessigergos $ dólar.

Técnicas de mascaramento semelhantes são aplicáveis ​​em Lakegmodbe.Em particular,
Cada processo tem uma estrutura de rugido (RGSEZZ EPUTEP WAX -
O processo do processo do processo).O rugido contém muitas informações úteis, que
Torá pode ser lido pelo processo.O processo pode ser modificado
Tanto o próprio rugido quanto o rugido de outros processos.O único especial
A correção do rugido de outro processo é a necessidade de introduzir em
É um código de programa ou uso para editar funções
Rgosezmenoko e ig1eergrgosezmetoge.É conhecido por obter o endereço
Várias maneiras, considere os três mais populares.

Com o recebimento do endereço de rugido com a ajuda da função do mebohotyokotai 1oprosezz,
descrito em M $ Ohm e em [2].Este método está documentado
e permite que você obtenha o endereço do rugido de qualquer processo (NAP @E Process
É dado como um dos parâmetros).

Com o recebimento do endereço de Roar Reading Omovo do PI: [301].Este método é baseado
Van em que: [0] indica a estrutura dos chás (t №eaaa epmgoptegi
Vyusk - um bloco de ambiente de fluxo) do fluxo atual.Pelo deslocamento de zonas em
A TEV está localizada um ponteiro para o rugido do processo.

Com o uso da função não documentada do VE1BeyeSogge.
Ki P!Esta função retorna o endereço do rugido e em \ il \ $ x.
Beba em três linhas no idioma do AzzestyStyg (listando 2.46).

Listagem 2.46 Condução de tamanhos -Test Ffuncis It Smitit 5

Soja

Seche: 7S95E6E1.POU EAH, 1AHGEE #$: 18V
.Geche: 7s95e6e?
.$ eHe: 7S95E6EA GEEP

Como exemplo, consideramos uma das tarefas mais típicas- máscaras
Reding de uma das bibliotecas carregadas no espaço de endereço do processo.
Para mascarar a biblioteca, você precisa encontrar uma lista dupla,

pagina: 104

98 Capítulo 2

Informações sedentas sobre bibliotecas carregadas.Esta lista pode ser encontrada
Através do rugido - de acordo com o deslocamento do eixo, o ponteiro da estrutura é colocado no rugido
Rugido de fosso.Essa estrutura, por sua vez, contém três elementos do tipo
T15T EMTVA, que permite que você comece a ignorar as listas de bibliotecas.Tal
Três listas: tprayaogae'modova1 é 15%, timepoguogaatmo9o] er 13 e
1010161A1412A1OPOGCHEGMOD1ET1ZT.Todas as três listas descrevem uma e que
O conjunto de bibliotecas carregadas na memória do processo.A diferença é apenas
Para o fato de que a lista de Togoaogaehmodo1e11za é classificada em ordem
Cargas da biblioteca, tomepoguokaeugmodu1ea - na ordem de sua colocação em
Memória, 1pto11a112a <1OpogueGMO9O1E!
módulos.

Itimizar a lista é mais conveniente de realizar pelos elementos de tptoadogae'moviteg: ze.
Isso se deve ao fato de que, como no caso de Yervos, $ $, sinais de árvores de Natal e VAPK
mostrar não na merda, mas no 1T5T EMTVT correspondente neste
estrutura.TC $ T.
As estruturas do Buns_movog, portanto, seus endereços coincidem (listando 2.47).

Listnig 2 47. Exemplo ignorando as estruturas do biblon de marovka de Lock Marovka
com 'Zadan Nome |

RGOSDIKH TAOTT1.NA1CHA!
Uag
RT: Os vagos Vazts tmeovmatt;
Eagzemobi] e, texto 4: Gok _mobots;
Roar1: Rode;
Kommersant
// Solicitar informações sobre o processo atual (estamos interessados ​​em
// apenas o endereço do rugido)
1e meceguguraeogla <toprGoseze (bedoggeperCosezes,
O, // 0 = rgsezzvazzstPront {op
@Pt,
512E0 (Domel $ vazts tmrovmatt),
021} <> 5tato $ 5 $ 0sas $ $ fppp ex1e;
// Recebimento do endereço de leitura de rugido: [304]
Azt
POU EAH, E3: [305]
\ u roar1, eah
EPA;

pagina: 105

Programas e princípios maliciosos de seu trabalho 99
Zv dv - dc - d -d - d - d - d - ddjv

// Conclusão do endereço do rugido para o protocolo

Mepo1.3 Pesh.aiaa ('rohlt (m №eoceuton $ $) ='+
Totoneh (BMOV (Rt. Rebvazaiaagzz), 6});

Meto1.1pz.ada ('rohlt: [308]) ='+tletnech (região1, 6));

Meto1 .13p5.
Tpetoneh (em 1beesoggeperer, 6));

// obtenha ht5t_mtau o primeiro módulo na lista

E1gzemochi1e: =
Bov_mobots (Rosheg (Rt. Rebvazaayayathesz^) .19

K) ^);
Técnico: = Eagzemoda1e;
Geree
// Saída de dados para o protocolo
Meto1 .14pe5.ada (texto1e, e \ 11011] maca.
'Vasaazagzez ='+tastytoneh (9º (texto1e, vasaachyages $, 6});
// máscaras, se o nome contiver o teste "pyo11"
1e Roses ('P0E911', Homogksaz (Tekmodi1e, Ru11211 Mate. Ze Graza))> 0 Snop
Problemas1p

// Switch Links na lista de tpgoadogdegmoch1et 13%
Tov_mobog (RospeG (textuda1e.
Tigoaaaogaegmoso] por exemplo, 136. em] 17pk

: = Textos] e.Togayaeogaegmoda 1 ze.

KOOMOOROGE (RO1PEEG (Tekmodi1e.
Cho1er1 ze.RASGAR

: = Tekmodo1e.Tlgoaaaeogaegmodile1 ze.Pedra;
EPA;
// transição para o próximo elemento
Tekmodo1e: =
Kommersant_Mobot (RO1PTEG (Tekmodi.
// Saia do ciclo depois de ignorar a lista inteira
$ 1211 (textoi1e.vazaayayagzz = eagzemocho] E. Vazaadag $ z);

Véspera;

OBSERVAÇÃO

Existem longas filas no exemplo que não podem ser quebradas de acordo com as regras
Idioma acabado.

pagina: 106

100 Capítulo 2

O exemplo dado na Listagem 2.47 resolve três tarefas de uma só vez: produz
Determinando o endereço do rugido de três maneiras diferentes, cria uma lista de bib-
O processo do processo com base em uma análise da lista de estruturas do tremor
Uma biblioteca com um determinado nome é escolhida.Como perceber que não é difícil, a metodologia
As máscaras são completamente idênticas à metodologia usada na Listagem 2.45.
Para ignorar as estruturas da merda no exemplo, o endereço do rugido é determinado pela primeira vez,
Então, através do ponteiro et1pk, a estrutura da mordaça.TPOADOGAEGMOD1E1
A primeira estrutura de T0v_moroye para o primeiro módulo da corrente é pendurada.Geralmente
O primeiro módulo é o próprio arquivo.

No caso de um desvio de estruturas de acordo com os elementos das listas de tpmethuOGUOGDEGMODO1E1 13 e
1P111161A112AE1OPOGMOMOA11E11ZA Para calcular o endereço de Gov _mmm
É levado em consideração o deslocamento, que é, respectivamente, 8 e 16 bytes.

Na Listagem 2.47, modificação de links em apenas um dos três
Listas - em tlroayayagmo9i111111 ze.Isso é suficiente para a massa mais simples
Módulo Kirovo da detecção, mas, idealmente, é necessário alterar todos eles.
Deve -se notar que a remoção do elemento da lista de tpgoadogdeghmodo não é
tem um impacto negativo no trabalho do processo, mas a remoção do
Talal Lvukh leva a uma operação instável do aplicativo e pode
Funcional no fim.

OBSERVAÇÃO

O disco compacto tem o texto original no idioma C, completamente semelhante
Assistindo a uma listagem 2.47.Leia mais sobre as estruturas do rugido, _Rev_tra_OATA e
_Yov_morot pode ser encontrado no site do ICR: IIPDOTMEV.
Uzegmoda/gisiges/ou usando um depurador m/all.

A busca por objetos disfarçados de acordo com a tecnologia RCK é complexa
A tarefa geralmente é realizada por vários métodos.

Com o monitoramento de lançamento/parada de processos e bibliotecas de carregamento/descarregamento.
A busca por um processo oculta é realizada comparando os dados do monitor
Anel e os resultados da análise das estruturas do núcleo.Se, por exemplo, será encontrado
O processo, que, de acordo com o monitoramento, foi lançado e não terminou,
mas não pode ser detectado pela análise das estruturas do yrvosesesse $, então você pode
Argumentar que o processo é mascarado com a ajuda da tecnologia.

Com a busca por sinais indiretos da presença do processo no sistema.O
O método geralmente se resume à análise da tabela da varanda@e, interceptação
funções sistêmicas e monitoramento apelos a eles e uma série de similares
métodos.Todos os métodos são unidos por uma idéia geral- a detecção de não
O processo visível de acordo com alguns sinais indiretos de sua presença.
Como resultado, nenhuma metodologia garante a detecção de ocultos
processo.

pagina: 107

Programas e princípios maliciosos de seu trabalho 101

Com a análise do início automático e pesquise arquivos no disco.O fato é que
Os métodos permitem mascarar o processo.motorista ou biblioteca, mas
Não permita mascarar o arquivo do disco ou a chave no registro.

Os \ {ki com base no filtro de motorista
sistema de arquivo

O princípio da ação de Rutkin Este tipo é baseado no uso de drivers
filtro conectado à pilha de dispositivos apropriados.Um exemplo de unidade
O filtro Vera e sua instalação serão discutidos posteriormente na seção."Teclado
espiões ". Nesse tipo de rootkit, o filtro é usado para mascarar o arquivo
Põe e pastas no disco de acordo com certos critérios.Este é um protótipo
O motorista pode ser o texto original do motorista da utilidade do ineuemope e dela
Análogos ou exemplos de OOK (em particular, \ 5gs \ $ ogave \ vsgz \).

Os motoristas de filtro no momento não receberam um spread especial
E de acordo com as estatísticas, eles são mais frequentemente usados ​​para construir uma chaves
fosso.No entanto, programas prejudiciais trabalhando nisso
O princípio, por exemplo, COO \ th.

A pequena prevalência de rutkitte desse tipo está aparentemente associada a
O fato de que o disfarce no disco é claramente insuficiente para proteger o dano
Não -nose de detecção.

Monitoramento do sistema
Sem instalar interceptações

Esta tecnologia tem uma atitude indireta em relação aos Rutkuts, já que a raiz
pode usá -lo para introduzir interceptores em processos lançados
ou modificações de bibliotecas carregadas.

Para monitorar os principais eventos do sistema no núcleo, Ar1-
funções que permitem ao motorista instalar sashbask especializado
Funções projetadas para resolver os seguintes problemas:

Sobre o monitoramento do download de imagens de arquivos executáveis ​​e POM.
(instalado com a ajuda de rz5ee1tadaderoayamo +1 euvoca1 p);

Não. Monitorando a criação e remoção de processos
(Re5eeseeeerchose meu MOS: EUVOP 1 P.);

Não. Monitoramento da criação e remoção de fluxos
(? Rz5elesgeakheaaano <1euvots1p).

Para a construção de Rutkin, o maior interesse é Saiask-
Uma função instalada usando p55e \ f7tadaroayamo+1euvovoca1p,

pagina: 108

102 Capítulo 2

como é chamado depois de carregar a imagem do arquivo executável no
Senhorita, mas antes de seu desempenho.Isso faz de uma função semelhante um ideal
Stom para introduzir uma imagem carregada dos modos do lago em uma imagem carregada.

Considere um exemplo de instalação das funções de monitoramento dos três tipos.Pró-
Os Totypes dessas funções são descritos no MZM (Listagem 2.48).

Listagem 2.48.Prototi.SA SA!

Watv
({*Rtoab tmas motteu vovtma) (
Tm romtsoe_ $ tatms seu ipademate,
Tm namoge rgosezta,
Tm rtmas turo tpededEloo
);
Weot
(*Rsveate_rovis $ 5 _motu kottma) (
Tm namrier raiva,
Tm namoge rgosezta,
TN VOOTEAM SGEAF
);
Uoto
{*Rsveta tneao motteu vovtma) (
Tm namobi rgosezzta,
Tm namye sumaata,
Tm voosream sgef
):

A instalação de funções é bastante simples (listando 2.49), é apenas necessário
Para levar em consideração isso no caso de instalar pelo menos um driver de função do SAIBASK
deve permanecer na memória.

b |
Pistint 2.43.Instalação das funções de monitoramento |
// Baixe a imagem do arquivo executável ou OSH
Watr mu1oaatdademo+1euvoc1t (tm rumtsobe $ ttms e \ l111padadamapama,
Tm namoge rgosezta,
Tm rtmasa tmoo gradetoo)

pagina: 109

Tecnologias de malware e os princípios de seu trabalho

{

Ozre1 pek ("10a bastardo. Rtb = fa, ipada mate
Rgosezt, e] 1ttadademan-> voeyeg);

// Criação/Everificação de Processos

Watr MugeSechesuse Mo 1 Rusos1ta (TM Namoge RagePst &,,

Tm vamie rgosezta,
Tm vogeam sgeata)

1E (SGEAE)
Orarg1 pe ("sgease rgosezz. Ragepet

RagePETYA, RGOSEZT);
E1ze
Obargety ("re1efa rgosezz. Ragepet

Ragepeta, rgsezz1a);

// criação/conclusão de fluxos

Watr Musgeetegegeai 19

Tm namogey teaaata,
TM Generalham Sgeak)

1 (sgaase)
ODRGAP ("SGEASE ERGEA@. RGSEZZTTA.
Rgosect, tngeaat);

E1ze
Bzrk1ie ("be] efa {pgea.
Rgosezta, tegadtt);

//*zhzt*ponto de entrada para o motorista *****

Mtutatato $ bg1ukeepeku (tm roaguev_ovzest rog1ue) yesk,

Excesso+gura® c)
{
// Orgenter de Mostering FurnSS

%4, rgsezzt

Pois, rgosezzta

%4, tegeata

%4, tegeata

103

Físico \ n ",

$ a \ n ",

Para \ n ",

Para \ n ",

Para \ n ",

Tm romtsobe_ $ twitms

pagina: 110

104 CAPÍTULO 2

Mtutato $ v51
Mtztatio $ 2

Rabesgoyaa1vademok1 Euvoche1le (*mugoatdadem 1 ecocet esses);

Rz5elesgeaxergosazmo% 1 euvoca1ta (*musgeathergosez my 1euvozu, aqueles
queima);
Mtztato $ é 3 =
Re5e <seaketayayamaramevop1lp (*musgeasetgea mo: 1 euvos1ta);
// Retorno do resultado da inicialização
1e [(nós 3 == ztato $ $ 0sesese $) ||
{E2 ztato $ _ $ 9SA $ $) ||
(Nós 3 == ztato $ $ 0sesese5)}

// Se pelo menos uma função funcionou com sucesso, então o driver
// deve permanecer na memória
O Gesigl é de $ 0sas55;

E1ze

Hefagp é $ omzossezeri;

Este exemplo é conveniente como um protótipo para estudar funções de monitoramento.
Deve -se notar que em Ulpdo \ $ mt em Tozkgp |A função não é exportada
Rz5eoitadtadema1euvop1p, então o exemplo estará funcionando no SISSE
Tópicos, começando com \/msh4o \ $ 2000. O segundo recurso está relacionado à função
Re5eyesgeargoSMOM: 1EUUSUSE1P- É o único dos três
As funções permitem remover a função de SapaSk anteriormente estabelecida.
Executado - a operação é controlada pelo segundo parâmetro da função
RZ5 EsheSechesm 1 Eucocet1p (seu - Instale, EAZ - Excluir).

conclusões

Como no caso de Chzegmoda, a tecnologia rutkutka no modo de núcleo pode
Perto para fins prejudiciais ou para criar aplicativos úteis.
A diferença é apenas o objetivo da interferência em
O trabalho do núcleo.Deve -se notar que a tecnologia usada pelo Rutkiti
Modificar e melhorar de forma autônomo.A fonte da nova informação
Os Matcons nessa direção é o site \ i.goy.sot, que contém
Muitas informações interessantes e textos iniciais.

De acordo com as estatísticas, o regime de núcleo de Rutkin do copo da função mais intercepto, função,
listado na tabela.2.3.

pagina: 111

Programas e princípios maliciosos de seu trabalho 105
——————————— & & - = - & = & & & s & s & yshchshshch - - - - - - - - - - - - - - hh - shushys ———— aa - aa - aa - aa - aa - aa - aa - aa - aa - aa - aa -a --—— s.

Tabela 2.3.Funções mais frequentemente interceptadas pelo Keta!

Função sobreposição de funções típicas do interceptador

2SGetext Operações com o registro: Criação de bloqueio e
Abrindo as chaves especificadas

2 \ opkeu

2iBesea1ikeeu

Operações com o registro: Rastreamento modificado
parâmetros e remoção do registro e blocos

2be1esheua] tsekeu "
a alimentação dessas operações de acordo com uma determinada condição

2 Operações de registro mepopekgaseuu: máscaras e pa-

Rameters do Registro

2 mepemegaseuaekeuu
2YSGEASEI11E
2MEMEPE1] e

Bloqueando o acesso a arquivos e catálogos
certas condições

2CHstayab1kheskogo51Se

2MOPOT01GESEOOOOOOO) UE

2*eparGoseuse3z

Bloqueando a abertura dos processos fornecidos.Mo-
pode ser usado como um elemento de proteção
Estudo e remoção

2Moceguzuzuzemtpyeogt {Distorção irritada de um sistema sistêmico retornado pela função

Informação.Pode, em particular, ser aplicado
Para processos e fluxos de mascaramento, módulos
Espaços de núcleo

2Mopago1PASHCHI1OTR11E

Disfarce de arquivo, distorção de informações sobre

2oceugu01 Gescouer1 1e Arquivos e catálogos

2MoceGu01 Hesbogos)

Espiões do teclado

Os navios do teclado formam uma grande categoria de malicioso
Gramas que representam uma ameaça maior à segurança do usuário.

O teclado shpisn é um programa para registro secreto de informações sobre
teclas pressionadas pelo usuário.O termo "espião do teclado"
Existem vários sinônimos: Keuboag4 Goyoveg, Keugovweg, Keilter;Menos frequentemente
Os termos "atirador", "5 -proror", "5 post -g" (do inglês, Znor -literalmente
"Um homem para sempre bloqueando o nariz nos assuntos de outras pessoas").
Os espneros não são vírus ou vermes, pois eles não
para infectar outros arquivos executáveis ​​ou a propagação de seus
cópias para outros PCs.No entanto, o ETS não impede o invasor de atribuir

pagina: 112

106 Capítulo 2

Arquivo executável do teclado espião para qualquer um dos arquivos executáveis
Peixe no princípio do vírus para mascarar a presença de um espião no sistema.
Além disso, os keylgers comerciais que contêm o gerador de
Stillers do espião atribuindo o código do instalador executável a
qualquer programa especificado.

O espião do teclado pode ser feito na forma de um independente
colocando ou entra como um dos componentes no Trojan ou
Programa de espionagem.

Como regra, um espião moderno do teclado não apenas escreve
as chaves introduzidas - ele "liga" a entrada do teclado à corrente
entrada de janela e elemento.Além disso, muitos espiões do teclado têm
Várias funções de rastreamento do usuário, em particular, elas podem:

Com a frequência anexada, anote uma lista de aplicativos avançados;
Prestes a fazer "fotos" da tela de acordo com um determinado cronograma ou evento;
Sobre monitorar o conteúdo do buffer de troca.

As informações gravadas podem ser salvas no disco em aberto ou
forma criptografada.Com base nas informações acumuladas, a maioria
Os espiões modernos do teclado podem formar vários relatórios,
Eles podem transmiti -los por protocolos E -Mail ou NTR/ETR.
Além disso, vários espiões modernos do teclado são usados ​​pelo COO!
Tecnologias para mascarar traços de sua presença no sistema.

Para o sistema, um espião de teclado geralmente é completamente seguro.
No entanto, o sistema operacional é extremamente perigoso para o usuário- com sua ajuda
Um deliberado pode interceptar senhas ou abdução de configuração
Informações de negação inseridas pelo usuário.Dispositivo de teclado
O espião é bastante simples, então centenas de vários
Keilogers, muitos deles não são detectados por antivírus.

Várias tecnologias para a construção de espiões do teclado são conhecidas.

Ó espião do teclado com base em armadilhas.Este é o mais simples, universal
O método sebáceo e comum de construir um espião de teclado.

Ó espião do teclado com base em uma pesquisa periódica do estado
Teclado.

Sobre o espião do teclado que trabalha na technologia dos cookies.Seu princípio
Trabalhar é baseado na interceptação de AR!
mensagens do sistema.A interceptação das funções pode ser como no Ozigmoda, então
E no modo núcleo.

Ó espião do teclado com base na interceptação da troca de processos
C5G55.EH com o driver do teclado.

pagina: 113

Programas e princípios maliciosos de seu trabalho 107

0 espião com base no driver de filtro.O princípio da ação é baseado no
O novo driver para um driver de teclado.Este método é
Uma maneira documentada de rastrear eventos do teclado
Etia, um dos exemplos de implementação é apresentado no OOK.

0 espião baseado no selo do driver de teclado com seu próprio
motorista.

É importante que outros métodos de rastreamento do teclado possam existir
A entrada de excursão, em particular, com o uso de hardware.

O uso de hardware, de fato, é reduzido ao uso de energia elétrica
"Bug" do trono embutido no teclado incluído na quebra de cabo
Teclado ou calculado dentro da unidade do sistema.
Esse "bug" pode transmitir as informações recebidas pelo canal de rádio
Ou acumule e anote em um tubo.Tecnologias semelhantes não são
são considerados dentro da estrutura deste livro, mas especialistas em informações
a segurança não pode ser descartada de contas, principalmente devido à alta
A confiabilidade do método e a impossibilidade de detectar um teclado de hardware
Spy com software.A principal proteção contra o aparelho
O espião do teclado é o uso da tela tão chamada
Teclado - um programa especial projetado para emulação
Entrada do teclado.

Espião do teclado com base em armadilhas

Este tipo de espiões de teclado é mais comum e merece
consideração detalhada.O princípio da operação é baseado no uso de pele
Armadilhas de nizhoma (meia) do sistema operacional.As armadilhas permitem alguns
Roma para o aplicativo para observar as mensagens que são processadas ok-
nós outros programas.A instalação e remoção de armadilhas são realizadas com
A ajuda de duas funções bem documentadas AR!Bibliotecas
e $ EAT32.a1:

Com a função do zesi1pchonznoe, ele permite instalar uma armadilha;

Sobre a função do oostocoka1paochno -coat permite remover o instalado anteriormente
armadilha.

Ao instalar a armadilha, o tipo de mensagens para as quais deve ser indicado
Chame o manipulador de alçapão.Em particular, existem dois tipos especiais
Armadilhas: in_keuvoavoa e chn_moo5e (para registrar os eventos do teclado e
ratos, respectivamente).A armadilha pode ser instalada para um dado
atual e para todos os fluxos do sistema.Armadilha para todos os sistemas flui como
Uma vez usado para construir um espião de teclado.

O código do processo dos eventos de armadilha deve estar localizado em Osh.Esse
O requisito se deve ao fato de O. ser projetado com o processador de trap

pagina: 114

108 Capítulo 2

sistema no espaço de endereço de todos os processos su].Especial interessante
Basic é o que proopere 01.1.ocorre não no momento
Instalações de uma armadilha e após o recebimento de Su]-processo da primeira mensagem,
satisfazendo os parâmetros da armadilha.O exemplo mais simples da biblioteca
Já consideramos o interceptador, portanto, como a base para demonstrações
O shpisna do teclado Starum será o código de listagem 2.1.Biblioteca
ka mostrando rastreamento atrás do teclado usando armadilhas,
Zana na Listagem 2.50.

Listagem 2.50.Bibpiotene ", demonstrando o rastreamento do teclado Z*
'Usando armadilhas

] 3 Higagu Keu;
Izd

\ 1Lturez, Reprios $, ME $ Shake;

Sopze
// Código de mensagem usado para comunicação
Keubuep = mm o5ebk + 1;

Uag

Nooknap] E: Pnook;// nap@a1e, retornou para ze e \ ipdoch $ nook

Rgosedbige azatom ($: $ eg1p9);
Problemas1p
// Neste procedimento, você precisa colocar o código,
// responsável pelo protocolo das teclas clicadas

EPA;

// Function-Processor do interceptador

EIPSEZOP KEUNOSK (PSODE: ZPFEDEG; IRABS: MOGA; Praguem: Gopatpe}: Gopazpe;
$ E9SA11;

Uag

Keumasha: zet4pa;

Drive: Zpeedeg;
Ano \ yapadadnaptya1e: vita;
Problemas1p

// é uma chave para a chave?
1e (psode = nz asthom) Apa ((1 -rhgat apa $ 80000000)} = 0) tpep bedap

pagina: 115

Programas e princípios maliciosos de seu trabalho 1
ROSOSOSSO OOOOOOOOOOOOOOO SOO SOO OOS OSOSOSOSOSOSOSOSOSOSOSO OSO Soso Soso Osso SOSOSOSOSOSSO SSoso SSSO SSSO SSO SSO OOS APLIES SOSSI

// 1. Demonstração de teclas de protocolamento

// diretamente de,

// 1.1 Seleção do buffer para o nome da chave

Zeetepde (Keumama, 32};

// 1.2 Obtendo um nome por código, tome - a duração da linha retornada
Bort: = bekemametakh® (1Ragom, @Keumamama [1], ela sub -Subskor (keumam)});

// 1.3 Transferência da função de protocolo

Azaponod (Jora (Keumate, 1, Kez)};

// 2. Demonstração de transmissão de eventos para a janela Application-Registrar
// 2.1 Transferência da mensagem para o aplicativo de protocolação para a janela
O9i1 paochenapa1e: = roller \ Apayom ('tkeueworm', p11);

3e Todi1pamnap1e <> 0 tpep

Zepmeszade (Toz \ 1Pomnapt} e, Keutep, M “Ragat, 1 ragat);

EPA;

// chamando o próximo na corrente do manipulador
Vezi] e: = ca] 1Mechenooke (não -OKNAP] e, psode, gramas, gshrags);

EPA;

// Instalação do interceptador
Rgosedige 5efkeunokk;ze4sa1.1;
Beth
1e nooknapi1e <> 0 tpep ex1 {;
// Instale um interceptador como em _Keuuvovo - em eventos de teclado
Notknap1e: = Zee PDU (in_keuvoavova,
@Keunok,
H1tpzbaps, 0);
EPA;

'/ Remoção do interceptador
Rgosedige b1keunosk;5 & ​​4CA11;
b
1e noookhnap4] e <> 0 "nev.
Opvooki1pam5nookhok (no -oknapy1e);

pagina: 116

110 CAPÍTULO 2

Boknnapb \ e: = 0;
bêbados;

Ep9;

// Funções de exportação:
Echrogt5

Zekeunok,

Re] keunok;

Dificuldade
Nooknap] e: = 0;

Bucky.

O segundo componente desse espião de teclado é a gerência
Um aplicativo que resolve duas tarefas:

Sobre a instalação de uma armadilha;

Sobre receber e protocolar mensagens recebidas.

O aplicativo de controle é muito simples, uma das opções para sua implementação
dado na Listagem 2.5].

Pistimg 2 51, o tox inicial de uma reprovação rosa

SOP5%
Keuhehepe = mente de izv + 1;// mensagem usada para comunicação
Claro
Tkekuga = c1a $ $ (Theogt)
Shegodmeto: Tmeeto;
Rgosedige eogteas (5epdeg: tolese);
Rgosedbige eontezegou (5epdeg: tobessa);
Rsias
// Processador de mensagens como Keuue
Anel keuueupeNap 1et (uat mzd: tmezzade);Cyzada Keueuege;
Esfregar s
2146: tnapa] 1e;
EPA;

pagina: 117

Programas e princípios maliciosos de seu trabalho 171
z - ddaaaaaa - a - a -

Bater papo

Keurogs: tkekugs;

Zira1echechepfa op

EAPSE1OP BEXEUNOOK (AGOSTO \ 1PDOPENAPA1E: NIPA): ROPDATE;$ & 4CA11;
ekhbegp1 'keu.911';

SILSUZOP B1KEUNOK: TOPAZYE;5 & ​​3ca \\;
Ehregpa1 'keu.911';

{38 *.Comer}

Rgseaaag tkeurocht.Rogisgeak (Bepdeg; Thoros);

Problemas1p

// Instalação do interceptador no momento do lançamento do aplicativo Registrar
Ze Keunosk (Napa1e);

Eza;

Rgostyge tkeurott.Gogluzsgou (bepdeg; tobzes*};
Rep

// Remoção do interceptador no momento da saída do aplicativo de registrador
B1KEUNOK;

EPA;

Rgosebate tkekoggs.Keulepnap] 1eg (UAG No. 59: 1 meszade);
Uak
Keumate: zyog1pa;
Drive: MBEDEG;
BEA1P
// *** =*Obtendo o nome da chave *** t*
// Seleção do buffer
Zescepay (Keumate, 32);
{/ Recebimento de um nome por código, tome - a duração da linha retornada
Dree;
Keuming: = ninhada (Kemate, 1, padre);

pagina: 118

112 Capítulo 2

// adicionando ao protocolo
Pegodyema.

EPA;

EPA.

A metodologia de armadilhas é bastante simples e eficaz, mas possui vários não
fortuna.A primeira (e principal) desvantagem pode ser considerada que O. com
Uma armadilha é projetada no espaço de endereço de todos os processos que
Pode ser usado para detectar os teclados do espião.Além do mais,
O uso de armadilhas de depuração permite bloquear temporariamente o trabalho
Outras armadilhas dos tipos determinados.

Em uma nota

O texto inicial do grampo de uma armadilha com base em armadilhas é muito simples, na introdução
Existem centenas de espiões prontos e seus textos originais.Investigador-
Mas, uma pesquisa de assinatura contra esse tipo de espiões é inútil, especialmente
se o espião é feito "encomendar".

O método tem uma restrição - como observado anteriormente, o registro de eventos
Os teclados estão dançando apenas de 1 aplicação, isso é fácil de verificar com
usando um programa de demonstração.

Métodos de busca de espiões do teclado
Com base em armadilhas

Para detectar espiões do teclado desse tipo, você pode usar
Faça muitos métodos, o mais fácil é estudar a lista de módulos st |-
formulários.A aparência de alguma biblioteca estranha nesta lista
é a razão da investigação para descobrir que
Isto é para a biblioteca e com que finalidade ela carrega.Métodos mais complexos
Wilds incluem análise comportamental das atividades dos suspeitos
Bibliotecas.Métodos semelhantes são baseados no fato de que o espião do teclado
deve salvar os dados acumulados para o arquivo ou transferir alguns
Roma pelo processo de registrador.Metodologia mais complexa e complexa
é o uso de ferramentas especializadas que rastreiam a chamada
Uma série de funções AR1, em particular, 1 Paoonysokokh e SA111mechenokekh-

Análise de bibliotecas suspeitas se resumem manualmente para encontrar código,
uma armadilha naval e funções de processamento.Após a detecção
As funções são analisadas e concluídas sobre prejudicação.Em ka-
Exemplo de exemplo (listagem 2.52) pode ser considerado uma análise da biblioteca de

pagina: 119

Programas e princípios maliciosos de seu trabalho 113

Teclado Spy Ratya Keu 1Lovreg (esta biblioteca é selecionada em
A honra do exemplo devido à simplicidade e clareza de seu código de máquina).Respondendo
O código do programa é publicado para a instalação de armadilhas no Bibli
Tekie, que simplifica a análise.

_ Listagem 2.53.Fragiente da função desmontada
Vindo para a instalação de um lbbushk

„.

Seche: 1000150A VINDY EBR

“Hehe: 30003508 FSU EBR, broca

Seche: 10001500 Use 0;Zyvheais
„.

„.5GE: 10001514 UVOV EAH;NTOA
.\ Rel
“Seeh: 1000151a Run 2;Anoo
.
‚Geeche: 10001522 ou az: vnk, ezakh

.

Seche: 1000152s Rroor EBR

"Beha: 10001525 Gay

Chaves: 10001520 Tozaa1] Keumoboaganoca DIRAT

Para determinar o tipo de armadilha, seu código é conveniente para aplicar a tabela
Belião (Tabela 2.4).

Tabela 2.4.Tipos de armadilhas e seus códigos

Piscar

[e iblamacoo [zamykhikhitronlirkai_
[2 [ietoo [ohm Soby aceitará com mais frequência
[5 [EE [combate
O Raccoon _ [ondryayy

Eventos de SVT- criação, destruição e re-
Marcando janelas, alterando seu tamanho, ativo
Janela e foco Transmissão, sistêmica
equipes

pagina: 120

114 Capítulo 2

Tabela 2.4 (final)

NOTA DE CÓDIGO DO TIPO DE TIPO
funções
In_5ussegytev rastreando mensagens do menu, diálogo
saídas
7 In_ Mochzu Mensagens associadas ao movimento de nós
Shi e pressionando suas chaves
In_navomava Filtro de mensagens de equipamento.É
tipo de armadilha desatualizada e em \ m/p32 não
Segura
O in_revis armadilha para depurar metas - chamado

Apple filtro-shell.Chamado
Quando as janelas do vidro são criadas e destruídas
nível, bem como quando um apêndice

É necessário para se tornar ativo

Antes de chamar armadilhas de outros tipos e pode
Em _nob

Bloquear a chamada deles
Mn_eoovovomotya

Pediu o fluxo atual quando
há algo da entrada de informações do pol-
calórico.É uma notificação de armadilha
T. @.Chraham e 1 faixas ao chamar a função
As armadilhas são 0

Em nosso exemplo, o interceptador tem um código tipo 2, portanto, interceptação
Os eventos do teclado são baseados.

Em uma nota

Durante a análise do espião do teclado, deve -se ter em mente que pode
Para usar os tipos de armadilhas que são diferentes do in _Keuuvovo.Por exemplo, conhecido
Um espião que usa um tipo de armadilha de in_t.stmes $ ASCE para monitorar o sistema.

POTI 2.53 "Um fragmento de uma função de 24
informações para o arquivo

". Keikhe: 1000108a Zea Esh, [EBR+Zuzfemat shche]
“Conte: 10001080 Ruvo Eah;1p8uzeestata
.Tech*: 10001091 SA11 95: Seetheos] 1T

.
Teche: 1000109e} =) 1s 1000117e

.

pagina: 121

Tecnologias de programas e princípios valiosos deles funcionam

.Sehe: 100010AV
.$ Ehh: 10001081
.Sehe: 1000108VV
.5EHH: 100010S1
.SEHE: 10001062
".Sehe: 100010S8
.Xhh: 100010s
.Behs: 10001000
.sehe: 20001001
.EHE: 10001007
.Sehe: 10001008
.EHS: 10001008
".Sehe: 1000100s
".Sehe: 10001002
.Sehe: 100010E5
.Sehe: 100010E6
.Sehe: 100010es
.Ehe: 1000103
.Sehe: 100010E5
".Sehe: 100010ea
".Nós :;100010es
.Sehe: 100010EE
.Sehe: 10001100
.Sehe: 10001105
.WE: 1000110A
.Sehe: 10001110
, Eehe: 10001116
.Behe: 10001118
.KEHS: 1000111A
"Sehee: 1000111s
.Sehe: 10001122
.Sehe: 10001123
.Sehs: 10001129
.Sehs: 1000112V
.SEHE: 10001131

32
Ou
1ea
trincheira
SA21
RAZV
Zea
Rozvv
1ea
Rhizv
Juu
Rhizv
Pou
APA
RYJ
SA11
Ou
RAZV
RAZV
Rhizv
Rizp
Rhizv
RI5V
Ru5v
SA11
começar
RAZV
RAZV
Rhizv
começar
Rozj
SA1}
RAZV
Chá

Skj

115
30S_ 10001161
Čota 10003230, 0
Eah, [EBR + Keuzhake]
eah;TRKEUBKASE
43: beskeuboaga5 <ahe
0;9R1A95
Esh, [EBR + VIEEG]
Esh;1rsvag
eah, [ebr + keu5eee]
eah:] 0xubhahe
Eah, [EBR + Ibsapsode]
eah;Absapsoae
Esh, [EBR + OSO @ e]
Esh, Oeerev
Esh;Cu: Keu
95: TOA5S11
BUSE REG [EBR + Vieeet + 1], 0
0;Ptepr1ave11e
|:
4
0
z;DIBRAGEMODE
40000000N;9mb51gedasse $ z

OEëzee 5% G1191;"S: \\ 109.6He"

43: sgeaeer11ea
[EBR + VOB] DES], EAH

2;Ammočemesvoya
0
0;\ Ruzbapsetomoče

Eah, [EBR + ROBZES®]
eah;Wee

43: zeee1 1ero1peek

0;1Rouografado
eah, [ebr + mitiegovueezig1seep]

Eah

pagina: 122

176 Capítulo 2

‚Diga: 10001132 1ea ECH, [EBR+vai foder]

SS: 10001138 ROZV ECH;1p5eg11pd
.

„.

„.
.Terceiro
„.

Seche: 10001140 Risis Eah;Nela
Seche: 1000114E SA11 95: YAK1SE11E
„.
Seche: 1000115A Rozv Esh;Bob) eu®
.Seeh: 10001158 CA11 4 $: C1ozenapase

Na Listagem 2.53, todos os elementos característicos do clássico
Keilger.Em primeiro lugar, com a ajuda de piadas, uma solicitação é feita
estado atual do teclado.Então, através da função de Toazs :: os-
a tradução do código virtual da tecla pressionada e o estado do
Viaturas no símbolo correspondente, levando em consideração o idioma atual.Então
Um símbolo de raio é inserido no protocolo publicado no c \ | juv.4%e.
Em espiões de teclado mais complexos, você pode detectar um código entrando
informações sobre as teclas clicadas para o buffer, cujo conteúdo
Redefinir riodicamente para o disco.

Se você resumir a especialidade dos espiões de teclado baseados em teclado,
obtido com a ajuda de seu dizasseming e estudo, então você pode
Formar uma lista de funções mais comumente usadas em espiões
Este tipo (tabela. 2.5).

Tabela 2.5.AR! -Fuções usadas por Keilgers

Encontro

Beiei: Pacha $ Nooka Instalação do dedo do pé e sua remoção

Ooookk \ 1 bolsa $ nookkekh

CA+1Mechenooke chamando o próximo interceptador na cadeia

Betazupsku5 Ace Monitorando o teclado pelo método de consistente

Segkeuroaha5 Surge

Tod $ C: 1 Tradução do Código Virtual do Teclado em Azi

Toa5s11eh

pagina: 123

Programas e princípios maliciosos de seu trabalho 117
- - th - th - th - ы »» - " - s - si -yy -" s "s" _ "–– ryy. - z a –– - - - - -.

Tabela 2.5 (final)

Zepdmeszade enviando informações para o componente de Keilger, respondendo
Filhote para protocolamento.Analisando os parâmetros destes
funções, pode -se estabelecer que é e

Qual aplicativo ou janela

Ro5 <mezzade

Bekhgogedhoti \ 1p4om |A definição com qual janela está funcionando atualmente
do utilizador.Aplicado para cliques de "encadernação"
Vish até a janela, que simplifica a análise do criado por Keilger
protocolos

Beysiz $

Sybesassa1 ue 1 pas

Maru1Gea1Keu Tradução do código do teclado virtual em um código de varredura ou
Maru1khetetTetetT1KEUJA Código Azi

BESKEUROAAHAUOOCA Solicitação para o layout atual da camada do teclado

Stakee11e trabalha com um arquivo de protocolo

SREPEG11E

I1SEY11E

Essas funções são frequentemente encontradas no teclado comum
espiões e dizasseming e análise de uma biblioteca suspeita
Recomenda -se prestar atenção a essas funções em primeiro lugar.

Teclado
Usando uma pesquisa de teclado

Essa técnica é baseada em uma pesquisa periódica do teclado.
Para uma pesquisa das chaves do sistema, uma função especial é fornecida
Ção de sbu <keuraha5 $+aee, retornando uma matriz de 255 bytes, nos quais cada um
O byte contém a condição de uma certa chave no teclado.Dan-
O método não requer mais a introdução de os processos de O, em su] e como resultado
O espião é menos perceptível.

No entanto, a mudança no status das chaves ocorre no momento da leitura
coma de mensagens de teclado de sua vez e como resultado de um método semelhante
Dika funciona apenas para rastrear aplicativos C0P.Isso não é possível
Statka é livre a função de bekazupsku $ ahe, retornando o estado
Vichy no momento de chamar a função.

pagina: 124

118 Capítulo 2

Pistus 2.54, zunia de um estado de votação causado pelo cronômetro

Rgesdige tamimazp.Smkuu5 $ ticpeScttayett1 EG (BEP4TG: Tobzes®);

Uau

1, GES: ZoseG;

3: ZO: 1 PA;
Problemas1p
$: = 1!

Ciclo de pesquisa #/ cloval
Deus 1: = 0 $ 0 255 Ao bea] T
// solicitação do estado da chave 1
Bort: = Seasupsku $ com AEE (1);
1e dirigindo <> 0 cego
1e mar \ u1g (oa1keu {1, 2)> 0 cego
3: = $ + pack (maru1tbia1keu (1, 2))
E1ze $: = 98+ '['+1p1560 $ 6 (1)+']';
EPA;
1e] epap (5} = 0 exep ex1;
Mepo1.1pa5.ada ('clures são pressionadas "' +5+ ''" ");

ETA;

O código fornecido na Listagem 2.54 deve ser chamado pelo timer do intervalo
Robre cerca de 50 ms, o que permitirá cerca de 20 pesquisas por segundo.
Esta é a principal desvantagem, já que até a alta velocidade da pesquisa
não garante o registro de todas as principais prensas com uma entrada rápida em
formação.Descoberta de tais espiões do teclado, geralmente
É realizado pela interceptação de função AR1, como
seu desafio.Alguns anti -cidadores realizam intelectuais
O bloqueio da chamada desta função é a chamada da tomada besazupsku5 é permitida
Somente para aplicações localizadas no foco da entrada do teclado.

Espião do teclado baseado na tecnologia rutka
No uzegmoda

Esta variedade de merda do teclado ainda não recebeu um especial
distribuição, mas em termos de capacidades, eles não ficam atrás dos colegas,
Outras tecnologias.Por outro lado, muitos antigos
Projetado para procurar espiões desse tipo e não é capaz de contra -ataques
dirigir.

pagina: 125

Programas e princípios maliciosos de seu trabalho 119
--_ - - - inferno -

O princípio da operação de um espião de teclado é bastante simples -
Usando qualquer um dos descritos na seção.Os métodos "Cozhia" são realizados por
As bordas de uma ou mais funções que permitem que você obtenha controle
Acima das informações inseridas no teclado.O mais simples é
Funções de Reekmusade e Rexhazade.Considere um exemplo, interceptação
Dirigindo ReekMesazade.É construído com base na interceptação de funções com ajuda
Editando 1AT, os princípios do trabalho desse interceptador são descritos em detalhes em
Seção."Intercepção da substituição dos endereços das funções".O código interceptador é apresentado em
Listagem 2.55.

Listagem 2.55, o teclado irrita com base na interceptação da fugcia de dir 64 0%

Ture

TreekMeszadea = YORAPSEFOP (UAG \ rMZA: TMZ9; VIPA: NIMO;
“MZZA111P1P, Umzaihma, Chepooskoye: OMT): DIY;5%8S811;
TreekMes5 AAPS = EAPSEFOP (UAG 12M549: TM5A; NUPA: NIMO;
MIND59E111EGM1P, CHMZOR1111111111111111111111111111111111S, MVEPOUMSA: OTAT): Vodee;5E9S11;

Waah

O1 Zrekmeszvea: Trekkmesadad;

O019 REAKMEZADA /;Trekmeszdayda;

Rgosedige TodKeu (hat 1rmzd: tmz9);

Waah
15: Teleria;
Ipchtekh, keuming: US $ 6: 119;
Bort: Zpkedeg;

Ed] p

A35191e11e (e, ‘'c: \ keu1odeha');

3E 211E6X1565 ('C: \ keu1o9.ska') Spark

Arrepa (E) E1ZE Vemgaaye (EP);

Ze hepa b (ipatech, 1024);

2GOMETHEH (@ipatech [1], 1EP9V (ipatetakh®)};

Baby1paomttekh (vila, @patehe [1], tepdel (ipatech));

// Seleção de um buffer para o nome da chave

Zeegelden (Keumate, 32);

// recebimento do nome por código, tome - a duração da linha retornada
Bort: = seskeumametteh (1mm59.1 ragat, @kemate [1], hepotn (keumac)};
Itg1s1p (e, topo (\ patech) + ':' + soru (keumate, 1, bi));

pagina: 126

120 CAPÍTULO 2

C1oZee11e (e);

era;

Eiporeep Turreekmezadchea (Uhahu 12m59: TMZ9; UUP: NUMO;
\ M39e111tegm1p, mmz9r1] segmach, evetouumz9: otmt): guerra;com & ACA11;
Bed1p
Ves16: = o1 chorerekmezazi (1rmza, nipa,
Umzee1egm1p, IM5116eum, IVETOUMUMM59);
1e veso1e apia (] rm $ 9.Thezade = eles keuhm) ‹pep
Godkkeu (1p2m393);
ETA;

EALS1OP MUREECMEZACHAY (CHAHG 1RMZ49: TMZA; NIPA: It;
Umz9e11e: tm1p e "mdag11tegmach, chvetouuma: otmg): completo; $ & 9S111;
Bed1p
Vazi1 <: = 01 yurerekmezademus (1rmmza, bup,
Um5ae: 1etm1p, mmz9e: 1tgetum, uvetouuma);
1E VE5Y16 APA (1RMZ9.Mozzade = Ni Cobomm) Spep
Godkkeu (1RMZ9);

era;

Bed1p

TleegserkeGAPSE1OT $ B1 $ 5E: = P11;

// Transferência para células de engenharia

// passa de goai11hag*

GoosegSerropse1opekh ('KegPe132.411', '1oad4btaga',
.

TobsehSerropse1opekh ('KegPe132.4911', 'toa4u1uhhagaha \',
Voo1aoa9t1ykagum, @turoa91thahum);

// Transferência de Berghosayazesz

Tleegsergapse1opech ('kegpe132.411', 'bseergosaaaagzes',
@O1abeergosaaaaaaaaaaesesis, @tuberthosaaagaza};

// extraia a pioneira do teclado
Tosegsgops®topech ('ISG32.411', 'ReecMezael',
@019ReekMezadea, MureekmMezaded);

pagina: 127

Programas e princípios maliciosos de seu trabalho 121
DDD -

TleegseRerararSetOpech ('15 ex32.411 ',' rexmezadens*,
@019 riverzmescha, @turekmeschai);

EPA.

A função de Godkeu neste exemplo é um auxiliar e pretendido
Chen para registrar informações sobre teclas no protocolo de texto
C \ keyuor1He.Na ausência de um arquivo, ele é criado automaticamente e no
Sua disponibilidade de sua presença é dedicada às informações no arquivo do arquivo.Em pro-
Os toCols são nomes escritos de teclas pressionadas obtidas usando a função
Be = keumamethet.Como o único parâmetro, a função do Todkeu é
A mensagem do teclado é.

Pureekmeszadados e purecensaades são idênticos e você-
As seguintes ações são preenchidas:

C é um chamado de re -zade (para isso eles usam o ponteiro
01CHREEKMA55AD, armazenado antes de sua interceptação);

P analisa o resultado retornado ao Rexesade.Se a re -zada
Retorna o aquecimento, isso significa que, a partir da fila de mensagens, houve
Outra mensagem foi removida.Nesse caso, e
Mensagens do tipo Liz.Para mensagens como norte
Sopa de repolho) Um desafio para o protocolo do Toakuu é realizado.

C Neste exemplo, apenas as funções da re -Zazadea e
Rakemesses, um espião de teclado completo pode levar sob con-
Troll da função de Semeszade, P15 Razesmezade e TKAP5] ATEMESADE.Ideia
Os métodos não mudam a partir deste rutkit monitora o trabalho do aplicativo
NYY com as mensagens obeh e reage a certos eventos.Ana-
É lógico desenvolver um exemplo que rastreie a janela
Eventos, eventos de mouse e quaisquer outras mensagens.Exceto para passivo
Observações, em tal interceptador, é fácil implementar a modificação de co-
comunicação.

Sobre uma característica interessante da metodologia é a que
Os anti-ceylogers modernos que são lindos são desconfortáveis.
Mas eles lidam com os espiões do teclado de outros tipos.Por exemplo,
Riuas Keuboag não reagiu à instalação desta demonstração
O exemplo racional não foi capaz de neutralizar seu trabalho.Segundo
Um recurso é a possibilidade de "apontar a espionagem"- lá fora
o lunar do interceptador em aplicações estritamente definidas para vários
critérios, pavimento, apenas nas janelas do navegador ou janelas com um pedido para
Senha entrando.

Métodos de combate e busca por esses espiões não diferem de
A reivindicação dos Rutkuts do feixe.O ponto -chave para suspeitar

pagina: 128

122 Capítulo 2

A presença de tal espião no sistema é interceptar funções
Sesmezzade, Rexazade e TGAG51Atemeszade de uma maneira ou de outra.

Em uma nota

Na época em que o livro está escrito, o autor não tem dados sobre isso.Para interceptar a função
CIY CE “Meszade, Rexesade e TGAP51ammezada foram realizados
ou uma aplicação segura, portanto, a detecção de interceptação pelo menos
Uma das funções listadas no decorrer da verificação do sistema é
uma casa para uma investigação completa e descobrir qual aplicação
Os dados de interceptação sequestrados e com que finalidade.

Um espião de teclado baseado no filtro de motorista

Os espiões do teclado desse tipo são baseados na instalação no sistema de seus
seu motorista, que se conecta ao driver do teclado como
Filtro de motoristas.Exemplos da implementação de motoristas de filtro podem ser encontrados em
Rock, no site do MSGOZA (em particular, um artigo com Sho 176417 de 03.21.2005) e
Também em vp: // m \ mm.Útil
Teoria e exemplos podem ser vistos nos artigos do ciclo "Drivers do regime
Núcleos "na mente do site. Mazt.g.

O espião do teclado desse tipo, como regra, consiste em um motorista e
o aplicativo de controle que está instalado e sintonizado
Motoristas.Do ponto de vista do princípio do registro, duas opções são possíveis
implementação.

O motorista registra informações sobre as chaves de controle pressionadas
um aplicativo, e já processou informações,
Gravando -a em um disco e na criação de protocolos.

O motorista trabalha autonomamente e registra eventos por conta própria.
Nesse caso, o aplicativo de controle é necessário apenas para instalação
e as configurações do motorista podem estar ausentes, pois o registro
Os motoristas são reduzidos à criação de várias chaves no registro- esta ópera
A ção pode ser realizada manualmente ou usando um arquivo PM.

No momento do carregamento, o motorista deve se conectar ao teclado com o teclado
Passeios com o combustível da Tosgeaseresa/Todskasvreu1.Conexão
Geralmente é produzido para a pilha do dispositivo \\ ceu1s \\ keuboageAgyas1az0, que
é um driver de classe e implementa a funcionalidade geral para o
Viatur de vários tipos.

Somente o tipo de 1VR será interessante para o espião do teclado
TVRU VEAS, porque, analisando -os, você pode obter os códigos do teclado,

Um ponto importante é que o motorista o registrará
1 VR com dados sobre teclas e 1VR com solicitações de dados do KBCH!

pagina: 129

Programas e princípios maliciosos de seu trabalho 123

Informações sobre recorte!ficará disponível após o motorista
KAS! A55 completará 1VR e insere os dados em seu buffer.Portanto, o filtro
Keiloger deve instalar em cada tipo de combustível 1VR
Nelura de conclusão usando o abrigo Toszezesotrotopvoitsa.

Considere a implementação prática do motorista, trabalhando em
O algoritmo descrito anteriormente.Na Listagem 2.56, o procedimento é trazido
Ru1uhepeku, cuja tarefa é criar um dispositivo \ beu1s \ kr4 c
A ajuda de tosgeAtersu1 e a criação de um vínculo simbólico usando
Tosheae5utro11s1pk.Em caso de conclusão bem -sucedida dessas operações
O filtro está conectado.

Listagem.2.56;Crashclacoda no motorista

Mt5tatato $ BOTH1UHEPAGU (1M ROVTUYEV OVATE OH1UEEEEGUGA]
Tm romtsobe ztatms Ved15kGurap)

Rueuts ovushus reh1seob) eu = nós;
Mtztato $ pe ab5;

Onsore_ $ tatms chzbeu1Semace0p1Sode5G119;
Omtsoooe_5 tatms academ1sepkop1 sodeb;

// Preparação de S-Sod-String
V1tp1 eo p1sodeBeu1pa (& de 0euzematebosodeb tata,
B "\\ beu1s \\ co4");
VA11P1 © 0P1 SodeB: 1P (& & Academician PkoplosodeBh1tpoa,
1 "\\ bozreu1sez \\ venha");
// Criando um dispositivo
Pebeyaa $ = tosgeaseBech1s (og1hekhgob] eu \,
512EOO (OEUTE Exemest),
#From0EU1Mamamomod1 SO: 1PD,
Doente reuts omkmm,
0,
SEU,
& Beu1oso5) eu};

E (MT 59sas $ 5 (pebe)) {

Tesigp peb®atiz;

pagina: 130

124 CAPÍTULO 2

// Lembre-se do ponteiro de BEU1SOB) eu-> beu1sehehehepz {op
// para seu uso em manipuladores

Rb1ora) \ reuhe = (rbemstu) vuu1se06) eu-> bch1seehspz4op;

// criando um link simbólico
Pebeasiz $ = toskabutryo111se1pk (& 150eu1sa1pip1soda $ g1po,
V5bu1 semete t sodebe: 109);
1e (yut_ $ 0sas85 (pebfaes)) (
Oara1p* ("ocea1utepku: tosgeakebumro111sapk uggog \ p");
TOBE1SERECH1S (VEU1SEBES);

Tebogp Packaiz;

// criando e conectando o filtro
Pebeosoz = tpzba 1KEUROAGAE11EG (OH1UETOBZES*);
1e (! Mt_50sa5 $ (pebea® $)) {

TOBE1 EVE \ U1S (BEU1SAB) EU);

Tesogi P5 $ AEI5;

// conexão de um manipulador de refratores para todas as funções

Rocha (10 1 = 0; 1 <1vr mz macht machtment; 1 ++)

P: Ugogob 3es*-> Masogrops & 1op [1] = ozhege15ra & sibepga1;

// manipulador separado - para o tvr_mo veao

Ru1ueGeB] eu e-> ma) ogrips1op [Tar_mu veao] = oh1uekh0o15khsvvea;

Universidade de UE) eu*-> ogluehip1oa = VILUEHOP1OA@;

HEBOGI P0E5 $ AI1 $;

O código do programa responsável por instalar o filtro é feito na forma de "
TPZGA1] Keuboagaagae111eh (Listagem 2.57).

pagina: 131

Programas e princípios maliciosos de seu trabalho 125

ma y y e " *.> ree 9 kh4% 2-1
Pnstimg 257 _funky spztaz kai vx
Mt5tatato $ tpzra1] keubobaarararek (tm rovtuk_ovushet og1ugougedda)
{

Omtsoooe etvtms peor1sode5eg1t9;
Mt5tatato $ p5taei $;
Rueuta_ vovost reu1sabyueshe = m;

// Instale o filtro em \ oeu1se \ keumoboahg@с1az50
V1 top1sode $ e g1pd (& p0p1 feridas, PA,
G "\\ beu1s \\ keuboagas1az50");

Coseaea $ = tosgeebeepusse (og1uhegu) é

0,

MO,

Padre Oeutsu Keuvoavo,

0.

Eatze,

& Peu1se0i) eu);

1e ('mt_ $ 0se $ $ (p5vasiz)) {
Observação 4 pe ("tpzva1] keufogyaya1] eghg: tosgefeReu1 do ovog");
TIGOKHP PEBFAEI $;

}

// Instalação da bandeira boegeveo então

Reu1se0b) es-> e1adz | = com treyeveo 10;

// conexão do nosso filtro
Cyeaeiz = toaatasibu1s (veu1seses,
& ooptsodebet1to,
& Rb1oba1bueh &-> kyoobeu1);
1e ('MT 59SA5 $ (pebeyaiz)} {
O -pruprop ("tpza1] keuboah@e11tet: eghgog, Toesasioeuza Eggog");
Tora1Vereu1 (Beu1sebese);

Gegogy vlubaaa $;

pagina: 132

126 Capítulo 2

Rb1oba1ochecha-> kbya1111111etgoyu1 = beu1sb6) ecs;

Keeigi etooz 50szzz;

Em caso de execução bem -sucedida, esta função retorna o código
Ztato $ _ $ 0sas55.Na Listagem 2.58, o texto de origem do manipulador é considerado
1vr_mz_var e função rg1ugp1zrasspbepag1, processando todos
Talle 1 kr recebido pelo nosso motorista.

Pietting 2.58.Fragmento das funções iniciais do driver T -CSTU
Ogau-Yo OGS ASA e RRGLEGR 1 ERVESIBEPG1

// Handler tvr_ mz veao

Mtetatato5 og1uG01zrassnveaa (1 rueuta ovobos beu1sebbzesses, tm avaliador ttr}

{
Rto ztask tosatt siggeeperbesk
RTO 5Task Gosatt Pechetiurkska
*Pechetirbvascus = *SIGEPEPETERGVASK;

Tobsogkepet gr askgosae1 opt (1gr);

TOBEEMEHTTGRBTSKTOSA1 OP (TGR);

// instalado em 1 kr sa11k-função da conclusão

Tobessopr] 1E1OPKOCOCA1TA (1GR, OpKeiiasotor1e1OP,
Reu1so] eu, seu, tick, seu);

// Passe o motorista do Steam

Gyeigia Gosa110hlyuht (rb1oa1reuja-> kyabeu1, tgr);

// retransalator
Mt5tatato $ ohcouge15 rysynSpeg1 (14 rueuts o. beu1sbb) eu,
Tm rtvr tgr)

// perde toda a TVR sem processamento
TO5K1RSOGKEPEPRVASKROSAP (TGR};
Hybogp tos111otuzuke (rb1ob] 1 puuja-> kbaooeus, 1gr);

É fácil perceber que oe1uG01zraespbepag1 é essencialmente um retrans
Thor - ele simplesmente transfere 1VR para o driver de teclado "nativo".Em processamento

pagina: 133

Programas e princípios maliciosos de seu trabalho 127

Chick Og1uo: um pouco mais complicado - é com uma função
Tosesotr1e1opvoma1p conjuntos no PVR O endereço da função de conclusão
Opvea@sotr1e1ot, que realmente executa a análise do concluído
buffer e extratos de dados de TI sobre prensas e liberações de chaves
(Listagem 2.59).A função verifica o valor de TGR-> tozeiz.
É igual a Ztato $ 30SA $ $, então no buffer 1VR Existem dados sobre as prensas e
Klovis lançamentos.Esses dados são armazenados na forma de uma variedade de estruturas
Keuvoavo tmrot irmão, o número de registros é determinado por divisão de tamanho
Boofer para o tamanho da estrutura do keuvoavo tmrit_rat.

Mt5tatato $ ePaea9SOPR1E1OP (TM Rueuts Mostens de Rreu1se0b) UE,
Tm rtvr thr, tm ruto sogpeha)

1e (TGR-> TOBTAS $ .5EASIZ == $ zTato $ 0SA5 $) {
// ponteiro para o buffer
Rcuvoavoavo tmrova rata keupak =
{Rkuvoavoavo tmrotu) tgr-> azzos1aeatgr.
// o número de dados nas prensas no buffer
Fpi keubavasopa = ter-> toBeiz.tpeoogpaephot /
51 Gyeo (Keuvoavoavo tmrot do irmão);
// A retirada de informações do buffer através do colunl1Pay
EOG p 1 = 0;1 <Keuravasóides;1 ++) {
Okartz P ("BSAPSOAE; %X", Keubaba [1]. MakeDoda);
// bandeiras
Zm1es (Keubava [1] .e1ad3) {
SAZA KEU MACK:
Alure1 pek ("%5", "keu bot (keu_mak)");
Bhegeac;
SAZA KEUKH VVAEAK:
Berare1 pek ("%3", "Keu ou (Keu vveak)};
BGEAK;
Saza keu yo:
Ozre1 pek ("$ 3", "(Keu Eo)");
Bhegeac;
SAZA KEU E]:

pagina: 134

128 Capítulo 2

Prarspe ("$ 3", "(keau_e1)");

BETAC;

// Definindo alcatrão na linha (se necessário)
1e (TGR-> Turnip1-Pavegia@)
Thomag -stroke1 pa (tgr);

Gregp Tour-> Tozbai $ .56a111 $;

A função do TOBETR1E1E1PVOY1P é descrita em M $ ohm e tem o seguinte
Tipo - Listagem 2.60.

Postagens: 280. FUFIA Dodosslaak Ao,
Uoto tobesopr1e fopvoche1she (

Tm rtvr tgr,

TM RTO SOMRIETTA SOPR1ESFOPVOSH1P
Tnruoooto sopeehe,

TM geralmente tpuokoopbisbissuz3,

Tm voyteam tpuookoolgog,

Tm voyteam tpuokooPopance]);

O endereço do processador de conclusão é transmitido no parâmetro de Soirzopvozzez e
Tpuookebpbiszzz, tpuookolgogog e tonsopsansa1 indicam em que casos
Este processador deve ser chamado.Em princípio, no nosso caso, suficiente
Mas instale no TAS.Apenas tpuokeorbiszzz.

A função de conclusão verifica o valor de Ter-> Tozkaniz.
igual a ztati $ 0sas55, então no buffer 1 existem dados sobre as prensas e
Keystorms.Esses dados são armazenados na forma de uma variedade de estruturas
Keuvoavo tmrotu_ara.O número de registros é determinado pela divisão de tamanho
Boofer para o tamanho da estrutura do keuvovovo tmrotu_bata.

Para a compilação deste exemplo, é necessário incluir no projeto p4akaa.v
De Rork.Neste arquivo de cabeçalho, a estrutura é declarada
Keuvoavo tmrota_aata e constantes para decifrar sinalizadores.Recebido em
O trabalho da função das informações de Oppoveo-asolezop pode ser registrado

pagina: 135

Programas e princípios maliciosos de seu trabalho 129
- - por exemplo

Derramar com a utilidade oybio \ me \ (em p: // lyuch.
Ku e o descarregamento do driver podem ser executados usando o \ 2K_1OA.
Ou seus análogos.

A busca por esses espiões do teclado é tão simples
A maneira - analisando a pilha do motorista Keuboagas!Em particular,
A esposa do motorista pode ser encontrada com assistência à utilidade de Omsetgee da co-
Rocha Stava.

P
[]
h
V
®
®
[9
[M
V
4

Arroz.2.10.Filtro de motorista conectado a keuoag9s1a $ 50

O motorista considerado em nosso exemplo não está descarregando.Aqueles
Não menos, no exemplo, há um código responsável por descarregar o driver,
Um desligamento de Naucking do filtro antes de descarregar.No entanto, há um
"Subaquático Stone" - para rastrear o teclado que se move do motorista
1 VR Colocamos neles um ponteiro na função do opVeadsoTrotor+op.Vestígio
algodão, no momento de descarregar o motorista, pode existir BP com tal
indicador.No momento da conclusão do processamento de tal 1VR, o
Como resultado de uma tentativa de chamar a função de um driver descarregado.Proteger
você pode ou fazer o motorista descarregar (que é mais frequentemente e
feito), ou realizar um medidor, que é aumentado a cada chamada

pagina: 136

130 CAPÍTULO 2

TOBESOPR1E 1OPWITZ1PT E DIVERCIMENTAL NA entrada para o opVeadsopr1ee op.
Nesse caso, a unidade do motorista é realizada apenas com valor zero
Uma referência deste medidor e duas estratégias são possíveis:

C) bloquear o envoltório com um valor sem montagem do contador 1VR com a instalação
processador final;

Com a desconexão do filtro e a expectativa de um metro de 1 kr zero com um conjunto
o processador de conclusão (zero ocorrerá como resultado de
Ligue para opVeadSOPR1E1OP).

Um espião de teclado baseado em Ki-Technology
Em Kegpe/ meu

Um espião de teclado semelhante não instala o driver e no re-
O resultado é menos perceptível.O princípio da operação de tal keilger não é diferente
É da raiz do regime do núcleo (Ket! Moda), apenas em vez de interceptação de função
As funções de M! T32K.5us são interceptadas.No entanto, para interceptação
Essas funções devem ser resolvidas por vários problemas.

C Para instalar o interceptador, você precisa encontrar o endereço da tabela
Kebugo1 Serzt1redyu1e5Vadoi.Esta tabela é semelhante em estrutura
tabela kebkggu1serzsk1roogtaya1e, mas o problema é que ad-
Resessal desta tabela, diferentemente do endereço kzegu1sezsk1kogtab1, não ex-
Preparado pelo núcleo.

Sobre a Tabela 55T x1pz2k é colocada no espaço de endereço do usuário
regime e se reflete apenas nos processos de AC].Portanto, para
As modificações deste US $ 5T devem estar conectadas ao processo C].

Pesquise por kebug1sezssg1reogta1e5Vadoi é um problema, já que
Não há maneiras documentadas de executar esta operação.
Caminhos não documentados caem ou com o traço de chamar AR1-
Funções ibug32.9th até o núcleo, ou para a análise do núcleo do núcleo.O segundo caminho
Mais fácil na implementação e baseia -se no fato de que em pyubkg.eha há uma exportação
A função vibrante do Keddazuzkketbug} setAb1e, que no curso de seu trabalho é
Causas ao kebig: sbezsg1reogta1e $ wada.Código de Maninin desta função
ção (Listagem 2.61) é bastante simples e praticamente não muda da versão
para a versão, que nos permite aplicar para encontrar a seção desejada do
Código dos pneus Simples uma pesquisa de assinatura.

Colar 2.61;O resultado de funções de dizloseoomping |
Galoa 3 UE SZ Tar 26

8V dela ou e1, eya1
55 Ru5V EBR

pagina: 137

Programas e princípios maliciosos de seu trabalho 131

88 UE POU EBR, dirigindo

83 70 18 03 páginas [e5r+aga_10], 3

77 4e atrás do travesseiro 10S_46050A

BB 45 18 Pore Eax, [EBR+Aga_10]

C1 EO 04 56] EAH, 4

83 séculos 00 C5 48 00 00 00 SPR keBegu1seblezt1roogtab1e [eah], 0
75 ze ban 10s_4e05b0a

80 88 com C4 48 00} eu, kebugu1 serzstareogta $ rad [eah]
83 39 00 STO @Moga Reg [Esh], 0

75 34 912 Zhenoga 10S_4E050A

83 70 18 01 SPR [EBR+Aga_10], 1

As iscas que contêm o endereço de Kesheguringszskareogtt são destacadas na listagem
ae] e3Vadoi.Os bytes enfatizados podem atuar como uma assinatura.Fundação
Banheiro na função de pesquisa de assinatura da definição - endereço
Kebugo1sezsk1reogta1e hell é dado na listagem 2.62

Rod n kkdchayyyy ik tsy

Pretnya 3.62, Fumamy Gagabadoma

Rzevutsu ozestarata_tavtier e1p@bradoma1e ()
{
// Ao pesquisar, sentimos falta dos 5 primeiros bytes
// (Moss E41, ela; Riesv Ebr; Pov Er, Si)
Ruwut zsasavas = (vuta*}) keadabuzetbebu1setab] e + 5,
Sprka $ tria = ml;
// Pesquisa pelo comando 83 C8 xx xx xx xx 00
Deus (316 1 = 0; 1 <30; 1 ++)
{
3e (*(zsaparekhg - 2} == 0x83 &&
* (Zsavas - 1) == 0x88 e 85
* (ROMOVO) ZSAPAREKHG == (Biao} kebug1sezssg1reogta1e)
{
20BDRA1 PE (">> pe kebugu1serzt1reogtaya1e [eah] fotskpy ayo %9", 1);
Sprazreg = (5 sapa - 2};
BGEAK;
}

pagina: 138

132 Capítulo 2

Zsavas ++;
}
// Equipe "pe kebeu1ssusuaroogtar1e [eah], 0" Não é detectado?
1e (! Sirkuzrekh)
Gesigp 0;
// Sinto falta do comando
Zsaprek = sirkaztrek + 9;
// procurando uma segunda assinatura
EOG (1p 1 = 0; 1 <16; 1 ++) {
1e ( *(zsaprek - 2) == 0hvo && *(5 zaprreg - 1} == 0x88) {
2soSrg1 pe (">> 1ea eu,
Kebuguzerst1reogt] distrito E5 (eah] yooopep ayo %a, 1);
Tebigi (rzevuts dos reservatadores _taveg) * (roiovo) zsaspara;
BGEAK;
}
Zsavas ++;
}
Mob Gegitp;

Esta função verifica o código da máquina do Cedadabuzetbeku1
Detecção de assinatura de 83 C8 xx xx xx xx 00, onde xx é conhecido por nós
Endereço kebehuzesbezskgareogta1e.Se a primeira assinatura não for encontrada, então
A função interrompe seu trabalho e retorna Mott.Após a detecção
A primeira assinatura é pesquisada para o segundo - 802 88 xx xx xx xx, onde xx -
O endereço desejado.

Em caso de detecção bem -sucedida da segunda assinatura, o encontrado é devolvido
O endereço, na ausência da segunda assinatura, Mott é devolvido ..
A capacidade atual desta função é testada em todos os sistemas operacionais
Linha MT, começando no MT4.Assim, o primeiro problema é resolvido -
O endereço do kebugu1 sebezsg1rgogt51e5 é determinado pelo PADD.

O segundo problema é devido ao fato de a tabela ser $ t i1p32k é colocada em al-
resonna do regime de usuário e é refletido apenas em
Contagem] 1 processos, para modificar esta tabela, você pode aplicar dois sub-
AVC.

Sobre a modificação de US $ 55 T M1P32K do contexto de su] -Appendix.
Nesse caso, o sistema de controle de controle]-o anexo carrega o driver e
Ele late uma solicitação de 1KR com a equipe "Instale Interception".Processor 1vr-

pagina: 139

Programas e princípios maliciosos de seu trabalho 133

A solicitação do motorista neste caso será executada no contexto da gerência
Mentiros su]-aplicações, e não haverá problemas.

C] Antes de instalar a interceptação, o motorista procura por negligência
A aplicação C e durante a instalação do interceptador está conectada
Ao seu contexto.Isso é feito com a ajuda das funções de Kedevasnrgosesis5/
KerekasyrGosezz e C5G55.Ehe podem atuar como o processo de C \ l-L-L-Process.

No exemplo educacional, aplicaremos a primeira maneira- a instalação de
Uma aderência de comando do sistema de controle de controle] -Apêndice.No início do
Observamos a função que executa a instalação e remoção do interceptador
(Listagem 2.63).

Rod Kr

Listagem?63, função que está governando para a instalação da remoção de M do centavo

Itetatato $ zeek15t5vamnomonook (geralmente azeenok)
(
// Proteção contra a re -instalação/remoção do interceptador
3E ((nooktpzva11e && abeenokk) ||
(! Nooctpzea111e &&! Azeenook)}
Geeogs Ztato $ omzosse $ 5;
11ª re -zade = -1;
Zmtsn (*mevia No. tfpha) {
SAZA 2195: // IT 2K
BGEAC;
SAZA 2600: // P XP
Rexmesesae = 0x10a;
Bteak;
Saza 3790: // i2kz
BGEAK;
}
// Para o sistema operacional atual, não foi possível determinar a função da função
1e (re -zadesae == -1)
gerikp ztato $ omzosse $ zeo;

// Pesquise Keshegu1serbezsk1reogta 1ebrade
Ruekuts_ kosvtratov_tavier kebugo1sebezStaroOogt6] Evades =
E] pa5Vadoita e ();
2obarea pe ("kebug \ u1 serzt1reogt] e5bach = %x",
KeBehu1sebezstareogta1ebvad);

pagina: 140

134 Capítulo 2

//

// gerencia, depois continue a continuar

1e (! Kebug1sedzssshagaregta eb pado)

Getsti 5tato $ ohm $ zosse $ zerog;

// Saída de campo para depuração

2obark1p ("keBegu1serzsg1reogta] e $ padad-> \ 1p32k.zguulsella = %a",
Kezhegu1sezssg1reogta1e $ padoch-> i1p32k.bugu1setae);

2obara1 De acordo com ("Kebeu1seTaretareogtara1e5 Padoi-> 1p32k.5 zagu1seta] e = %x",
Kebugo1sezt1reokhgt6] e5rad-> i1p32k.Zeguulsetab] e);

Omovo 01assvo;
// aumento de prioridade
Knrog o1arareG = Keva1Zetaa] 1 Tobbreuyu!] (};

/{Redefinir de yar-bit
_Aztm (
POU EAH,
Ou 01asvo, eah
Ap eh, ocheereeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeehils
Puuu sg0, eah
}
// Intercepção de re -Zazade
1e (Azeenokk} {
2oarga1e ("Nook de abelha:");
O1ChreekMeszade =

(Rreecmezazade) *kebuhu1 serzstg1reogta 1evada->
\ 11132K, Running1Set] e [re -zadesdo4e];

2ozra1 pe ("o1zrekmezazade = %x", o1arekmeszade);
Kebugo1sessharokhta] e5vadon-> i1p32k.ZEGA1
(Mtrovos) *murekmez5ada;
Blacks1paea1] e@ = amarelo;
}
E15e {
Kebugo1sebezssshagareogt61e pado> i1p32k.Zegu1setA1e [re -zzazdeode] =
(MRAOS) *01 COREHMESSEADE;
Butuk1pz6a] 1e4 = #a] ze;
).

pagina: 141

Programas e princípios maliciosos de seu trabalho 135

// Restauração de ir-bit
AZT {

POU EAH, OASSVO

MOU SGO, EAH

}

// Restauração da prioridade
Keggomegtga1 (o1ararog};

O trabalho desta função é reduzido à busca pelo Kezegu1 Serzsh4kog.
AB1E5VAF e modificações do endereço em i1p32k.sug1setab1e.No nosso caso
A única função do re -Zapache é interceptada.

Para sua interceptação, precisamos declarar dois tipos (listando 2.64).

Pistyig 2.64.Esses dados, Ibpolzata quebras dos lamias |Função

Sudere Biovo Nimo;
Sudere Zegasa Bachm5S {

NUMO BUPA;
OIOVO shysaae;
O \ ve "ragat;
Riovo] ragap;
Omovo C1ta;
Oioo reh;
Oiovr re u:

} M No.M5s, *rm $ C, EAV *BRM5S;

Veudo Voog

(Muta *rreecmezazade; {((
Trm5c 1rmza,
Biva
OTMT UM5AE1SEGM: T,
Modelo era 5
OTMT Ideas59

pagina: 142

136 Capítulo 2

Depois de determinar esses tipos, continua sendo apenas para declarar mudanças
O1arekmezazade para armazenar o endereço inicial da função interceptada
Rion do rezapache e desenvolva uma função interceptadora (Listagem 2.65).

Vog.MTART MUREEKMESZADE (\ RM5C 1RMZA,
Nimr Vila,
Otmt umzdelehmm1t,
OTMT umzde11 tetmes,
Otmt mepopohemmza)

{
Vog DIG = O1arekmeszade (1rmza, viva,
Umzae11techm t,
Umzde1 anos!Mah,
"VETOWEMES};
// reaja à mensagem para eles kekhuomm (0x0100)
1e (Droi && (1rmz9-> tezazade == 0x0100)}
2SOZRH1 PE ("Kvo SOA = %4, VIPA = %4", 1rmza-> 1Ragat, 1rm59-> ripa);
Gegichy está dirigindo;

}

Como é fácil de notar, o código interceptador é extremamente simples- é essencialmente
O estilo é reduzido à chamada da função interceptada e à análise do resultado.Se
A função interceptada retorna a sua, então uma análise é executada como
Fechado da fila da mensagem.Pois neste caso estamos desenvolvendo
Somos muito espião do teclado, então estaremos interessados ​​na mensagem
Keutoim (pressionando a tecla).

Para obter um exemplo de funcionamento, resta resolver o último problema -
implementar um código analisando a BP de entrada e produzindo o conjunto
Carregamento e remoção do interceptador (Listagem 2.66).

R OSA SA

Grove Che.

Mtztato $ ozzResySopeGe1 (Rueuta Opera Rreulsebese,
Rtar rttur)

RTO UTASK TOSATT P131;

pagina: 143

Programas e princípios maliciosos de seu trabalho 137

Bioko chppeoo = 0;

Mt5tatato $ p5 = $ tato $ mot tmremeMetoo;// Código de retorno
// obtendo a localização do título-stea

P1 $ 1 = TOBESSIGHEPUTRBEBASTOSA OP (P! Tr);

// Código de gerenciamento
Então tosopgaa1soae = p151-> ragapetegs.PE setosbopege1.Tosopgau1soae;

2 generalidade ("tosopahgo1 lados = %x \ p", tosopsko1soae};

// zetkwonok tost - interceptação de instalação
1e ({tosopego] combinado ==
// Instale o interceptador
n $ = zeek15t5raaonook ($ gie);
// bloqueia a unidade do motorista
Rreu1seo6es &-> b1chekHob3es-> oh1wekgip1oya = n.;

// Tost Vemoukvnok - Remoção da interceptação

1e (Toobophege 1 s ==

// Desligue o interceptador

n $ = beyec1 $ t5wamnosk (ea1ze};

// permitindo a descarga do motorista
Rbech1seb) e-> oh1uhegobdes®-> et1ugop1oaia = phzzuehup1oaa;

// Conclusão da solicitação TVAR
Re.GR-> TOTOBBAEIZ.
P!
TosoTra1Keveze (RTRH, 10 _MO TMSVEMT);

Hesogp pz;

Esta função analisa o 1VR aceito e responde a dois gerentes
Códigos - Um brinde do Zetkvonok e um convidado de Vemo -Junky.Esses códigos são convenientes
Mas gerar com o Macros STT, sondas (listando 2.67).

pagina: 144

138 Capítulo 2

Pisting 9.67.Códigos de controle

#Aee1pe the tostict zetkvonok stt, sonda (seis reuts omkmoim,
0x800,
Metnore veeeeeve, ettye amu assez5)
#aee1pe tost veemo -yellow -wood dolorido (Etsche Rechtsya omkmoim,
0x801,
Metnore Verevao, Sicku Amu Assezs)

Então, examinamos os elementos básicos do motorista e as funções da interceptação
ka, no entanto, para construir um exemplo eficiente, é necessário criar
Gerenciando o aplicativo.Tal aplicativo deve resolver um número
tarefas.

C Registrando o driver no sistema.
0 Realize carregamento e descarregamento do motorista.

Com o motorista, os motoristas dos pacotes de Zhr.
Com o lançamento do driver do sistema.

É conveniente implementar todas as funções de gerenciamento de motoristas na forma de uma classe,
Toda, que permite que você execute todas as operações descritas anteriormente.Organizar
cinto, exemplo, a implementação de tal classe de controle na Ora, descrita
Uma aula com modificações não de estudo pode ser aplicada em
Outros exemplos considerados neste livro.A classe será chamada
XIA TKO5OT 4 e publicado em um arquivo separado em Kazapueg.

Considere a implementação das principais operações para gerenciar o motorista.
A primeira operação é a instalação do driver.A instalação pode ser realizada
Dois métodos: documentados (através das funções A4UAR! 32.41) e
Camelled (criando uma chave no registro).Nosso exemplo funciona em
com base no caminho documentado, através da função AR1 (Listagem 2.68).

Pistig 2 68, Instalação do Padar

FOPSEFOP TKOBOKH1UH.TPZSA11OKHZUGEG: BOO1EAP;
Waah

ZsmapadaGnapi1e, zsnapa1e: tnap1e;
Bedp

Vezi16;

1E RO (SpecOkok1uegepa61e) EN1E;

pagina: 145

Programas e princípios maliciosos de seu trabalho 139

// 3. Conexão com o gerente de serviço

ZsmapadaGNAP1E: = coreposmapadeg {p11, p11, 5c mamasevk ac assez5);

1e Esmapadekhnapta1e = mi, & vep ehl:;

// 2. Criação

EsNAP41e: = 2Sheawabetu1s (Zsmapadakhnapa1e, 'co5*,' kbb pepo ',
Zevets em.Assezs $,
Zevets kevme ovtuev, zevets oemamo ztavt,
Zevets Evak Movmay, RSVAH (Oh1uegransk+Oh1uekhmale),
11], 011, 121, p11, 011);

Vezi1 {: = (5Snap1e <> 0};

// 3. Desconectando -se do gerente de serviço

2S1OZYBEU1SENAPY] 1E (5 SPU1E);

2S1OzyBugu1senape (US $ 5 é Pompadekhnapa1e);

Véspera;

Considere as principais características do código de software acima (estes
Os recursos estarão presentes no código de outros métodos).Primeiro
A operação é uma verificação se as operações com o motorista são permitidas,
Derivado usando o método pelo ssskog4hepay1ea (Listagem 2.69).

Listagem 2.69, check, ryazrea você operações com o driver
Ripsetop tkobog1ug.

Beata

Vezi: = t5mt ar@ herab1e ap@ zega1seartoaaaa;

EPA;

Este método executa três cheques:

C verifica se o sistema operacional UIP4Aomz é mt- esta verificação
Ka é feito na forma de uma função separada com o nome de TZT;

Com uma verificação se as operações com o motorista são permitidas - esta é a bandeira interna
Classe Epab1ea, que permite bloquear programaticamente todas as operações
aplicativos com um driver em um nível lógico;

0 são carregados com sucesso pelas funções AR1 necessárias para trabalhar com o serviço
Bami- em nosso exemplo, as importações dinâmicas são usadas em nosso caminho
Dimy Ar1-Functions.

pagina: 146

140 CAPÍTULO 2

Em uma nota

As importações dinâmicas são importantes para garantir a operação correta do aplicativo
Nos sistemas operacionais \ Matdo \ s eh.Isso se deve ao fato de que, ao tentar
Vamos esclarecer os inexistentes nesses sistemas operacionais
Mami ar! -Funções serão um erro, será processado e a função
Zega1seartgoa4ea retornará para comer.
Bots com um motorista.

Vamos retornar à consideração da função de listagem 2.61.Se executado em
O método de demolição1uhepab1ea dos cheques foi bem -sucedido, então é realizado
Instalação Lander, composta por três etapas:

1. Conexão com o gerente de serviço e os drivers usando a função AR1
Opo5 smapadach (prefixo "2" no início dos nomes das funções do Aduar! 32.
Ting 2.68 foi projetado para excluir o conflito de nomes com estaticamente
funções importadas).

2. No caso de uma conexão bem -sucedida com o gerente de serviços e drivers,
O registro do motorista com a ajuda do Sketebug1 é encontrado.Nome do Serviço
KR5, Uma descrição opcional - Co5 branco.Em caso de registro bem -sucedido
O motorista do motorista é devolvido à soneca, o que permite mais
Para controlar o carregamento, descarregamento e remoção do driver.

3. Uma desconexão do gerente de serviços e drivers é
Funções da mulher C1ZeBuho1 Senado 1E 1E

Após o registro bem -sucedido do motorista no registro, a chave para a próxima

Tipo - folheto 2.70.

|Pistim isso.A chave de vômito com o motorista do motorista de Ritisias

[NKAU GOSAG, mastemma \ zuztem \ sissesopege15e "\ 5egu1sez \ kr5]
"Ture" = Chioga: 00000001

"Zeaka" = Froco: 00000003

"EggogSopeco1" = Oral: 00000001

"Gpaderana" = "\
"P1zr1aumam" = "kr5 beto"

O parâmetro 5kage controla o modo de carregamento do driver (o código Z corresponde
carregando manualmente), e o parâmetro do passeio indica o sistema que este é
Ver.O parâmetro ttaderae contém o nome completo do driver.Criação de similar
A chave é uma maneira alternativa de registrar o motorista e obter
É precisamente usado por vários programas de aplicativos.

pagina: 147

Programas e princípios maliciosos de seu trabalho 141
LLP LLP com Stooo SOOO OOS OOS SOO SOO SOO SSOO OSO OSO OSSO SOSOSYATASSSOO ASYA SSS NN

Em uma nota

Depois de carregar o motorista, a chave do registro descrevendo -a e o arquivo no disco é
O intestino é removido.Isso não afetará o trabalho do motorista e às vezes
estará relacionado ao mascaramento ou para congelar o computador
ou a conclusão do trabalho aaariral no registro não tinha vestígios do estabelecimento
Lynny Driver.Esta técnica é frequentemente usada pelo monitoramento de utilitários,
que define o driver durante algumas operações e
Descarregá -lo começando o trabalho.

As próximas operações após o registro do motorista são sua carga.
Para baixar o driver, o método TKO5R é fornecido: 1ueh.toaarg1uG (Liss
Ting 2.71).

Pistus 2 71. Carregando de condução

EIPSEFOP TKOBOY1MEG.HAYAUU1UGEG: BOO] 1EAP;
Waah
Esmapadekhnapi1e, $ snap1e: Tanta1e;
Rsade: rsvag;
Ehgh: Bedeg;
Problemas1p
Vezi: = ea1ze;
1e poe (oskoh1uhepa1e9) enep ex11;
// 1. conexão com o gerente de serviço
Zsmapadekhnapa1e: = 2 omeo -5smapades (111, p11, $ com mamasev abusse55);
1e EsmapadekHnapi1e = mina, a luz ex1 e;
// 2. Abertura do driver
Zsnapa1e: = 2eop5 zau1sa (5 smapadeglapta1e, 'co5',
Zevets az.Bundas $);
Rsachk: = p11;
// 3. Carregando
Vezi: = 25 tag5zehuls (5 snap1e, 0, rsadh);
{/ Recebendo o código do último erro
Egx: = besgazoeggog;
// Verifique o motivo do erro - talvez o serviço de unidade de serviço já esteja carregado
1e POF (Luck1+) Apa (ovo = eava_bevutsa abomims) é cego
Vezi1; = 6Ghic;
Etaadea: = veszo1e;

pagina: 148

142 CAPÍTULO 2

/;4. Desconectando -se do gerente de serviço
2s1 -zabulsenapa1e ($ snap1e);
2C1O5EBUGUZENAP 1 E (US $ 5 PompadeGonap] e);

Ega;

O código do programa deste método é semelhante ao método TPZTA111RG1EG, mas
Em vez de criação, o motorista abre por seu nome e toma
Tortura de carregamento usando a função $ sagt5egu1se.A função retorna
O seu em caso de carregamento bem -sucedido do driver e Raza em caso de erro.Especial
A adesão desta função é o retorno do resultado
Eaz, quando o motorista já está carregado.Nesse caso, o código de erro é igual
EVOV_ZEVUTSU_AVER _VUMTMS.

Descarregar o motorista e sua deificação são semelhantes ao seu carregamento e instalação
Lyzia.A descarga é realizada por meio de SOptgo1 $ esus com um parâmetro
Zevetsu_s -subtarog Tor e Deinstal - usando a função
OE1EGEBUGU1.

Depois de instalar e carregar o motorista, é necessário garantir o controle
Motorista e troca de informações com ele.Em nosso exemplo, o gerenciamento de
datas para a transferência das equipes LVUUK- para instalar o interceptador e em sua remoção
nie.A transferência desses comandos é idêntica, considere, por exemplo, a transferência
Equipes para a instalação da interceptação (Listagem 2.72).

Pistimg #72 Transfer Comeis Driver

EIPSELOP TKOBOG1EG.SA110G1UGEG ZETENOK: BOO] 1EAP;
Uag

VrgTueg: tnap1e;

VussezveMogpeya: SAH1PA1;

Tosoae, AM: OCHECO;

CRI: Boooeap;
Problemas1p
VE511E: = EA15E;

1e {toaused) enep ehze;

// Abra o motorista

Pogzueg: = sgaber11e (rsvag (okzzhegpkamap),
Semets Vaab,
0, P: 1, Orem ehtzttus,
Levantamento_ anexos_ovmat, 0};

pagina: 149

Programas e princípios maliciosos de seu trabalho 143
—Zh - SMM ”› E ›A,‚ Uh

1e sogaueg = tmuashto uaagoye & weg ehzs;

AM: = 0;
Tosoae: = P00E (US $ 022, US $ 89S, 0, C);
Vesy1e: = beuzsetosope ho] (Podluushak, Tossai,

Deputado, E12E0# (AM),

Deputado, Bastardo (AM),

Vussessgpeya, p11);
C1ozenapa} e (Jog1uG};

EPA;

O código considerado na listagem 2.72 é redundante - ao chamar a função
E \ 1SetosoPea1 é transmitido e um buffer é levado em tamanho de 4 bytes, mas estes
Dados não são usados.

Em uma nota

Em Berna!Não há análogo da macro stt_sore, o que permite formar
DIC Controle.Em vez disso, em nosso exemplo, a mesma função foi desenvolvida
ção, obtendo parâmetros semelhantes e executando a formação de código.

Para verificar o desempenho do nosso exemplo, apenas o
Para o driver compilado K45.5UZ na pasta de programa de controle
e instale o driver (instalando o botão), carregando -o
(botão de download).Após o carregamento, é necessário instalar a função-
Grounder (botão para instalar um interceptador) e usando o utilitário o6e \ iu.
Certifique -se de que, ao pressionar qualquer tecla, nosso interceptador reage a
Ele traz o código -chave para o protocolo de depuração.Removendo o motorista executado
está na ordem inversa - o interceptador é removido, então
Descarregar o motorista e sua deificação.

A busca por espiões do teclado desse tipo é uma tarefa difícil, então
Como a maioria dos anti -brutis não analisa a interceptação de funções
\ P32k.u5.Existem vários métodos de pesquisa.

Sobre o uso de antitatéticos que podem detectar interceptações de funções
U \ p3k.5u5 em kebug1 seredsk1reogta 1 evado ".

Sobre o uso de anti-lagadores especializados produzindo BL-
Keilogers deste tipo.O exemplo considerado anteriormente em
Nesse caso, ele pode ser usado como um aplicativo de teste.

Sobre o uso de métodos de pesquisa indireta.Em particular, a busca por criada
Protocolos de teto ou monitoramento de transações de desconto para disco em
O processo de inserir informações do teclado.Esses métodos não são muito eficientes
FECTIVO, mas pode ser usado como um dos elementos da auditoria.

pagina: 150

144 CAPÍTULO 2

Programas para rastreamento
Por trás do buffer da troca e remoção de cópias da tela

Programas semelhantes raramente são encontrados como aplicativos separados,
mas estão presentes na forma de funções opcionais na maioria dos modernos
espiões do teclado.

Rastreando um buffer de troca

Lançar atrás do buffer de troca geralmente é uma adição a Keilger -
Sua tarefa é manter o conteúdo
o algoritmo do algoritmo.Vários métodos são comuns.

(3 Preservação do conteúdo do buffer para o cronograma.
Raramente devido à baixa eficiência.

Sobre o monitoramento de um buffer da troca de métodos documentados- com
O poder das funções é 5ees111roaha \ 1 ischekh

Análise periódica da joint venture do conteúdo do buffer de troca e registro de
o fato da mudança.

Com a interceptação das funções AR [responsáveis ​​por trabalhar com o buffer da troca.

Considere como exemplo o monitoramento do buffer da troca com padrão

caminhos.Do ponto de vista da implementação, o exemplo mais simples é,

trabalhando no princípio de uma pesquisa cíclica do conteúdo da área de transferência

(Listagem 2.73).

Listagem 2.73.M Nitomari BUFAZ a... intercâmbio
Rgosedikha togp].
Uag

$: 5x9:
Problema tp

// obtendo o conteúdo do buffer da troca

$: = Teri (sirioaga.aztekh);

// verifique, há algum dado

Aqueles $ = '' em ECH1E;

// Comparação do texto com o autor analisado

1E ALZ1OMEKHSAZAZ (5) = TAZES13RIREATECHA EXEGER EX1E;
// adicionando ao protocolo

pagina: 151

Programas e princípios maliciosos de seu trabalho 145
Arroz tosooousoooooooooooooo soso ooso com um smoo ssoo llc ssoo e

Mepo1t.
Mepo1.

// Lembre -se da última amostra registrada do conteúdo
TAZES111IRGATECH: = al $ 1BOMEGSAZA ($);

EPA;

O princípio da operação deste exemplo é muito simples- com alguns periódicos
Nost (geralmente 1-2 vezes por segundo), um pedido de conteúdo de
Fera de troca na forma de texto.O conteúdo resultante é comparado com o último
Foi incluído no protocolo.No caso de uma coincidência, a função completa o trabalho,
Em caso de detecção de discrepâncias, ele entra nos dados do protocolo e
Pessoas para comparação subsequente.O algoritmo do trabalho desta função
assemelha -se ao princípio do espião do teclado com base no período
A pesquisa de teclado, que permite combinar a pesquisa de teclado e
Uma pesquisa do buffer da troca.

Um método um pouco mais complicado de rastrear o buffer está organizado
troca com base no registro de janelas em uma cadeia de janelas, que são
“Telesclerosos do buffer da troca” (Sirboaga Me \ Hegz).Registro do Window Pro
Ele é capturado com a ajuda do AR!

Pistine 2.74 Registro da janela dos medicamentos M 89601

RGOSDEGE TS1111Argamop2.
Dificuldade
Nmech \ 1lDo: = $ esiroata \ 1echcheg (np 1e);

EPA;

Zees11ryaaagau1meg recebe como um parâmetro para a janela NAP@e, que
Após o registro, ele começa a receber dois tipos de mensagens:

Com eles ovaistroav- transmitido para a primeira janela da corrente com cada um dos
a menenia do conteúdo do buffer de troca;

Com eles Dreamsnatm - transmitido para a primeira janela da corrente ao remover de
Correntes de uma das janelas.

O monitoramento do buffer da troca do aplicativo deve reagir
para essas mensagens e pelo menos transmiti -las para a próxima janela no
rim.Um exemplo da implementação desses processadores de mensagens é apresentado em
Listagem 2.75.

pagina: 152

146 CAPÍTULO 2

Listagem 2.75.Manipulador de mensagens

// mensagem "Removendo a janela da corrente"
RGSEAYAT TS11RRG@MAMOP2.ImpamySesvSnatm (UAG Meszade: Timsnam sesvsnatm);
Dificuldade?
// A janela é a próxima atrás de nós removida?
1e Meszade.
Interkhe1p9om;
E1ze
Zepomeszade (Spechamp, Meszade.mzade, Meszad. Vetoch, Meszade. Mesade ();

EPA;

// mensagem "alterou o boofer da troca"
Rhosedikh TS1111Argamop2.
Ed

// Digite dados no protocolo

Achatoggod ('*****'+batetishtobe eg (mãe}+'***+**');

Aaatard (c11rroaha.azteh ();

// Passe a mensagem para a próxima janela na cadeia

Zepamezade (Interheus, Meszade.mz, Meszade. Irabs, Meszade. 1 vaga);

EPA;

Esses métodos são as mensagens das mensagens para eles SnamSesvsnatm e
Eles são ovamstrovovovavo.

O mensageiro das mensagens para eles snamSesvsnatm verifica se a janela é removida,
que se segue na corrente atrás de nossa janela (a soneca desta janela é armazenada em
a variável bimehei1paon e retorna as funções de zees111rboh@\ zemieg).
Este é um ponto importante, porque depois de receber uma mensagem e resposta
Nele, nosso manipulador precisa transferi -lo para a próxima janela
corrente.Portanto, se você não responder corretamente à remoção de tal
A quem as janelas estarão ficando escapar da corrente, já que nosso aplicativo é um parafuso
Transmitir mensagens para uma janela não existente.

A reação ao imovaystrovoavoen é reduzida à solicitação do conteúdo do buffer
on, inserindo -o para o protocolo e transfira a mensagem para a próxima janela
cadeia de manipuladores.

pagina: 153

Programas e princípios maliciosos de seu trabalho 147

Em uma nota

Nos exemplos considerados, foi usada a classe de BER TS1111RYAG, colocada
NY no módulo de Sirgo.C11Rioa nesses exemplos - esta não é uma instância
classe e uma função com o nome "Spriagd", que cria uma cópia da classe em
O primeiro recurso o devolverá ao segundo e subsequente recursos.
Esta aula é uma concha de alto nível em torno de AR!
troca de rum.Em particular, obtendo o conteúdo do buffer na forma do texto
É preenchido com a ajuda de AR!

No momento da conclusão do trabalho, o aplicativo deve desligar a cadeia
Processadores (Listagem 2.76).

||

INY IN

Rgosedige ts111111argamop2.eoogipezegou (5ep4eg: tor) des ");
Vermelho p
// ensolarado da nossa janela da corrente
Drupsds111rroagasva3p (napb] e, nmech \ 1t4om);

EPA;

Removendo cópias da tela

A remoção de cópias da tela é geralmente uma função expandida dos teclados
Programa de espião ou vaskdog.O mais comumente encontrado
Algoritmos de trabalho de sopro:

Na remoção de cópias da tela de acordo com o cronograma;

Sobre a remoção de cópias da tela com base no evento no momento do lançamento dos aplicativos fornecidos
queima, exibindo certas janelas, entrando no teclado com antecedência
Dados de palavras ou combinações de símbolos.

Copiar a tela não é particularmente difícil.Considerar
medidas demonstrando a remoção de cópias da tela pelo timer, por igual
intervalos de tempo (Listagem 2.77).

|Pistimg 2.77, um fragmento de um programa que corresponde à contribuição da tela da tela

Rgosedige togt1 .t1peg1t1tet ($ ePET: TOB) eu®);
Uag

Tiade: Titada;

ZsgeePos: nariz;

pagina: 154

148 CAPÍTULO 2

fio
Tshase: = tgaaae.state (p1});
// Obtenha o tamanho da tela

Zheel.Asi;

º

Pré
Guade.
// Obtenha o contexto da tela
5SGEIOS: = demônio (0);
// Copie a imagem
Vev1 e (gpada.sapaz. Napa1e, 0, 0, tmada. \ Mzzchen, tmade. Nlava,
Zsgeeprs, 0, 0, $ all);
Ve] 1eazubs (0, zseegs);
// salve a imagem resultante
Gtade.r+Seiga.Zaueta11e ('Esg _'+
RochshatBasett1Net ('UuUuptyainpzz', mãe) +'.
Tlad.

EPA;

O exemplo examinado copia o conteúdo da tela em um arquivo que tem um nome
$ sg Ahatr, onde xxx é a data e hora de remover uma cópia da tela,

Detecção de programas implementando
rastreando um buffer de troca e tela

A detecção de tais programas é uma certa dificuldade,
Desde a realização dessas operações, não há intervenção em
O sistema e detectar a presença de tal "espião" é muito difícil.Aquilo não é
Deve ser menos do que alguns pontos que são úteis para pesquisa e análise
atrás.

O As funções são usadas para monitorar o Bureau of Exchange
1801: rboaggaglahacha1a6 \ e, opos111rroata, ses111rroaaragara,
Zess11ryaahau1meg, swapdess1 1rboagchsva \ p.

Sobre a remoção de capturas de tela da tela leva à criação de arquivos no disco

Volume precisamente grande que pode ser detectado durante o exame
PC usando operações de arquivo de monitoramento de utilitários.

Considere um fragmento de listagem de Dizassembler para um espião real,
Suspendendo o rastreamento de um buffer de troca (listando 2.78).

pagina: 155

Tecnologias de malware e os princípios de seu trabalho 149

.Ebecha: 0042110R Ru $ B 1

Seche: 0042110E SA] 11 E51;1 $ с111ryaakaaaGtaaua1] a] e
„.

Keykh: 00421113 ep zhenog 10s_42119
.Sheheo: 00421.11.5 Esez e41, porra

“Geche: 0042117 32 ZROK 10S_421126
.
.EHA: 0042111S SA11 95: OPOS111RYAGA
.EHA: 00421122 EAH EAH, EAH

„.
‚Shehs: 00421126 Hox A1, A1
"Kekhekh: 00421128 ETR LUZ 1S 4211AZ
„.EHA: 0042112A CE5E E41.unidade
.
Seche: 0042112

.Seeh: 00421130 Epirus ZPOGA 19S_421134
.Ee: 00421332 1OS 423132:

"Treinador: 00421132 RIZV 1

.Eha: 00421134
Seche: 00421134 1OS 421134;

.EHA: 00421134 SA1.1 95: Bess] 1Rroagarah
Tech: 0042113a nomes
„.
.Ebech: 0042113e rah $

.
Seche: 00421142 ruzv eah
.EHA: 00421143 SA11.YAZ: C1ofatuooskk
.Hekho: 00421149 POV EBH, EAH
.

.EHA: 00421.14 32 Alto 1s 42119a
.ThDig: 0042114th nomes!
‚Seju: 00421151

Chave: 00421152 32 Zhenoga 10s 421189

pagina: 156

150 CAPÍTULO 2

.EHA: 00421154 CA1} 93: 1 $ SG1PIE
.
Seche: 00421155 ri $ em e51

‚.

‚Seeh: 00421194 SA1.1.1 9 $: 61 ou t 1oskk

‚Geeche: 0042113A SA11 93: C10 ZES1111RYAGA
.EEHO: 004211A0 OU A1, 1
‚Telf: 004211a2 ror yerh

Este fragmento do código começa com uma chamada de função
15S111RBOAGAEOOGTAUA: 1A61E com o parâmetro 1 (Seinching)- isto é,
Há uma verificação se os dados no formato de texto estão disponíveis no buffer do Exchange.
Se os dados estiverem disponíveis, a abertura do buffer da troca com
a função da função OPOS1 {Rioak, então a solicitação de dados usando
Bes11rboak@ra*a.A função do seps111ryagarak retorna o descritor de
Trocar boofer em um formato jantar (no nosso caso, rspa-strack), para
o acesso ao objeto deve ser corrigido pelo objeto da memória global com
Usando a função C1OA1tosk.Em caso de execução bem -sucedida
1ora1tosk retorna o ponteiro para o objeto na memória.No caso de texto
A linha será ainda um desafio de grades 15 e x1 para determinar o tamanho da linha,
destacando o buffer para ler a linha e ler em si (na lista de ópera
o processamento de uma única linha é reduzida).Depois de copiar a linha
O objeto de memória global é desbloqueado (C1OA10P1SK) e
Fechando o buffer da troca (C1ozes111roaak).

O código considerado na Listagem 2.78 é bastante característico e
Ele se reúne com pequenas modificações.No entanto, sua descoberta
diz apenas que o aplicativo pode ler o conteúdo do buffer
trocar em algum formato.Uma operação semelhante é realizada em um ou
de uma forma diferente em quase todos com] aplicações, portanto, se for detectado
A etapa a seguir na análise é o estudo desse código, quando
é chamado e o que mais tarde é feito com o recebido
dados.

Existem métodos conhecidos para proteção proativa contra o rastreamento de um tampão de troca,
que são reduzidos a monitorar as chamadas das funções do BOPS11rbokak@.
Sees1 {Ryag@Voyages e 5e*s11rbsaga \ “1emek em tempo real.O próximo é geralmente
A abertura da abertura do buffer de troca e seus dados são bloqueados
Para aplicativos que não estão no foco da entrada do teclado.

pagina: 157

Programas e princípios maliciosos de seu trabalho 151

Em uma nota

A análise de várias aplicações mostra que vários programas úteis
Realize o monitoramento completo do conteúdo do buffer de troca.Isso está dentro
Primeiro de tudo, uma variedade de processadores que estão procurando no bufvra
Uve para adicionar automaticamente tarefas.

TGODAP-EOMPTOADEG

Os programas de categoria de tgoap-ooo \ cshuooadag são muito comuns e exemplo
Eles estão nus para carregamento e instalação secretos no sistema de estrangeiros
grama.Esta tecnologia é usada ativamente pelos desenvolvedores do Trojan
e programas de espionagem, e recentemente até alguns postais
Rus observa seu corpo, mas um pequeno TGOAP-POM/PUADEG.
O próprio verme.

Do ponto de vista técnico, o TGODAP-OOMSHUADEDED é um anexo simples
Eu como, o que permite examinar em detalhes seus textos originais.Muito pesado
A maior parte do Tgouap Ooochupuadag é construída de acordo com um dos três esquemas típicos.

O Com base nas funções do Mlite!.I (Tosekhpegopen, tpsekhpopp.).
Com base na função da biblioteca ouveboip1o9 para iitle.ai.

Com base nas funções da biblioteca \ 52_ 32.91.Este caminho requer
Trabalho de conhecimento do protocolo usado para baixar o arquivo.

Tgo] ap-eomuaadeg com base em funções
Biblioteca Iitop

Considere o texto original do programa de demonstração no idioma BER,
Percebendo carregamento e lançamento do arquivo (listando 2.79).

Tratimg 2.79.TGO] Ap-Bsumpyuzhdeg baseado
Do bibpiotex iuitop

Rrgosedig theog1.
Waah

E11EMAPA, Zakhemamama: Z2E1P0;

Bebê

E1zemate: = ‘n: // <it1 server> /hezt.ehe ';

Fodendo: = *S: \ 6K0) _ {e5S.ehe ';

pagina: 158

152 Capítulo 2

-a - -<
// Download do arquivo
OvDochrp1Oayte1 1 E (011, RSVAH (E: 1 MEMASHCHE), RSRRRG (BAUMAC), 0, 011);
/!/ Lançar
$ e11] ehesis (0, p11, rsvahg (suumapta), p11, 111,
$ E_NATE);

EPA;

Como pode ser visto neste exemplo, o programa realmente consiste em duas linhas -
Chamando a função de Ovrontoataata11, o arquivo está carregando e salvando
Está no disco sob o nome C \ yoke} lez.ehe, a chamada $ pe1] é lançada por

Programa carregado.

OBSERVAÇÃO

Os textos iniciais dos exemplos do TGO/AP-ROMIPUAGA nos ajustes considerados no livro
Gamam CDs vão nas línguas da fé e C, mas o texto do livro é dado
Somente em Verne.

Devido à simplicidade da implementação, várias opções para tgodap-ooom/tuaadeg
O tipo é frequentemente encontrado, no caso de implementação na linguagem de AzzetyEg
O tamanho do programa executável não excede 5 kb.Muitos antivírus
(especialmente equipado com um emulador) pode detectar o código do modelo
Esse tipo como um objeto suspeito.

TGODAP bombardear com base em funções

Bibliotecas MMPTE!

Um exemplo de tgoap-ooo \ m/tuaadeg com base nas funções de Uliete (listando 2.80) vários
mais complexo que o anterior, mas o desenvolvedor tem mais possibilidades
Controle de vapor do processo de download de arquivos.Para uma variedade, considere

A implementação desse tipo de TGOAP-PO \ atualmente no idioma C, idêntico
Medidas de veado podem ser encontradas em um CD.

: Listagem 2.80, exemplo de tts] Ap-chitiyadg n® Função da função \ pPES oh oh
#1ps109e <1pdu $ .p>

#11S1I9E <1p1oee.n>

E!

Pazp (11 Agas, Swag *Agdu | [])

pagina: 159

Programas e princípios maliciosos de seu trabalho 153

{
Ntmtevet b5e $ 51op, god1;

SNAV 52

Umoye ve!] e;

Omovo Chivusevai, dmvusezchg1eep;

SNAV *52R1111111111111111111111111111111111111111s: // <v server> /ke5e.ehe ";
Snak *с25 aemate = "c: \\ tgo) ap_+rog1.eh";

Snav *52arrming = yeah \ [0];

RBE551OP = TABSEGPEOPEOP (52Arrmate,
Tmstepmet orem turey milot,
MO,
MO,

0);
1e (r5zz1op == m0.)
{
Rglpee ("Erro de chamada teegpueop (), código: %4 \ p", besgazeegkoch ());
Gebogp 1;

}

// abrindo um determinado PV

Aqui] = tpbeleorepig1 (em 5e551op,

52E111EMAPA,

MO, 0,
Tmtevmet rias raasma mosasne |
Tmtevete EAS No. OG |
Tmtevete eas mo propez |
Tatevmet Etas Mo Sasne Matte,
0};

Aqueles (nº 01 == m0)

{

Ru1pee ("Erro tpeegPeeorEPOG] () (), código: %4 \ p", SeeasometCog ());
Tesigp 1;

// Criando um arquivo no qual registraremos os dados aceitos
Ve11e = sgaeee11e (z2baumamche,

pagina: 160

154 CAPÍTULO 2

Senuevs Veo |Semevts chate |Semets Eheesota,
0,
MO,
Sveta_agmau $,
Attvtvttveta_momma!
Nós);

1 (armas == Gauaa para o Uaboi)

{|

RA1PEEO ("O erro do stea+Its11e {), code: %i \ n", sesgazoeggog ());

Geiigi 1;

// ciclo de download de arquivos
Cho
{
1e (tleogpeevaei11e (vog1,
& 32VeEEG,
312EOO (3Z2 IEEGE),

& amvusezvead)}

1e (cevada! = 0)
1e ('isteusa (ves? 1e, $ 2 -shit,
Amvvusezveaa, & amvusit1eep, nº 1.)))

Retpey ("erro istheg11e (), código: %9 \ p", beetazeehog ());

Gabigi 1;

}
E1ze
{
R1pieu ("tpsegpesweyae error (), código: %4 \ p", sessa -ezeeeggog ())};

Gevagp 1;

} Mv11e (4ivuseara! = 0);

pagina: 161

Programas e princípios maliciosos de seu trabalho 155
-

// Fechamento de todos os NAP41e
C1ozenap 1 E (ver11e);
Tpetgpes] 1ozenapa1e (10G1);

Tpeegpes1ozenapa1e (p5besez1op);

// Lançamento de um aplicativo carregado
Tzen1] eheeSis (Mighty, m, 52 Zaumama, mosh., Mo, US $ 8 ntr);

HEBOKP 0;

O processo de download de arquivos começa com a chamada da função TPEGPESOP.Inter-
Renuncie ao segundo parâmetro desta função, que define o tipo de conexão.Em
O caso do constante tmteamet orem ture rtvest prescreve para o trabalho
Diretamente, sem usar as configurações do pythyg ecrogeg.Indicação da constante
Tmtevet ome_ tur rvovonetas levará ao fato de que a troca com a Internet
será produzido de acordo com as configurações do iEglayo Echrogeg
(As configurações são lidas no registro).

Em caso de inicialização bem -sucedida, há uma abertura de um determinado Cheka.Com ajuda-
A função das funções do TpegpeyorePich1, o conjunto de bandeiras em seus parâmetros indica
O fato de o arquivo carregado não ser um cache e tirar do cache.
Em caso de abertura bem -sucedida do CCHG, um arquivo no disco é criado e começa
Ciclo de aceitação de dados.Os dados são lidos para o buffer com ajuda
1 peehpeevead e!1e, e do buffer são gravados no disco.

A condição para sair do ciclo de carga é receber no próximo
Dados de dados de volume zero.Depois que a carga é concluída,
Fechando tudo aberto durante o trabalho e inicie o carregado
Arquivo usando uma estrela.

TGO] AP-OGORREG

Os programas de categoria de categoria-Ogorreg são frequentemente usados ​​pelos criadores
Programas de denúncia para mascarar seus "artesanatos".A principal tarefa de
DAP-EVTGORREG-INSTALAÇÃO NO SISTEMA DE UM ou mais maliciosos
programas.Freqüentemente, o cenário do trabalho do TGODAP-OGORREG consiste no seguinte
Estágios:

|.Extraindo um ou mais arquivos para o disco que contém danos
Programas não -NOSE.

2. Remoção de um programa "útil" e seu lançamento.

pagina: 162

156 CAPÍTULO 2

3. O lançamento dos programas maliciosos extraídos.

4. Como um programa "útil", um determinado utilitário de rede geralmente age
Este ou um pequeno programa.Além disso, do ponto de vista do uso
Tudo parece bastante padrão - o download da internet
Uma certa utilidade, lança-o- visualmente o programa começa e trabalha
derretendo como deveria ser.Observe o fato de extrair um computador moderno
lendo e lançando vários programas maliciosos de 20-
50 kb é quase impossível.

5. As aplicações extraídas no lançamento do TGODAP-OGORREG são armazenadas em seu
le, muitas vezes em forma criptografada.Você pode distinguir vários
Tecnologias de armazenamento.

Com o armazenamento de arquivos nos recursos do TGODAP-OGORREG.Esta abordagem é
Método de armazenamento de dados padrão no arquivo executável, acesso a
Esses dados podem passar por funções AR1 padrão.

Do aditivo de arquivos até o principal arquivo executável.Procure por isso
Os arquivos são realizados de acordo com uma assinatura especial publicada antes
dados no final do arquivo.

Dados de colocação do sistema operacional diretamente no código do programa.
Considere um exemplo da implementação de um típico TGAP-OGORREG (Listagem 2.81),
Arquivo de armazenamento em um formulário criptografado no recurso.Criptografia é feita

Usando a operação de um hóquei de cada byte armazenado no recurso de arquivo de
Número 58.

Folha 2.01, exemplo de TGO] AP-OGORRGERG

Rgos rgos) eu+1;

05E $

I1pdoz, Meszatez, C1azzzez, Zre11arart, 5U $ 0E11 $;

{$ Em condensos.
// procedimento para extrair o recurso para o arquivo especificado
Rgosedicge ehsgast (Lantature, Unimama, Vosmemmamat: 5GG11P9);
Waah

Dirigindo $: ttu5ocgse $ theam;

M5: portão tmeePogu5;

1: Elsedegk;

pagina: 163

Tecnologias de malware e os princípios de seu trabalho

Red1p
Bort: = tkezoigsa $ e theap.state (n1pztaps, ravy, rspah (lanure));
M: = tmeopoGubeagat.staee;

Bes.beek (0,0);
M5.
// Decripção do recurso
{
Ex 1: = 0 No. 0 No. M5.512E - 1 AS
BUSA ​​(ROGLSCH (AMOKHA (MB. PETOKU) +1}^}: =
BUSA ​​(ROSPEPEG (DOGA (MB “Pepoo) +1) ^) porco 55;
}
M5.Bachetoer11e (Wesmeimalm);
Baía.
M5.ELE;
EPA;

Tah

E, E1: ela;

Zauman: 56g1pa;
Bedp

Zaumama: = 'c: \ 6ho] Her5®E.ehe';

// eliminação do arquivo do recurso

Ekhegasev $ ('ekhetie', 'veses', baumapa);

Ryn Eheesye (0, p11, rstakhk (baumate}, p11, 111, 5i ntu);

EPA.

157

Para compilação deste exemplo, você precisa preparar o arquivo 1G} AP.
contendo arquivos EH incorporados em nosso exemplo.Para criar um semelhante
Um recurso deve ser criado um arquivo para} ap.gs do próximo tipo-

Ting 2.82.

Listagem 282. Bigode de Fluxo]

Vesuzam ekhbega & g03) _thes.eh

O arquivo Pap.gs deve ser compilado com a ajuda do 6GSS32, como resultado do qual
Você receberá um arquivo do IOAP.Como lenda

pagina: 164

158 Capítulo 2

Para observar, no recurso, você pode colocar vários arquivos - para este
Você precisa listá -los no arquivo de alça.

O ciclo incorporado nas funções do EchtgaSesez demonstra a possibilidade
A descriptografia mais simples dos dados extraídos do recurso.

Falando em tgo} ap-ovgorreg, é necessário mencionar que vários antivírus
Não é possível verificar os arquivos publicados nos recursos, portanto
Há um certo disfarce de arquivos.

Tecnologias de proteção de malware
programas da remoção

Métodos de proteger o malware da remoção recentemente
Obtendo toda a popularidade bolipana.Um pouco
tecnologias mais comuns.

Com a instalação do programa malicioso como processador \ juvdop e em
como a expansão do condutor.Ferramentas de controle de automação padrão
O lançamento do tipo tzsopye não controla a lista de manipuladores \/11 JUNCO, e
O uso de utilitários adicionais lll lll llc systems requer de
usuário de certas qualificações.

Sobre muitos programas maliciosos (especialmente ACH / AGA) podem ser realizados
na forma de uma biblioteca, portanto, o estudo de uma lista de avanços
Os processos não permitirão que o usuário o detecte.

Sobre os arquivos de software pode ser aberto com acesso ao monopólio que
complica sua descoberta por scanners de antivírus e anti -vigília
programas e blocos de cópias pertencentes a maliciosos
grama de arquivos de maneiras padrão, o que complica significativamente seus
Enviando para análise.

Sobre vários métodos para proteger as chaves do registro e sua restrição periódica
reforço.

De proteger seus arquivos executáveis ​​contra exclusão atrasada.Um 13
Os métodos de proteção mais comuns são baseados na renomeação
arquivos executáveis ​​com cada reinicialização.O outro é baseado nos vinhos
NII por trás da chave do registro que armazena as configurações de remoção atrasada.

Os métodos listados recentemente em uma combinação específica são todos
mais frequentemente encontrado nos programas de Trojan e Aya \ Idade, o que cria adicionais
Os problemas do usuário para o usuário- excluem um programa estagno semelhante
É impossível para meios gastos, e nem todos os antivírus podem lidar
Com a remoção correta de tais programas.Tecnologias descritas da hora
que são combinados de uma forma ou de outra com tecnologias Rutkot, que é ainda mais

pagina: 165

Programas e princípios maliciosos de seu trabalho 159

É difícil remover o programa malicioso do sistema.Em vários prejudiciais
em explicitamente, há uma proteção clara contra a remoção atrasada,
com base no fato de que, nos sistemas MT, uma lista de arquivos para atraso
A preguiça é armazenada no registro, o que permite que o programa prejudicial monitore
a chave correspondente e se necessário para corrigir ou limpar
A lista localizada lá.

Outra metodologia é costurada da remoção pode ser chamada de método de Trojan
Fluxos.É baseado no fato de que o programa malicioso cria vários
Trojan flui em um ou mais processos sistêmicos.Dados
Os fluxos podem resolver uma variedade de problemas, em particular, reiniciar o
Processos bronzeados ou arquivos excluídos.Um exemplo
pode servir como ach \/idade.
um apêndice com o nome Pai.ehe, que cria vários fluxos no sistema
Processo nom de ecrogeg.ehe.O processo da ação.
costure e exclua seu arquivo de software (ou seja, do ponto de vista do antivírus
A remoção é bem -sucedida), mas depois de alguns segundos, o arquivo será restaurado
Está ligado e lançado pelos fluxos de Trojan.

Uma opção de proteção mais simples é o método de dois processos, consistindo
O fato de o aplicativo criar dois processos se seguindo.
No caso de interromper um dos processos, o segundo reinstala imediatamente
Kat, que não permite que o usuário conclua o processo usando o acampamento
um despachante de presentes de processos.

Bloqueando o acesso ao arquivo

Bloquear o acesso aos arquivos de arquivos é comum
Todd projetou para dificuldade em analisar arquivos.Não é conhecido
Quantas maneiras de implementar esse bloqueio:

O Usando as funções do TOSK11111111OKSH1SKAZ1EKH BIBLIOTECA KEGPA!
(Este método é aplicável apenas para a plataforma MT);

O Abrindo arquivos protegidos em um pré-
argamassa;

Sobre o método de cera.

Considere como exemplo, a implementação do bloqueio de acesso ao arquivo em
Com base no GOSK11EAH (Listagem 2.83).

;Pistmong 2.83, um exemplo de funções, bloqueando o acesso a uma lareira

Rgos Goska1ta (AR1] EMASHECH: $#X11P9);
Uag

VE11E: Tanta1e;

pagina: 166

160 CAPÍTULO 2

12ooEg1arre@: ToeugZarred;
512E, Ba2en: Riovo;
Vermelho p
// Abrindo o arquivo
Ver11e: = sgeAbee11e (rspag (ae: 1mate),
Semevts_vaoo,
Etta conhece veao,
P11, Orem Echtzttms,
Levantando o apego movmat, 0);
1e ve11e = tmuabto namye uato & beep ex1e;
// determinação do tamanho do arquivo
$ 12ETO: = SECHEG11E $ 12E (VA11E, @$ 1GEG1);
// bloqueio de arquivos (do começo ao último byte)
2GometoHog (@1RouEg1arrra, $ 12E0E (1RouEG] Area));
Bosk11eokh (ve11e, tyskier ratg tmmeotaeu ok roskrtier echosotue tsk,
0, ezheo, 512en1, 1Rouk1aroea);

EPA;

Esta função abre o arquivo com a ajuda do sgetee \ 11e, depois determina
Seu tamanho está bloqueando o arquivo com a ajuda do Melancholy11 AS.Especial
O sem perna deste exemplo é que o arquivo não fecha depois
os esporos da época, o que leva à retenção do bloqueio durante
O tempo de operação do aplicativo que causou essa função.

Combater os principais métodos
proteção contra a remoção

Lutar com um programa malicioso protegendo ativamente contra a remoção,
difícil o suficiente.Além disso, quanto mais métodos de proteção implementados
Programas de arenque do programa malicioso, mais complicado é oposição.Aqueles
Não menos, existem vários métodos suficientemente confiáveis ​​e eficazes
Dick oposição.

Sobre o uso da tecnologia AU7OTSAG.Esta tecnologia está construída na vila e
permite bloquear várias funções sistêmicas durante o estudo
sistemas e tratamento.Desde o momento de ativação de A7szaga, todas as aplicações de-
Eles são admitidos (estes são os próprios Au7 e quaisquer aplicativos lançados
eles) e sem princípios (todas as outras aplicações).Não lucrativo
É proibido criar processos, manipulações com já negligenciado

pagina: 167

Programas e princípios maliciosos de seu trabalho 161
——— P - - - - hm - ymm - ® - $ rf "p" ovryrk - - zh -rdcd -d

processos, registrando em memória de outros processos, modificação de re-
Estra e a criação de arquivos executáveis ​​no disco.Essas restrições sobre isso
Travy mais métodos de proteção implementados em distribuídos
Programas não -dearm.

Com a conexão do Noo do PC estudado.para outro computador para verificar
KI e tratamento.

Ao carregar com Co ou Ra $ V-Disk, equipado com um tipo de concha
Tapdeg ou contendo GLPI com antivírus pré -instalado.

Nbaskug

Os programas de portador de vreel das categorias de Ntaskug são muito comuns, eles são
significado- mudança não autorizada nas configurações para usar
Calle.Na maioria das vezes, as configurações do navegador são modificadas- o antigo
Stonipe de fala, prefixos de protocolo, página de pesquisa.Universal
Nuaskug são raros, basicamente eles são projetados para um certo
Tipo de navegador, na maioria das vezes - no ECHR NESS |

O dispositivo Nyaskug é muito simples e é reduzido na grande maioria
casos para modificar o registro.Considere o exemplo mais simples (listando
2.84), que é útil como um aplicativo de teste para verificação
O trabalho do sistema de proteção proativa e estudo do trabalho de serviços públicos, pretendido
Para restaurar as configurações do navegador.

“Listagem 2.84.Exemplo "; asthetoto nfaskag

Tah
Vedas: Twed1 Zagu;
Dificuldade
Vedas: = twed15egu.sgeak;
Veda.
Ze ved.
Problemas1p
Ved.it1ta5et1pd ('5eah rada',
‘A página inicial é substituída por N1d) Ascet '');
Ved.
EPA;
Veda.
1º Vedas.

pagina: 168

162 CAPÍTULO 2

problemas p
Vedas.IG1TA5TG11P9 ('55 EAGA RADA ',
'' A página inicial é substituída pelo H1 Zasaskug! ');
BI.S1O5KEUU;
EPA;
Ved.

EPA;

Este exemplo modifica o parâmetro chamado ZTake RADA Key
Estra STATIAVA \ M1SHOZOOE \ TPEGPEE EHR1OGEG \ MA1P.É fácil perceber que
Esta chave é modificada em dois lugares do registro - no Nkau Tosag Masontka e
NKAU_ SUVET OOSEV.Este exemplo é construído sobre o resultado da análise de um
do nuakag real (apenas CV, é claro, é substituído por
mensagem de texto).

Além da substituição da página inicial, programas de categorias maliciosas

O NSPARGE geralmente modifica várias outras configurações:

Sobre a página inicial (parâmetro chamado Zeak RADA Key
Zoetiave \ MusCosoms \ Tpeegpee ehr1ogeg \ ma1p) e a página inicial na
padrão (reoai1+_zeagsn ov key zoertiave \ m1 stozoe \
Tpekpeie echrogech \ ma1p);

Sobre o texto exibido no título de IEIGPE: ehr] ogeg (parâmetro isom t1e1e1e
Chave de zotiave \ m szozoe \ tosogpee ecrogeg \ ma1p);

Sobre a página de pesquisa (parâmetro Seahsp RADA Klyuch ZooetNevav \ M1 Shoozoen \
Tphegpee ecrogeg \ ma1t);

Nos prefixos dos protocolos padrão (Key 5th \ M1Skozoe® \
3 Paochz \ siggeePsop \ ov \ rhee1hezh).

Nesta lista, apenas as principais teclas do registro Niegte estão listadas!
Ehryuga, de acordo com as estatísticas, o NBaskkeG mais modificado (no total
Mas mais de cem chaves e parâmetros).

Tecnologias de rastreamento
por trás da atividade da rede

Rastreando a atividade de rede do usuário no último
O tempo é uma das direções em desenvolvimento ativamente.Básico
Áreas de aplicação da metodologia:

Sobre a coleta de estatísticas sobre o trabalho do usuário na internet, como regra,
Uma lista de visitas a bolo do usuário está preocupada;

pagina: 169

Programas e princípios maliciosos de seu trabalho 163

Com a busca de logins e senhas, números de cartão de crédito e outros confiantes
informação de cyar;

Sobre a coleta de informações sobre a rede local do usuário.

Naturalmente, a maior ameaça ao usuário é um triplo
programas, desde o roubo de senhas ou números de cartão de crédito
Pode causar danos significativos ao usuário.

Rastreando a atividade da rede é frequentemente combinada com outros métodos
Espionagem.Por exemplo, um espião comum do teclado de Asha [$ ru
Ele monitora a conexão com a Internet e os sites visitados pelo usuário.

Rastrear a atividade de rede do usuário pode ser implementado
Métodos pessoais.Os mais comuns são:

Sobre a instalação do VNO (vgochzagen neveg aberto!) Para o usuário usado pelo usuário
Navegador - é usado principalmente para o registro dos CVCs a serem visitados;

Sobre a interceptação de funções de arg usadas para trocar com uma rede em ruttes
Princípio, é um dos métodos mais comuns;

Sobre a instalação do filtro TO1;

Na instalação do seu próprio provedor ZR1/T $ P é esse método, em particular
Estil, usado em ab \/aga.Pur meg;

Sobre o uso de sniffer baseado em kampkeya
Sobre o uso de uma rejuvedor de pleno direito baseado em um $ mergulhador.

O uso do VNO é o método mais comum para a AA \ Age-
e $ RU \ AGEL APLICAÇÕES.Normalmente, esse VNO é feito na forma de um painel para
Um navegador que oferece algumas funções expandidas de pesquisa e navegação.
O exemplo mais característico é ach \ Age.nophagus, transmitindo tudo para
o usuário do CV [, seus criadores.No entanto, o perigo de Zru \ uaga
geralmente pequeno e o dano que eles causam são reduzidos a vigilância para
os centros e a reprodução da publicidade contextual.

Ferramentas muito mais perigosas para o monitoramento, construídas em Rutkutka-Princide.
Eles geralmente interceptam funções de alto nível, por exemplo,
Tpeehpeeorepig1, tpeegpeeveAar1] e e tpeegpeSig111e, que permite
monitorar tanto visitou o IVG e transmitido/aceito em
formação.O uso de filtros simples permite que você distingue do fluxo
Informações especificadas, por exemplo, senhas e números de crédito
kart,

O Sniffer oferece oportunidades ainda maiores.Em primeiro lugar, por sua implementação, não há
A interceptação das funções é necessária, o que a torna menos perceptível.Em segundo lugar,
O Sniffer pode gravar o tráfego de rede de outros computadores de rede,
o que aumenta o perigo que ele criou.O mais fácil de implementar o
Sniffer com base no Kam 'Zoskei (listando 2.85).

pagina: 170

164 CAPÍTULO 2

Listagem 2.65.Sniffffa Mai Kai Foseeee

#1ps №ae <eedaehk.n>
#10S1AE <e1l $ okka.n>

#1ps2oda <t5srar.v>

#aee1pe mah
// buffer para receber um pacote
Eva1s Wottae (Mach Virgin 5T2E];

p _ta1l (116 agas, _stsnav* aqua [])

{
Usabata do depósito;// inicialização e 1pbosk
Zoskat Voyboski;// soquete de servir

// inicialização e52_32

Iza5auer (Makemovo (2.2), & mzayaaka);

// criação de seu soctent

Vaiboski = Zoskei (Ae Tmet, 5O0SK wai, Trrvoto tr};

// determinação do nome do host

Nobreza de espuma [256];

DepoZepapa (NOZ © Masche, 51cheo (Nozismo));
R1Pue ("Noemate = %$ \ p", Nosemate);

// Determinando as informações chamadas khost
Rnobtmet - rgsa1 Noseter;
Rosa Nosele = desponsebupap (Nozismo);

// Preparação da estrutura do Boskeag com o endereço do host
Bzoskarov TM Boskadag;
2Gomepok (& Boskaai, Z1cheo (5 -Skadag));
Bosk.
Zoskaaga.1p ach@g.z a@ak =

((3p aaah *) ryos no8 $ heely-> n a @@ g_115: [0])-> 5_ aaag;

pagina: 171

Programas e princípios maliciosos de seu trabalho 165

// Vinculativo
B1PA (Voyboskei, (Zoskaron *)} & Zoskadag, Z1esses (Zoskarov));

// liquidação da placa de rede em "rgopaziots $ pow"
// CLASLE de Zagota de todos os pacotes

Il519pyua 1sp9 2e29 = 1;

10SE15OSK {(Vubosket, US $ 10 vsuash, 6e19);

// recepção de packages TR
IN11E (GIY}
{

Pe ststspa;

SOMPE = GESU (Voyboskoye, (Swag *) ViEnee, US $ 12 Eve (Vuyeus), 0);

re1poe ("Tel = %A \ p", Rappy);

// --- Código para processamento e gravação de um pacote GR capturado ---

C1ZoZazoskoska (Vach5Sket);
Izas1eapur ();

O exemplo é bastante simples, os principais estágios são descritos pelos comentários.Ele
Cria você Zoske!E o usa para receber todos os pacotes 1P.Se in
Com este exemplo, remova a linha:

10se1 zososkoy (Voyboskoye, $ 10_vo, & e19);

Em seguida, a placa de rede não será transferida para rgoptsioi $ ppod, e sniffer será
Registre apenas o tráfego do PC no qual é lançado.

Outro método comum de rastrear a atividade da rede é
Há rutkin-technology.Como exemplo, consideramos o verdadeiro Trojan
Um programa da família TGODAPBRO.
o volume de números de cartão de crédito.Fragmento do protocolo do analisador
A interceptação das funções é dada na Listagem 2.86.

pagina: 172

166 CAPÍTULO 2

|Listagem 2 56. O fragmento do protocolo a \ ue não é
<Tgaat ru mil 2. wapkeg

1.1 Pesquise interceptores de arte que trabalham no Zegmoay
Função P911.911: Gagaia011 (70) Interceptada, Método Artistoden1) Assk.

Função m1p1tpet.911: knubelvesto5ea (207) interceptado,
Método ArtSoden] Ask.Proto

1.2 Pesquisar interceptores de arte que trabalham no modo de Kegpa1

A função 7MSheAfergosesse $ (2E) é interceptada (80583543-> e9e57219),
Interceptador com: \ Morning $ \ IL5SET32 \ LEZRGE.5U3

A função 7mskavaterehsezesh (30) interceptada (80588503-> e9e57280),
SberBLASTER COM: \ MEMEG $ \ 5UZET32 \ 1ZRGE.5U5

Com base no protocolo de listagem 2.86, fica claro que quatro funções são interceptadas - dois
Em Chzegmod e dois em Kegpe!O princípio da operação deste espião é reduzido
Para as seguintes etapas:

1. O driver 1E5ri.5u5 é carregado, interceptando as funções
2mstacergoseze e 2mstacergosezesha da maneira padrão - por
Substituições de endereços em kebugulsezt1rezt] e.Interceptar essas funções
Permite rastrear o lançamento de processos.

2. No momento de iniciar o processo, o interceptor de função do Rutkin do modo núcleo
Interpreta a função 1AG1OA4011.A interceptação do modo núcleo permite
ignorar muitos sistemas de proteção que produzem desafios
Funções it1sergosezmepog.

3. No momento de carregar a biblioteca do mshtesap, a função é interceptada
Ção de Nerbepadsyishev.O interceptador desta função recebe a oportunidade
A análise dos parâmetros de todas as solicitações da aplicação afetada,
Pólen através de Nesrzepdaasze.Como você sabe, IEGPAG EHRYUGA
usa essa função, portanto, pelo menos, todos nttr-
As solicitações do navegador serão interceptadas e processadas.

O espião trabalhando na tecnologia de Rutka tem um sem dúvida
Propriedade- é possível implementação direcionada de interceptores em estritamente determinado
processos (por exemplo, nos processos do navegador), o que complicará a detecção
o espião.No entanto, é emitido por interceptações de funções que estão ausentes em
Caso de uso de sniffer.

Tecnologias de Contração de Rgemga!

Como você sabe, o trabalho na internet está praticamente praticamente
inconcebível sem o uso de ria \ ai que protege o computador contra ataques

pagina: 173

Programas e princípios maliciosos de seu trabalho 167

de fora e limitando a operação de aplicações de acordo com o especificado
Regras do usuário.Emem |é uma ferramenta eficaz para
Bloqueando o trabalho dos programas de Trojan, especialmente a categoria de TGODAP-RZ \\.

Considere os métodos mais comuns para contornar o eiseuan, bem como
As contramedidas e técnicas de teste usadas no Eemay.

Acesso à rede de um aplicativo não executado

Este método é o mais simples e é lançado
Uma certa aplicação que, do ponto de vista de Ejeo |Não está lançado.
Este aplicativo está tentando trocar dados com a Internet,
A torção da troca indica a inoperabilidade do rgy \ iai ou seu
Ajuste incorreto.Este teste é obrigatório
Elemento de teste \ ma |, em essência, verifica seu desempenho
Ness.

Metodologia de teste: o programa do testador atua como um incrível
Os aplicativos estão tentando trocar com a rede.Troca bem -sucedida de falar
Rit sobre os problemas no trabalho dele \ ma | th ou sobre seu ajuste incorreto.Em ka-
A honra de um programa de testador pode ser considerado anteriormente
Um exemplo de tgoap-do \ upyadeg.

Acesso à rede usando NVA \ Zosk!

Este método é semelhante ao anterior, mas para a troca com a Internet
Ka \ e Zoskug estão mudando.Tecnologia ka \ y!Zosk {permite o aplicativo para
Pegue e envie pacotes de rede reto.Usando Ka \\
Zosk {permitido para utilitários de rede especializados (por exemplo, ska-
Portos neo), mas seu uso em outras aplicações é extremamente
Residencial.

Metodologia de proteção: muitos ethemai permitem definir regras individuais,
permitindo ou proibindo o uso de ka \ s/ $ zoskka.Se um
A função não é fornecida, o eiman deve limitar a rede
a aplicação de acordo com as regras fornecidas, independentemente da metodologia
intercâmbio.

Métodos de teste: um programa de testadores tenta transmitir
Informações ou recepção de pacotes de rede com a ajuda de ka \/ zoskug e estudo
Há uma reação dos próprios próprios a essas operações.

Em particular, estudar a reação dos eimaps às operações com Khu Zoske
Você pode aplicar um fumante considerado na Listagem 2.85.

pagina: 174

168 CAPÍTULO 2

O gerenciamento do aplicativo confiável

Este método é bastante popular e no caso mais simples se resume a
Lançamento de um aplicativo confiável com parâmetros (Listagem 2.87).

Techrovava.eh Farse: //mti.vaskug-zka.
Skr.EHA /C "Technovo. EHE Melhor: // m. Vaskkag-z1*e. Ha? & Heehh = thor $

Em princípio, o RTemai não é obrigado a consertar e bloquear lançamentos semelhantes
Ki, no entanto, a falta de controle sobre o lançamento de aplicativos confiáveis ​​com
Os parâmetros podem levar a um vazamento de informações, ignorando o EIMA |.

Metodologia de proteção: os Eemats devem controlar o lançamento do confiável
Colocar é incrédulo, especialmente quando se trata de um navegador.Muitas vezes eimai
Verifique se a janela do aplicativo avançado para o usuário é aparentemente.
A troca de invisíveis para o usuário do aplicativo da Internet suspeito
linho, e se este aplicativo for lançado pelo incrível, então duplamente suspeito
Telly.Um exemplo da resposta do eimai a uma metodologia semelhante para ignorar
Zan em Fig.2.11.

O processo de corte solicita uma rede de rede

> Eu tinha Echrich: [Não foram encontrados programas de espionagem]
O processo oculto solicita a conexão Ishsdyschev

Pronez com \ araobeva atezuNterMet Ekhreovauriovo ouriços.
Lançado por \ tebturteztech
Piro Rneman R: Isso deve

(Supermine a publicação de rede de acordo com as regras para esta disposição
G permite
com 5 afastando as capacidades para este processo
9 O processo está tentando transmitir parâmetros suspeitos através da linha de comando
Se você confia neste protz?
Suschendo os direitos

Gona para mostrar mais a esta mensagem

Arroz.2.11.Reação de $ {rimgay
Para lançar um processo oculto com chaves

pagina: 175

Programas e princípios maliciosos de seu trabalho 169

Metodologia de teste: o aplicativo do testador lança um certo
Programa com parâmetros.Geralmente, no papel de um aplicativo confiável,
Um navegador é solda, cuja gestão ocorre usando uma string de comando
ki, ambos ou mensagens de mudança para sua janela principal para simular o trabalho
Do utilizador.Alguns utilitários de teste criam a tarefa de planejar
sapatos usando o Arg correspondente ou com comando (neste caso
O início do aplicativo confiável será feito pelo próprio sistema).Um teste semelhante
pode ser realizado de forma independente - com a ajuda de um planejador de tarefas
Programa o lançamento único do navegador com a linha de comando em
O tempo dado e analisar a reação dela \ May.

A introdução de pessoas de fora
Em processos confiáveis

Este método é o mais fácil de implementar e envolve vários
Variedades de implementação.

Sobre a introdução de Osh.Com a ajuda do mecanismo de armadilha.

Com a introdução de Osh.Com a ajuda de Stiasaynheteteaaa.Nesse caso, na memória
Os aplicativos são criados uma seção de memória com o nome O. e depois
A chamada das funções do goad1kag é

C Registro O, como um VNO (Vogzheg Nergheg ozes?) Ou como
O plug -in do processo confiável.

Os dois primeiros métodos com exemplos são descritos na seção."(Running Moay Kooi". Em Dan-
Somente as técnicas mais comuns estão listadas, em
Na verdade, existem muito mais deles - cerca de 15 métodos de implementação são conhecidos
OA.Em processos avançados.

Portanto, o moderno \ ai deve conter um subsistema de controle
Componentes de LA carregados na memória do processo confiável.

Metodologia de proteção: como regra, a proteção é reduzida ao SO -Challed
“Controle dos componentes” do aplicativo, ou seja, compilando a lista de uso
O aplicativo by1.1.e a emissão de avisos em caso de aparência no
Stump o processo confiável do novo 011. que não está nesta lista
(Fig. 2.12).Para reduzir o número de trabalhos falsos, pode
Verificação de assinaturas digitais de bibliotecas (para excluir a reação
em O. sistêmico) e integração do RTEM |com antivírus para detetive
Bibliotecas de Trojan.Além disso, para algumas técnicas para implementar
Oi.Um registro é necessário em memória do processo, que também pode controlar
Despeje \ ma |.

Metodologia de teste: implementação na memória de um aplicativo de amante
terceira partia osh.vários métodos e observação da reação dela.
Durante os testes, você deve prestar atenção ao fato de reduzir

pagina: 176

170 CAPÍTULO 2

O número de trabalhos falsos desenvolvedores de alguns EPE \ ma |Nao vejo
Bibliotecas de "forasteiros" derretem carregados da pasta de trabalho do programa
Nós.Além disso, deve -se levar em consideração a possibilidade de mascarar a biblioteca com
O uso da rutkin-technology ou o método de modificar estruturas do sistema,
descrito na Listagem 2.47.

A

Atenção: Alguns nomlponents mudaram

A agulha do ECHR_NET (nenhum programa shinonian foi encontrado]
O processo refiliza o acesso à rede

Um Ilya vários componentes deste aplicativo mudaram se você
Não tenho certeza da regra dessa alteração, clique nos detalhes para
autentos de componentes étnicos

Vira Genna OMC
{© para costurar informações para este componente
Sobre Adicionar o componente alterado à lista de gerais

C com uma mudança no aplicativo até que seja reinstalado
Devabiev

2 SAM 5 \ TETER
eu como

Arroz.2.12.Exemplo de promoção de subsistemas de controle
Os componentes do Rgemla!$ 12.}] rd

Criação em processos confiáveis
Trojan flui
O método é suficientemente simples e se resume à introdução de um processo confiável na memória

CA do código de software com o desafio subsequente das funções do Sgeaechetosetgea "
por sua execução em um fluxo separado.

pagina: 177

Programas e princípios maliciosos de seu trabalho 171

Metodologia de proteção: a couve deve controlar essa operação e
ou bloqueie -o ou considere a cópia do processo não lançado com
A introdução do policial de um fluxo estranho nele.É desejável não apenas consertado
dê o fato de criar um fluxo, mas também registre isso
Operação Apêndice LLL da análise subsequente.

Metodologia de teste: Criando um Triang
fluxo que executa a troca com a Internet e monitorando o reacionário
Seu eema |.

Modificação do código da máquina
processos confiáveis

Este método é frequentemente usado por rotas.A essência do método se resume a mod-
Fixação do código da máquina do processo ou das bibliotecas usadas por ele.Como
regra, antes que tal modificação na memória do processo seja introduzida
Código dos pneus de interceptores e intercepta várias funções, com mais frequência
Funções totais de bibliotecas \/$ 2_32 e chip.

Metodologia de proteção: bloqueando a modificação do código da máquina de confiança
processos ou registro deste fato, após o qual modificado
O processo é considerado não lucrativo (Fig. 2.13).Ao escolher um mesemai, vale a pena
Coloque atenção em como rastrear a gravação em
Memória de outros processos.O fato é que geralmente para esse monitor
O anel é usado para interceptar uma ou mais funções em chzegmod
ou kiglemoda, portanto, a restauração de funções interceptadas
pode desligar a proteção.

+ © componentes contadores
A Network foi para Ehreona.

Yu 9.Como sua área de memória
foi alterado por outro processo

O processo de Art Yeha fez um recorde.V
A área de memória

Girnal

|C] Não mostre mais esta janela

Arroz.2.13.A reação do Oshiri EGEM/A!para modificação da memória
Processo confiável oshroz {3./rd

Metodologia de teste: iniciando o processo de confiança, modificação dele
Código da máquina e observação da reação de Riga \ Ma!.Como um teste

pagina: 178

172 Capítulo 2

As aplicações podem ser qualquer um dos exemplos dos rutkitianos ts5eg de moda,
Anteriormente.

Camuflagem do processo não intencionado

O nome da metodologia realmente descreve seus princípios de trabalho.Não lucrativo
O processo por interceptação de funções, modificação de dados na estrutura
Tours of the Yrvosez $ e o rugido produz camuflagem de seu processo sob confiança
processo (por exemplo, o processo de navegador).Se \ maio for baseado em rd
processar e recebe o nome do arquivo executável através do sistema padrão
AR! -Fuções, então ele estará vulnerável a essa manipulação.Quando
Implementação nos processos de Trojanskaya 01.1.seu disfarce para
Rutkutka-princípio do sistema de controle de componentes incorporado no eIMAP
formulários.

Metodologia de proteção: a técnica mais simples e eficaz é
Registro do lançamento e conclusão dos processos, o fato de carregar/descarregar babador
Liotek e uma comparação de dados obtidos dessa maneira com informações,
obtido através de funções AR1 padrão.

Metodologia de teste: o programa do testador deve ser disfarçado
processos e bibliotecas carregadas de uma maneira ou de outra
Bom, então a reação do epemai está sendo estudada para as tentativas de trabalhar
módulos mascarados com a Internet.No nosso caso, como teste
As aplicações podem ser exemplos de Kegpa Rutkin!
Consulte Listagem 2.45).

Ataques aos processos de Rgeman

O ataque aos processos e serviços de rimams no caso mais simples é reduzido ao seu
Pare forçado usando o Techt4 Passerhosezs.Em mais complexo
No caso, uma modificação do processo do EPEM!ou o uso de exótico
Métodos de processamento para concluir o processo.Por exemplo, o malware
pode descarregar a biblioteca usada pelo processo, causando no contexto
O processo atacado do Etheg1hahu por meio de Sgeaheytostetead.

Metodologia de proteção: o método de proteção mais eficaz é
A marcação do código fundado \ ai em motoristas não lisonjeiros.Nisso,
O chá operando no aplicativo TS5EGM é usado apenas para controlar
E monitorar o trabalho de Epe \ ma!e sua parada não afetará o trabalho de proteger
Você.Como medidas adicionais, a proteção da gestão pode ser aplicada
o processo ou o monitoramento de seu desempenho.Em particular,
Alguns eema |Bloqueie uma troca com uma rede em caso de parada forçada
processo de controle.

pagina: 179

Programas e princípios maliciosos de seu trabalho 173

Método de teste: é necessário descobrir se é à força
completar os processos dele \ bang e como a conclusão dos processos afetará
O escudo do computador e o desempenho de aplicativos confiáveis.

Ataques a su]!shell de controle

Quase todo o eigema |conter um determinado aplicativo projetado para
Gerenciamento de trabalho Enemaii!E monitorar sua condição.Malicioso
O aplicativo pode imitar as ações do usuário, desligando -o \ May
Ou alterando suas configurações.Além disso, a aplicação maliciosa pode
Registre o fato de criar janelas do sistema de treinamento de egema |- criando
Minha janela pode se tornar invisível e o malware pode ser realizado
Autonetus, botões emuladores e outras operações para emulação
Reações do usuário a uma solicitação.A única implementação complexa de
quem o método é a variedade de variedades de epemai, mas
É difícil formar um banco de dados do tipo "Nome da janela"- "O nome do elemento de gerenciamento
pista " -" ação ".

Metodologia de proteção: Rie \ May deve rastrear a emulação de várias ópera
Qi com suas janelas e outros elementos su] com elementos.No caso mais simples
O fato de enviar mensagens para as janelas de Rie \ maio do lado deve ser gravado
outras aplicações.

Método de teste: o aplicativo de teste emula o trabalho
Usuário com Windows Rimai, por exemplo, enviando uma mensagem a eles
ni.Rima |deve registrar essas operações, bloqueá -las e
exibir um aviso que o aplicativo do testador está tentando gerenciar
Egemai.

Modificação das chaves de registro e arquivo,
de propriedade de e/ge \ mga!

Como você sabe, os drivers e serviços de Egeteman estão registrados no registro.Linha
Malware analisa o registro e destrói as chaves do registro,
pertencente a ele \ mats.Para destruir as chaves do registro, geralmente obtém
Bancos de dados exatamente com os nomes dos drivers e arquivos torácicos.De acordo com
o autor dos programas de Trojan pode conter bancos de dados impressionantes de
NY, numerando centenas de registros, e não apenas para a luta contra Rigem!-
Existe toda uma gama de programas.destinado à costura do com-
Pueter.A situação é semelhante aos arquivos- é ​​fácil calcular
A rima aninhada!Arquivos (especialmente lamers) e missão.Para co-
piedade, muitos bons \ maio estão completamente desonrados contra tal

pagina: 180

174 CAPÍTULO 2

Ataques, que são usados ​​ativamente pelos desenvolvedores de software prejudicial.Em aula
Fixação do laboratório Kaspersky para eles até alocados especiais
Tegoria "Tgodap. Ksha \".

Metodologia de proteção: ou seja, eu deve proteger suas teclas de registro e arquivo.
A técnica pode ser desejada- de proteção proativa, controle
um registro de um registro em tempo real, até o periódico
controle sobre as chaves do registro e a restauração de danos detectados
zelo.Proteção de arquivos contra exclusão e modificação pode ser feita com
usando elementos de proteção proativa.

Metodologia de teste: em um computador de trabalho, esses testes conduzem
não se segue, os testes só podem ser realizados em um PC virtual ou
Um computador alocado especialmente para teste.Verificação desce
a uma tentativa de excluir ou danificar os arquivos pertencentes ao epemai,
Lamentação e modificação das teclas de registro.

Modificação do banco de dados RGEMAN

Quase qualquer eiman deve conter uma base na qual
Sana governa para seu trabalho e pastrocks.Em caso de seguro seguro
O estilo deste banco de dados pode ser destruído, substituído ou modificado
Vana.Na maioria das vezes, dessa maneira, o construído -in em u/tdo \%$ hp está atacando
Eriem'an.O motivo é armazenar a base de suas configurações no registro (parâmetro
EAI1E111 All permite que você ligue/pisque a egemia | e
E1GEMA111RO11S \ 5EAPCHAARGEE11E \ ACEPOG1 GEOR 4AOR] 1SAE1OP $ \ [1 5% de lojas
lista de aplicativos confiáveis), que permite programas maliciosos
Crie suas próprias regras.

Metodologia de proteção: os desenvolvedores da Egemai devem armazenar a base com configurações
de forma criptografada e fornece vários graus de proteção básica -
Criação de seus backups, proteção da base com quantidades de controle, etc.
Ao escolher epemai, é necessário prestar atenção ao formato da base e medidas
sua proteção prevista pelos desenvolvedores.

Metodologia de teste: você precisa encontrar o banco de dados de pista \ a | n e convencer-
Xia que não é armazenado em forma aberta.No computador de teste,
Foda -se a reação disso \ ma!para remover e danificar sua base.

Ignorando os motoristas instalados pelo Rgemgay

O motorista do motorista é uma operação bastante complicada, pois
A maioria dos cortes modernos usa um con- de vários níveis

pagina: 181

Programas e princípios maliciosos de seu trabalho 175
Em nós, e a e bb e la td você

Troll por trás da atividade da rede.Além disso, a implementação de tais métodos
Requer um código de software bastante complicado.No entanto
As implementações são conhecidas e se resumem à instalação de seu próprio MO1 $ mergulhador
(Llya de trabalho diretamente com a rede, geralmente para a implementação desta metodologia
O pacote é usado m!
Pacotes ignorando os filtros Leravers do mapa de iogues.O último método é o máximo
Eficaz contra os mais simples do que] | -filters.

Metodologia de proteção: a proteção mais eficaz é multinível
Verifique, por exemplo, depois!

Metodologia de teste: o uso de utilitários especializados, implementados
Tal metodologia de ignorar os Eemats.

pagina: 182

Capítulo 3

Programas e utilitários
Para o estudo do sistema

Então, no capítulo 2, examinamos os princípios básicos do trabalho da cerveja
programas de denúncia.Devido à sua multiplicidade, o uso de antivírus
e os programas anti -pioneiros geralmente são machmáticos porque
Eles trabalham com o princípio da pesquisa de assinatura e, como resultado, não podem
Detecte novas variedades de programas prejudiciais.Parcialmente dado
O problema é resolvido devido a métodos de análise heurística, mas cedo ou
Tarde, quase qualquer usuário pode enfrentar a situação,
Quando um programa malicioso e a aplicação está em seu computador
Meu antivírus não pode detectar e destruí -lo.

A saída é o uso de vários utilitários para
Sistemas.A maioria dos utilitários considerados não pode detectar
Para dar à luz programas maliciosos, mas permita que você detecte sussurrando
Objetos para análise e estudo subsequentes.Considerado nisso
O chefe do programa não requer qualificações especiais e conhecimento especial,
que são necessários no caso de usar Dizassemblers e depuradores,
E a maioria deles é distribuída gratuitamente.

Utilitários de pesquisa
e neutralização do rutkit

A busca e a neutralização das rotas é uma tarefa difícil, pois
Existem muitos métodos para a implementação de Rutkin e um bom anti -rubsut ​​deveria
Ser capaz de resistir à maioria deles.A situação pode ser complicada
que usando a technologia Rutka, o programa de porte de Vreel pode ser ativo
Mas para neutralizar o trabalho dos analisadores de serviços públicos de várias maneiras.

pagina: 183

178 Capítulo 3

Portanto, é aconselhável ter vários anti-reguladores no arsenal- desenvolvendo
Chiki de vários programas usam diferentes algoritmos de pesquisa e neutro
Levis de rotas, então muitas vezes há situações, KLA One Utility
Não detecta Rutkin, e os outros detectam e com sucesso neutro
lambendo.

A \ y2

Utilidade AUL (Fig. 3.1) não é um meio especializado de luta
com rotas, construídas -in anti -bujas -um dos componentes do complexo
análise de sistema.

$ $ Disco35 a)
* C] Disco de livros (com
® 034} Ouo-Liskod (2)

Procure Royle e Peregny, funções de óxido de AR
>> perigoso
>>>> descobriu o processo do processo 572 NHCH 00 EHE
11 Pobesk Garehvetchikov AR1 trabalhando no Uzammoda
Análise Keta?Oi Tabela de exportação é encontrada na seção (2
Renkynya calle!92 91 Reeraravi (6%) interceptado, o método de AR!
A tabela de exportação ANELIZ EO é encontrada na seção M

Arroz.3.1.Utilidade a \ g, a janela principal

A análise consiste em três estágios principais:

1. Análise do sistema no U5egmod.Envolve detectar a substituição de az "
Funções RESA das principais bibliotecas e detecção de modificação da máquina
o código dessas funções.

pagina: 184

Programas e serviços públicos para pesquisa do sistema 179

2. Análise do sistema em Keta] Moda.Envolve a busca de interceptações por
Abordar substituições no k15t e detecção da modificação do código da máquina
Núcleos para todas as funções descritas na CT.

3. Pesquise a camuflagem de processos e serviços.Em caso de oculto
As informações sobre eles são exibidas no protocolo.

Uma característica do AUI é a possibilidade de neutralizar o detectado
Interceptores.Neutralização de interceptores de Kegpe!Moda e global
personagem e consiste em restaurar endereços em Kizt e restaurar o ma-
Código dos pneus de funções danificadas.Neutralização em O5gmoda
Sobre a restauração do código da máquina de funções e neutralização da interceptação
Chicks trabalhando no princípio de substituição do endereço.

Vantagens:

Da concessionária não requer instalação, ocupa cerca de 1.500 kbytes em um disco em
definido com documentação;

Sobre a análise permite identificar funções interceptadas para métodos padrão
Instale o método de interceptação m (em alguns casos) para detectar o interceptador.
Informações de engenharia são exibidas para funções interceptadas,
com Alres Interceptores;

Sobre o uso de vários métodos de análise aumenta as chances de detecção
Rutkitov.

Imperfeições:

0] A utilidade detecta interceptações, mas não pode julgar seus prejudiciais
Chiqueiro.Portanto, interceptações de funções feitas
Monitores de antivírus, ele pode, monitorar utilitários;

C] Contar o Ket Rutkuts!
que podem violar a operação do sistema como um todo e monitoramento meios em
especial.Portanto, antes da inclusão do sistema de controle,
PE!

Para realizar análises no núcleo AU7, o motorista usa que
instalado e carregado para o tempo do cheque e descarregado depois dele
conclusão.

Considere um fragmento de um protocolo da utilidade da AUI, para um sistema com uma rota ativa
Kitu SukeGreghepdeg (Listagem 3.1).

Pistig 3.4, fragmento do protocolo Au

1. Procure diferentes programas e que interceptem as funções da arte
>> Perigo!Processos descobertos de processos

>>>> descobriu um disfarce do processo 572 nx9zey100.eh

pagina: 185

780 CAPÍTULO 3

1.1 Pesquisar interceptores de arte que são impressionantes em chzegmod
Kegpa Analysis132.911, tabela de exportação de Nitsen na seção “Milestone

Função de Kegpa!
Método ArtSoden1 Zazask.Larto

Análise p5911.911, a tabela de exportação é encontrada na seção.
PTA function11.911: 19G10A901] {70} Interceptada, o método de ArtSoden1ask.Lirto

Função p®a11.911: meskeafe: 1e {123) interceptado,
Método de ArtSoden1] Assk.stoto

Função P911.411: METECH1SOPOSOKO?
Método ARTSODENS3ASK.Lirto

Função pe911.911: msypishchegasekeu (159) interceptado,
Método ARTSOZENZDASK.OTRTTO

Função p®a11.911: meepilegaseua 2keu (161) interceptada,
Método Artsodenn1 Zasask.Irto

A função PEE11.491}: Não.Arto

Função por 911.911: meopargos $ s $ (211) interceptados,
Método ArtSoden: pergunte.MPO

Para salvar o local, apenas um fragmento do protocolo é dado, uma vez que
Reepdeg intercepta muitas funções com um método idêntico de modificador
Estaca da máquina de gatos.A inclusão de contra -ação para os rutetos neutraliza
Naskheeopdeg e o protocolo registra informações adicionais sobre
Seu comportamento (listando 3.2).

Pistmyg 3.2.Fragmento do protocolo Au?E revisão de oposição
Rutvites

1. Pesquise o Aook1 e programas que interceptam as funções da arte

>> Perigo!Processos descobertos de processos

>>>> descobriu um disfarce do processo 572 vhaee100.eh

1.1 Pesquisar interceptores de arte que trabalham em chzegmoay

Análise de Kegpa132.411, tabela de exportação encontrada na seção ".®EHE

Kegpa function132.411: viaya11e (676) interceptado,
Método ArtSoan+Lask.Firto

>>> Código Rutkita na função de veiya11, neutralizado
Análise p5911.911, a tabela de exportação é encontrada na seção.
A função de P & 911.911: 1AT10A9011 (70) Intercepted, ArtSoden Method) Ask.Rtto

>>> Código Rutkita na função 1agoa0?Neutrovovn

pagina: 186

Programas e serviços públicos para o sistema de pesquisa 181

PSA function11.911: MesgeaseEg11e (123) interceptado,
Método Artsoden1) Assk

>>> O código Rutkita nas funções MesgEASEI11E é neutralizado

Análise OG] POP ​​91], a tabela de exportação foi encontrada na seção.
Análise de Pefao132.411, tabela de exportação encontrada na seção Kekhke
>> Perigo!Camuflagem descoberta de serviços e motoristas no nível da arte

>>>> Suspeita no SovekiGreGopaEG100
S: \ szee \ phdee100t \ nhase100.eh

>> Perigo!Descobertos serviços de mascaramento e motoristas no nível do registro

>>>> suspeita sobre whookk1 e succegegegegegeGeneg100
C: \ heze \ vhade100k \ rdde!

>>>> suspeita em vookz+ naskegegeneepayehg0su100
S: \ E5*\ VHED! 100: \ rhdeaaku.Zam

>> Perigo!Processos descobertos de processos

>>>> suspeita de disfarce do processo 572
S: \ hedgehog & \ nhade100t \ no mesmo100.eh

Como pode ser visto no protocolo, a neutralização dos interceptores da rotina permitida
Utilidade da au, descubra o fato de camuflagem de serviços e motoristas, bem como
Righten Informações detalhadas sobre o processo mascarado na casa {100.eh.Sobre-
O esboço do processo de processo (mais precisamente, suspeita de disfarce)
é dado com base em uma comparação da lista de processos, serviços e motoristas para
neutralização de interceptações e depois disso.

Análise de interceptações de funções modificando o código da máquina em um número
Os casos permitem detectar o interceptador.Um exemplo de um protocolo para demonstração
O exemplo racional do capítulo 2 é mostrado na Listagem 3.3.

Pistimg 3.3 Subtit da detecção dos perbpes liquidados
Drapera Ucodgumu

Fiscação 2MSGEAKE11E (25) - Modificação do código da máquina.
Método da farmóia \ ?? \ s: \ feses \ tecidos.

A busca pelo interceptador neste caso é realizada analisando o que
O módulo núcleo indica o endereço extraído da equipe EMR.Uma pesquisa semelhante
Nerepchler é possível apenas em caso de transferência de controle do famoso
AU7 com um conjunto de comandos (5 \ r, renate + veter
O corpo de um dos módulos do espaço do núcleo.

pagina: 187

182 Capítulo 3

VO!

A utilidade de Voozhikuyeg (inr: // mchi.
Mark Russinovich permite procurar arquivos mascarados e
Chaves ocultas do registro (Fig. 3.2).O princípio do trabalho de cozinha é baseado
Na leitura direta do disco (os dados de Maye, o TAI (RM), Mtez-
volumes e estruturas de catálogos) e uma comparação dos resultados obtidos do dado
Mi voltou através do Arg.Discrepâncias descobertas são registradas em
O protocolo indicando o caminho completo para o arquivo, seu tamanho e notas.
Uma operação semelhante é realizada com o registro - o utilitário remove o despejo
registrar componentes e analisar seu conteúdo, comparando os obtidos
Na maneira como as informações com dados retornados ao padrão AR |-

funções de trabalho com o registro.

5 Ben

Cindle Sora, 99 faslrep na parte inferior

Arroz.3.2.Ros1kyeueEg, a janela principal do programa

Vantagens:

Do utilitário não requer instalação, ocupa cerca de 350 kbytes em um disco em

definido com documentação;

4 NOD KIR STA A -G -BUBUGIAYA NO IN -BUZIMEGAUSOG

`Em Timal |Para# |HAPDINais.
Nk msuzemom \ solo e ol ss “mkit) - 05 02.2006 20.39 - Pbuyavz Notas NOTAS APA
Eu conheço Chu Stoem \ Salt 00 \ Sopnobavevo \ mevni - 05020052039 sobre?Nom \ tao
Vnka mae somem solis aab oo zbast em 05.02 20852039 - Comitê executivo central nodepnot yo
Verdadeiro mazuzem \ sopvo 6 = oe gye \ os ebasu on.05022005 2033 - OIZE NAZEP NÃO AI
29 RELAÇÕES DE TEMES NANA 5 EGISosis \ Sosio IT 02/05/20062833 - PAIZA NODEL DEUS OU
3 N. MURUSTENS \ SOPIV 0 \ ZAGISOKH \ WALLET.05/05/2006 2039 - OIZEIZ NILEL PLAPA
SES Maid de por volta de 05022005 2039 Aquzz nyubetoga \ ie
5} com uma verificação de esqueletos о0ajes 00 ek 06.22 2006 2039 250. - Nedepiol \ ilDO
US $ 2 com Madridey, ambos lamentares 06: 2 e 0502200652039 383. Nudotnot \ Itaa
UE chen \ nhdap oo \ ritsa 1 ooech 85022006 2039 630 nidepyod ido
Bigode no NHDD LLP 05022008 2039 402. NADALNOT \ AMIA
3} SAO NYAZA OYADEVM ZU 05022005 2039 325. NFP POTI
UE Cheya \ lu para 00I6i53100 VNA 05022200520393 480. Niodepot "Inda
® Slience Vyumemdzdes 4 02/05/2006 2039 363. Will Will Will
® Smzky Vegadwel V VA 05 0220052039 358 Eu coloquei notas

SAS Ignid OBAIS 02.02.2005 2038 Ambos

{1 com Meslhda ooayai dr 05 02220062039 32. Nickle Mia.

pagina: 188

Programas e serviços públicos para o sistema de pesquisa 183

A análise G não depende da metodologia da interceptação e conjunto de função interceptada
CII.Além disso, a concessionária detecta o mascaramento das chaves do registro, não
Infusive na interceptação de funções (por exemplo, registro chaves com símbolos
#0 No nome invisível através de um editor do Fistard do Kevy Register).

Imperfeições:

Com a principal desvantagem - o utilitário voará apenas o mascaramento de arquivos e
As chaves do registro.Outras manifestações das tecnologias Rutte (por exemplo,
Acesso iminente ao arquivo, rastreando arte, disfarce para
Cessões e motoristas, etc.) não detectam;

P A utilidade é uma ferramenta puramente analítica e não tem os meios
a contra -ação dos Rutkuts;

SP Quando detectado objetos ocultos, não se sabe qual método está oculto
o objeto e se está oculto em tudo- o utilitário pode dar falsos shabbits-

no caso de falhas de disco, levando à inacessibilidade de
Nogo ou vários arquivos.

Um fragmento de um protocolo do utilitário Cookiekeeg para um sistema com tapetes ativos
Kitu Naskegoyepdeg é apresentado na Listagem 3.3.

: Listagem 9.3.Fragmento do protocolo ‹ikikeuenyug
Nkgm \ uztom \ sopsko1 5et 001 \ sopeco: \ zeyevso \ m1p1t1 \ nasklyeepdeg100
05/05/2006 20:39 0 RUSEZ N) @AEP EGOM Repdom5 Art.

Nkem \ 5UzMom \ SOPENA15ES001 \ SOPEA1 \ 5EUEEVOOKOOOH \ MEMOMOGK \ NaskoGoEpePDeHg100
05/05/2006 20:39 0 BUZEZ N1YAZEP YOGA e 1PAM $ ART.

Nkym \ zu 5 \ sopto1 $ e5 001 \ dreat \ vo \ tesasas Naskoyemoyemev100
05/05/2006 20:39 0 Bueza Nayaap Evam e1Paomz Art.

Nkem \ zuztem \ sopea15eta001 \ epii \ kose \ hesasu naSheaooookemerkova100
05/05/2005 20:39 0 Bugze n1aaap yoga itpaomz art.

Nkim \ zuzem \ sopena153e001 \ $ esusez \ sokegegegelel4eg100 05.02.2006
20:39 0 Buseyz n1adepe Heg \ 1pamz Art.

Nkhkhm \ 5udem \ sopsgo1 $ e001 \ 5eg3Seza \ Naskheeopdek0gu100 02/05/2006
20:39 0 BUBEZ N: @AEP END I1P@OMZ ART.

S: \ szee \ bdee10005.02.2006 20:39 sobre busezheaap eho ifp@aom5 art.

S: \ szee \ hite100k \ 69 <14100.eh 05.62.2006 20:39 26,00 kV
N1chdep ego e bechomz art.

S: \ szee \ rchdee100x \ nhade100.2.111 02/05/2005 20:39 3,83 sq.

Com m1pamz art.

S: \ szee \ nhase100: \ rhase! 00.eh 05/05/2006 20:39 69,00 kV

H1@depp occh@it $ “$ art.

pagina: 189

184 CAPÍTULO 3

Neste protocolo, podemos fazer uma conclusão inequívoca de que
Máscaras de arquivos na chave de disco e registro são encontradas.Uma medida de combate
Pode haver uma impressão de protocolo, carregando de carregar SR ou
Conectar um computador estudado a um computador, que é considerado
É "limpo" e a pesquisa de arquivos descritos no protocolo.

Em uma nota

Muitas rotas, incluindo pólos de Nashkegoye e seus clones, podem mascarar
Quaisquer arquivos, pastas e chaves de registro para uma determinada configuração.Incluindo
Telly, um disfarce de alguns arquivos não pode servir como um crítico inequívoco
sua prejudicação.

Vaskuai

Utilidade Vasky!
Constantemente atualizado e finalizado.A versão mais recente do utilitário
pode ser encontrado no site do desenvolvedor no endereço nº RR: // mmm (-ocm.

Máscaras.
Santo
Camarada

P Ber 2 - Village

Você!

A máscara da web dela>

Vedas

Chamando

5er #- Ceal do todo

[Vovk UTIA]
$ SHA: B |Entre |Aldeias]

Arroz.3.3.Vaskyam.Janela do programa após a digitalização

pagina: 190

Programas e serviços públicos para o sistema de pesquisa 185
Você é AO

O princípio da utilidade é baseado em uma análise do sistema de baixo nível

Para identificar processos e arquivos mascarados.O utilitário não requer um

Estação, mas durante o trabalho de seu trabalho, ela carrega o motorista.

Vantagens:

C não requer instalação e pode ser lançado a partir de CO ou em \ -diska,
leva cerca de 700 kbytes;

P tem um bom detector de processos ocultos;

[7 fornece a possibilidade de renomear os arquivos mascarados,
rebitado durante a auditoria.

Imperfeições:

N Como resultado da digitalização do usuário, não recebe um Technical In-

Uma formação que nos permite julgar os princípios do trabalho de Rutkin, Interchang
funções ou estruturas de kernel danificadas;

P O utilitário detecta apenas disfarce de arquivos e pastas no disco e
Processos de filhotes na memória.Todas as outras manifestações de Rutkin-Technology
Logii não são detectados.

Os resultados do sistema verificam a duplicata do utilitário no protocolo de texto,
Que é criado na pasta de trabalho do programa (Listagem 3.4).No protocolo
Algumas informações técnicas sobre o trabalho da concessionária são exibidas (em particular
Estil, a versão do sistema operacional e a versão de você se morde) e dados
sobre todas as anomalias descobertas.

} Naskogo Ev Dog

02/05/06 21:18:30 [Tao]: B1askane Epd1ta 1.0.30 111531a12ea

05/05/06 21:18:30 [TPEO]: 08: 5.1 Base 2600 (US $ 5 egufsa 2)

05/05/05 21:18:31 [Moga]: 7019 4

02/05/06 21:18:31 [Mine]: 7005 0

02/05/06 21:18:33 [Mine]: 7006 0

02/05/06 21:18:33 [Mosa]: 7011 1180

62/05/06 21:18:33 [Mose]: 7018 1448

52/05/06 21:18:33 [11050]: n1aaep rgsezz: c: \ hez5 \ vhaye100t \ vhchee100.eh
05/05/06 21:18:33 [Moy]: Vyvai 11 Ygagu Hegz1op 1.7.1014

05/05/06 21:18:34 [Print]: h@adep e11e: с: \ \ \ \ in theHada100x \ bass12100.
02/05/06 21:18:34 [Mosa]: 10002 3

05/05/06 21:18:34 [tpao]: nzadep yee11e: s;\ Kezt \ vhase100x \ nhase100.2.1101
05/05/06 21:18:34 [Mine]: 10002 3

pagina: 191

186 Capítulo 3

02/05/96 21:18:34 [Tao]: Naadel E11E: с: \ ghese \ bhdee100x \ fase100.eh
02/95/06 21:18:34 [Moseel]: 10002 3
05/05/06 21:18:34 [TPEO]: H1@EP E31E: с: \ tezt \ rchdee100x \ nhte100.171
02/05/06 21:18:34 [Mosa]: 10002 3
05/05/06 21:18:34 [T1PEO): The Nyadeping: с: \ SEZE \ BHASA100X \ Na casa.Zam
02/05/06 21:18:34 [Mosa]: 10002 3
62/05/06 21:18:34 [TPEO]: nfadepa #11e: C: \ SEZE \ NHDEE100G \ High $ 100.EH

Opnaskmmma

A utilidade do Opnaskma (Fig. 3.4) é um detector comercial dos Rutkuts,
IA | -version está disponível para carregar no endereço NIR: // lii \.Ipvaskte.mel.

Upnaskma um bigode
Pete Ovplenaya 4 Tibag da borda - ka
Tgorvia (Beek]

TEDA: risosaine fez, estou vindo para Komi
Desu Pati Oil University
E
Revalle Rue Slitrishai Ap Vistusgh
SV No. 2

E um
OD SK

Tne Zaorra Thomeal uma vila de Reza
Yulaye

1 irya Osa como nabva daa 07
Vetamay Rnosepheye

1. suco al -eur bóia com ele com muitos
2 Vedas!dr

3 wamaski suponia u, ovoel> então
E

\ Uac baue ev av] 0 foda
Honazaga

545 Heroes BA Decret

Arroz.3.4.Ipnaskma, janela do programa após digitalização

pagina: 192

Programas e serviços públicos para o sistema de pesquisa 18;
Du

No decorrer de seu trabalho, o utilitário carrega o motorista usado para conduzir.
Análise na moda Keta.

Vantagens:

Com vantagens especiais durante os testes, eles não são privados, mas o programa é executado:
As funções declaradas pelos desenvolvedores são NACHes.

Imperfeições:

Com a entrada dos testes, verificou -se que este produto é relativamente ruim
detecta rootkuts- apenas um disfarce claro do objeto é detectado
CamaradaComo um experimento, um exemplo do capítulo foi definido como o sistema.
(pastas de mascaramento e arquivos com o nome "goo \ zh" devido à interceptação da função
qiy no ozigmod), um exemplo semelhante de base na modificação das máquinas
O código nuclear do núcleo e do CE Komka.Mas este produto relatou que no sistema
O tópico está bem;

OP requer a instalação, o que dificulta o uso no curso do Express
Processos do sistema,

0 é um produto comercial (a opção mais barata custa US $ 19),
Mas em termos de funcionalidade, ele perderá em comparação com e livre e
Histórico.

Re -\ ki Nookk Apa!

Utility Koski Nook APA |
Programas - No.@P: // uuu gingsopodeptus.O tamanho da distribuição é sobre
1 MB, o programa requer instalação.O princípio da operação do programa
Pavan em busca de interceptações de funções kezhehu1sebezt1reogta1e
Função da função da função com o endereço de endereços ocupados na memória
P (o $ kgi1.eh. Este método é o mais simples e não permite a recuperação

a função interceptada, já que seu endereço "correto" permanece
Vesny.

Vantagens:

C Não foram encontradas vantagens especiais durante os testes.De fato, a utilidade é
É um analisador de endereços na tabela kist, não anti -rubsits.

Imperfeições:

C é encontrado apenas um tipo de interceptação - modificação do endereço em
Kebuga` Sepessgzreochta1e;

Sem como restaurar funções interceptadas.

Na fig.3.5 mostra a janela do programa depois de digitalizar um PC com um negligenciado
um exemplo do capítulo 2, que é interceptado pela função usando

pagina: 193

188 Capítulo 3

Modificações de seu código de máquina.Como pode ser visto na linha de status, interceptação de
Eu estava despercebido.

> __ VOKYA SOCK APAYUTET 1.01 Vir-/aumi geesreleles.mel

|Belikalyavin.
Não.
Nosov Sneskaloa Art #reldsev.Mozolueno
Massa »Sonneskvutir 7 7ldSsezzlovut.Parzkeya ehe
Magrasorase # Massas Square, uma Ana
NÃO -CHUMILUTURAÇÃO MASSE -CHUMIDO 7 2YASASSIS.Marcos do taoísmo
Yukaszhezgleskvuturez e ialioaa ata.Voye Hedgehog
Yulsezpzvurapaz/ adicione alet.Gloskg-Eke
Grudia aya, aoki 24
Maz Sturls # Ore Avoya Pu Psk ehe
Mazeistorstami {Ra Atom Current Poses
Nari All Tokeg Guide Teaszto T
Kaeprazitlet não /ridenavite gaa4 “Dovkiky ha ha ha ha ha ha
Srump 7 livrar no note gazok-] vhv
Mesa Osa Gisnna Me / Osa Osa .. Guoktyye
Naosaa Ze Bottom Sararasre /Dmayusam Zat Gk Evo
Ace Qi a Riyusai Ts Gvhe
Mos Ani Metou # Dibbosoy Mind .. PokPueyaa
Mgm ara errado -trebet / siimarraae A. izovkin ela
Nzzkuirosoa para Tecess / Dibenoprus.Gaozkg]
Mascai / sa asskuvli a aplica

W: =
ir
ir
Por
Por
ir
ir
ir
Ty
ir
E sobre
ir
Gu
Gi
E sobre
Ty
Por
W: =
ir
Por

Ner _ |G "bo aokya zegika ode

BP, vá AA Soku Goga

Arroz.3.5.Nooki Toe Alagole,
Janela do programa após a digitalização

$ $ \
Utilitário 5 $ \ é um analisador gratuito, o site do desenvolvedor é
Gramas - No.@P:/Lauthman $.

Vikochka).Não requer instalação, o tamanho da distribuição é de 50 kb.
Vantagens:

Oh, a concessionária é fornecida junto com os textos iniciais, o que permite
a necessidade de realizar sua depuração ou refinamento;

Sobre a análise do uzegmode e Keta [módulos M4 com a possibilidade
Restauração de danos detectados.A utilidade forma o todo
MA Protocolos informativos que permitem estabelecer o método de n@-
Rezch;

pagina: 194

Programas e serviços públicos para o sistema de pesquisa 189

C) No modo núcleo, o utilitário verifica não apenas Shozkgp |
Kegpe!MODO DO MODO: Y915K.
A. UB.

Imperfeições:

C) A utilidade não detecta a interceptação do CH5GMODE realizado pelo método
Abordar substituições.

Para iniciar o utilitário, você deve especificar um conjunto de parâmetros.Lançamento do utilitário
Sem parâmetros, ele traz um breve certificado.Para estudar sistemas
Os tópicos são recomendados para aplicar o seguinte conjunto de parâmetros:

Zu.ehe Skesk /m /s> heróico.heh

Exemplos de protocolos de utilidade são mostrados nas listagens 3.5 1 3.6.

Listagem 3.5.Fragmento do protocolo da utilidade 53 Por exemplo, kit
Nyurevka modm fikatsmey kgzt)
3%804E4E4E94 [K1BeH1Setta1e [37] `4 contas [h):
K1beku1set51e Nook:
A9YATESZ 0HA7S27990 13 11514E CCAG.
Tahdee vá para Rafn: \ 2
E11E: A5 E5 57 80
Peletogu: 00 70 S2 E?

Deixando1s = 2

Como pode ser visto na listagem 3.5, o utilitário detectou a modificação
K1BEG1SETA1E, mas não determinou a função (apenas seu índice é exibido em
Ct).Para determinar a função pelo seu número, você pode aplicar a tabela
Funções do Apêndice 1.

Pistus 3.6.Sofra o fragmento do protocolo!88U para o exemplo do Código Civil?
modificação de interceptação do código da máquina)
0x8957e5a5 ($ ecsfop ras) [mesgeakee11e {} +0] 5 bube ($ 5):
EMR1PD SODE (3) PR Yo: Oh?
A99 GIZ $ A7Y $ 35 $ ZPZZAI GKKAGA.
EATOEE SUBUN] E RAEN: \ 22 \ E: \ Gkkio \ va1ez \ ckagu.su $
1] E: 86 dela 55 86 UE
Peshogu: E9 56 7a 65 77

Uega1 = 2

pagina: 195

190 Capítulo 3

Listagem 3.6 corresponde à interceptação da função modificando suas máquinas
Código Nogo.Nesse caso, a função interceptada é definida corretamente,
O tamanho e o deslocamento do código modificado, bem como o método de interceptação.

Utilitários de monitoramento do sistema

A principal tarefa de monitorar utilitários é monitorar o sistema e
Registro de vários eventos em protocolos.Na maioria das vezes durante a pesquisa
Programas maliciosos usam três tipos de monitoramento.

Sobre o monitoramento de operações com arquivos ou operações de disco.
Sobre o monitoramento de operações com o registro.
Sobre o monitoramento da atividade de rede dos aplicativos.

Usando utilitários de monitoramento, deve -se ter em mente que alguns sistemas
A proteção de programas contra hackers e cópia ilegal é considerada
significa como uma ferramenta de hacker e / ou neutralizar ativamente seus
trabalho ou bloqueie o trabalho de aplicações protegidas.Igual a
às vezes pode ser levado para a manifestação de um programa malicioso, embora
É e é tal.

Rimop

A utilidade do inimop (vir: // muuu zuziygp 5.sot/eles não são/eetop. W.
Monitorando todas as operações de arquivo em tempo real
(Fig. 3.6).As principais características da concessionária:

Sobre isso é distribuído gratuitamente;

O não requer instalação, pode ser lançado a partir de uma pasta de rede de
Com;

Sobre o tamanho de cerca de 150 kb;

C pode funcionar em u/pao \ $ 98/2000/xp/2003.Suportado
Plataforma e processadores de 64 bits A.

Além das operações de arquivo E | OMOPE permite o monitoramento
Operações com canais nomeados (Mate R/N/S), MA |$ 1yuyu e rede
recursos.Deve -se levar em consideração que dentro do arquivo executável metop.eh
Motoristas que são extraídos e instalados no momento de seu
lançar.

Uma característica útil do programa é a possibilidade de personalizável
Filtragem de eventos registrados (Fig. 3.7).

pagina: 196

Programas e serviços públicos para pesquisar o sistema

Seu Muyog é uma Buchtress: um ultrassom de Enoikot

=

[Sono comida.
S] suta $ vaso.
1 24135 ve.
G]
Et szgs $
C} Sztez dela
Az -em
ET convocando
C] Sovet
St} omiaz ehe
G "] saeevie ..
C] szkekh
E?Sizrek _
Comeu c518 $ ehe
C3i1x ehe.
[Y] xyazh ehe _
C] sentado ehe_
[1] SZ Hedgehog.
C] szshz.
ST C515 $ HEDDEHOG.
[7]

55
56
67
58
59
70
G:
72
43
2
15

=
|

Yun

Arroz.3.6.

C405E

Orem

@Oevu cherovmap
Voauuu Yirolmatop
Orem

Oren

Soed 1MROMAPAP
Okea \ {Morormaton
Oren

Oren

Doeer \ \ Cheovmal
Okoea \ meonmatum
Orem

Veo

C195E

Oren

Soya \ uerovmatum
Okoea \ sierodmat
Veo

Salo oa \ aospobabagaruuu -
RUE SOBRE SOBRE CHI ZB.
Pathers Current \ Matyznik 9.
Saamoo \ um olho arooe 535 _ |
Demolição Dov Bazagaruuu _
Com Mamos Mio Maliza 96 _
Salo Hazza Abasuugh
Mídia aa saros em \ b6 ._
Com Malcooi AA Seth Basasaros
Samoa \ Mayezi \ M 86.
Samnosua Zzzet Vasas Me 0 $.
Eyu B para "Mata KB.
SALO LAB 5 \ MA-DE AVE.
Samanor \/ condição Mathesv \ -65,
Omi nosso
O próprio Iya Mareche \ evab.
Com aaanob \ e ah \ mangezi \> c._
Sazan Ish Magica \ 85
Demolição de Caresses \ mangyaz \ b86 _
A

Eemope, a janela principal da janela

Arroz.3.7.Configurações de configurações Janela do filtro de utilidade EYMBopic

191

Mais alto
51C7
Ek
Vis

Além do filtro, o item de menu on -line é fornecido, o que permite
Ligue ou desative o monitoramento para cada volume.

O protocolo de utilitário pode ser salvo em um arquivo de texto para subsequente
análise.O separador dos campos de protocolo é um símbolo de tabulação,
que permite que você importá -lo em Mütgoza ehsa |.

pagina: 197

192 Capítulo 3

Vedmop

VELITE VEMOP (em p: // mi \ u. Susicegpa 5.Sot/O sem/coretop.v6]) permitir-
por exemplo, para condenar o monitoramento de todas as operações de registro real de tempo,
É distribuído gratuitamente (Fig. 3.8).A interface desta analogias de utilidade
Chen Rimop.O arquivo executável usa o driver para trabalhar, que
É armazenado dentro do arquivo executável.No momento do lançamento do programa, este
O driver é armazenado na pasta do instrumento e instalado no sistema.Princípio
O trabalho do programa é baseado na interceptação das funções do núcleo, editando o adulto
Corujas em K1ZT, portanto, a utilidade das manchas de Kevmop.
O KI pode ser detectado e neutralizado por anti -russits.Este momento
É necessário levar em consideração durante uma verificação abrangente do sistema -
O utilitário do VEMOP deve ser usado após o uso de anti -rubs.

2 e

B.

Y = um pa [e 'e "em
E Tepe Reva AA!|Rya yu.i => p
#12 745% Azyupu х 1080 ORTEU - NYUSUSYETTOYESO.555641101 .. ZISSA
AI 35 Aitol ECHA-1080-BLGER-NKS \ SGYAOMETUO4RS0 55641101, $ 0SA
434 74579 NEM.Seu 10b0-oretkeu-neisasyay \ el 794150-565411910, mote
8 g.Moter
496 7417425 No. Vartlop EHE1 SOZHEU-NKON \ SYUYCHIT7O4RS0-55541101 .. ZySSA
177 T4ZZUB [I VAZ: EHE 476 Reske em msesovi “Roku $ ISA
74634192] VAVOKE 476 Eaglet - Nemzesiaga aumentou um fundo
145344776] VAZ ​​EHA-476 (YEN-NKMAZESOAI “ROVSU \ SAWMLA ON
440 51004 [Vlzseha: 476 Skzzekeu - NCEMASESIA “AROSUSESBESEE $ ISSE
441 745553 G] VAZ ​​HE 76 OREKEU - NKIM \ ZESING ROB Esoaz 5iiss
442 745359919 G] VAZ ​​EH 476 BUVOUII - NK MAZESIA “AROVAZESEN \ 0 ZISSA
M3 746 G] VAZZ H 476 JUNCO PARA US \ ZESIAP ”E ROSA ZASOS EU ZISSA
444 745491085 [=] NAST;Seu 475 Skokar - Nkm \ Zesuggiaraku Ziss8

Arroz.3.8.Vedmop,
A janela principal do programa

A gravação de eventos pode ser temporariamente suspensa usando o ponto
Menu Tom dela |Sarshghe Cecepv.

Clique duas vezes na linha de linha leva à abertura dos editores
o registro e o posicionamento automático no correspondente
A chave do registro, que é conveniente para análises detalhadas.Como no caso de
Endop, protocolos de utilidade podem ser salvos em um arquivo de texto com
divisores para análise automática.

pagina: 198

Programas e serviços públicos para o sistema de acompanhamento 193

Em uma nota

O utilitário cedeop é muito conveniente para encontrar programas que modificam o
os parâmetros no registro.No entanto, ao aplicá -lo, é necessário aprender
que muitos programas maliciosos podem detectar a presença
Vedmop pelo nome do processo ou pela presença de um driver característico.

Isso] eles dizem

Utilitário tomop (não p: // muuu zuzuiye 5 berço/escritório/tamop.vn)
É indicado para monitorar a atividade de rede dos aplicativos (Fig. 3.9).Nela
O relatório é registrado pela troca de aplicativos para protocolos de TCR e UBR.Chato
A LITA não precisa de instalação e pode ser muito útil para
Detecção de programas liderando uma troca oculta com uma rede.

Purlock - Zuzitpan Mriy Zuzidegoa San
Fe Em Sariay Oraus Nar

e <c +7 em

001519535
0,51557753
051515555
0 06575154
Com osbze6les
006525858
067356242
0 69527931
Ozebe5
04 - AH

10. 25270 = 23

Raya Ga Tash - G A
10R 1470010
Tsor 147 ©% ke ":
(021270

Zearizai Xe 112 Blois
1 -GyDropai 22112 Vtubalv
Ringen 12 112 817104 "8
Earua seu 112 61710418
EHERY EHE 112 817410
Ecridre ru 112 1 7a1v
\ Ruma seu tt2
Echruoae EHE 112 81710418
Zusvon: VHA 1004 - 81545090
Zuovo!fora: 1004 - 81548090
ES VE 1004 - 815648030
Zuloya Call 1004 - 81548030
Zusvoi ehe 1004 - 81548030

91525550

Exigente de 112

Seus nós 1604 - B7laai

BP_M3 Neve

Você, 5et_ment nós!Ea
TR!$ E_e \ emitch
Tv zet_e \ emt_namoaea
Esse Bysau Romeo
T_ochkom cupiava Pon
Goy_ bi -ohm em pom
Então isso

!
1ar_n/ ormos Domnoye
1ar_m/_seis sota
1ar_m/_beye_ oomvs
1ar m) Bomee_ Somtyasa
R.m) _reku_
Yar M!Svvuk- _sinta:

That_o_oataoan
QUE!<Emo Satuaram

Arroz.3.9.Utilitário tomop

102,0 000.102

12?001 163 |

PR 172 39107 28138 17220 No. 72

O princípio de operação da concessionária é baseado no monitoramento de pacotes 1VR,
para isso] -Diver.Isso significa que o utilitário não registrará o
KETA transmitiu ignorando a interface TO1.Caso contrário, trabalhe com isso!
Semelhante ao trabalho com o utilitário KeyAMOP.

A utilidade tem várias vantagens:
O não requer instalação;

pagina: 199

194 Capítulo 3

O) No protocolo, a atividade da rede está ligada a processos específicos, que
Simplifica significativamente a análise;

Sobre um bônus não é um sniffer e registra apenas a troca de lançados
Aplicativos de rede.Portanto, o uso dessa utilidade em
O ambiente corporativo não causará reclamações do serviço de informação
Segurança mágica.

Tsr \ meme

A tarefa de tcr \ iu \ (vr: // rem. Zuzesiyegp6. "Col/ter/termo \ uem. Wat) é
Exibição da lista de portas escutadas de TSR e OTR, bem como a lista
formações instaladas no protocolo do TCR (Fig. 3.10).A concessionária não é necessária
Instalações, o tamanho de cerca de 100 kb.

Não. Tsyuim - Zuzniegpans;Mumu
Seja OUGEGS Vousevsz
Wa- p

Rosvza ›Risdoso!(Wasp! Aveta Adate é aqueles emo

|Vumeg R: OSV] em Tsr Kr Ooozhtest Atovia .. PMA MAT
E] 20 ex6 1744 ter 1 kr 1027 iv kr 0 do temmo
[4 bazs vk 572 ou machiki “

G] Bazz EKE 572 TSOR ZETKR 4800 ^-

Ra] zubrodene 1004 io?TSE XP 1625 CHI

7 em camada Ek Lom Pore Verta 75

24] Zusnosg Ana 1004

2 ZISRO XE 1120 NOR BLL: 1025 -

[-] Angry Ek 1700 sr iza xp 1900 `-

[1 ZMERACHAI-1200 ou XP 900-

(7 sseniya ien 944 tsr shepormartar - zlapcro ibtammo
1] Zunagi 4 Tsrsi Toruster-de para KR 0 de Iztotamma
[7] Zet 4 TCR Poethy South.Bolo 0 é iutemnyb
|.

G] bint ycbr yekropeskonyd: - "
C] Haverá 4 ladrão com uma balsa de k-te ""
] Trabalhando em iza ur pevnyuz-9.

Arroz.3.10.Tcr \ iu \ m, a janela principal

pagina: 200

Programas e serviços públicos para o sistema de pesquisa 195

Um recurso do programa é a ligação da porta listável ou
Abra a conexão com o processo que o usa.

A lista de portas e conexões é atualizada automaticamente com personalidade
velocidade, entradas novas e excluídas são destacadas em cores para a conveniência de
Sumorning in Dynamics.O utilitário de Tsru \ m é muito conveniente para a busca de programas,
DIFERENTE BELL-FO!E zru \ aga.A utilidade tem várias vulnerabilidades, que
O centeio deve ser levado em consideração ao usá -lo.

Com a detecção do fato de ouvir um determinado porto, não significa
E, que esta porta está ouvindo o protocolo TSR \ y!
grama.É possível que no espaço de endereço especificado no protocolo
O processo criou o fluxo de Trojan ou o código da máquina do programa
se encaixa na memória, ou no espaço de endereço do processo é carregado
Biblioteca Trojan.Técnicas semelhantes são frequentemente usadas para desenvolver
Programas Chiki Faskaog, que permite complicar a busca por maliciosos
Programas e, em alguns casos, ignoram Roma |Devido ao trabalho do contexto
processo legítimo.

A partir da concessionária não tem proteção contra as rotas, portanto, recebido
Tsr \ e \ Os ​​dados podem ser distorcidos como resultado do trabalho de Rutkin.

Sobre o uso de wa \/ zosk {ou outros métodos de troca de baixo nível
A rede permite que você organize uma troca sem ouvir óbvio a porta
ou estabelecer uma conexão.Para detectar essa atividade
é necessário usar isso] phop e sniffers (consulte a seção "" sniffers "
este capítulo).

Utilitários de controle de automóveis

O principal objetivo das concessionárias desta classe é procurar programas e biblions
Texto gravado por vários métodos no início automático.Parar
A utilidade tzsopy8 não é recomendada para esses fins, pois
Analisa um pequeno número de teclas de míssil automáticas documentadas.
A prática mostra que os desenvolvedores de malware estão tentando
Aplique a utilidade TZSOPY8 pelas métodos de Tzsopia.

Ashchegip $

Ashchogip $ (Fig. 3.11) é uma das melhores concessionárias desta classe
SA.Distribuído em duas versões: na forma de [-Application and Console
Noah-analisador controlado pelas chaves da linha de comando.Volume
Cerca de 260 kb, o endereço do programa na internet: bp: // muito.
Eles $/Ashugip $.Ter.O utilitário não requer instalação e pode funcionar em

pagina: 201

196 Capítulo 3

Qualquer versão do UMPO \ 5, incluindo Ulpdoch5 XP 64-6 Eanyup e Mmpaomz ZeGueg
2003 64-5 EasyUp.

MO MT TS: Ohm M - Mono Sogroeadkt
Hora do escritório para GE _ Corporation Microsoft

Arroz.3.11.Utilitário acyugip $

A utilidade analisa dezenas de diferentes métodos automáticos.

O Métodos clássicos de lamas automáticas (chaves do registro VIP VIPOPSE, pasta
Carga automática e vários outros menos conhecidos).

Sobre a expansão do condutor de vários tipos.

Você está procurando um echrugeg de expansão (VNO, barra de ferramentas).
Da tarefa do planejador.

Sobre serviço e motoristas.

O Provedores 1.3a.

Sobre a biblioteca de monitoramento da imprensa.

O Provedores de Primzosk.

Sobre a expansão de Ulpyurrop.

pagina: 202

Programas e serviços públicos para o sistema de pesquisa 197
E Br Bl Bobs liderou ooo sobre LLC em

Esta lista lista apenas os principais tipos de lançamento automático, rastreamento
ASHOGIL 5 UTILIDADE.Para cada tipo de venda automática, é fornecido para
Alvenaria contendo elementos relacionados a ela.Além disso, encantos
Observando a colocação de Eueguyia contendo todos os elementos detectados
Automóveis.Cada elemento do lançamento automático pode ser temporariamente desconectado
Ou removido.

A concessionária tem vários úteis para pesquisar o sistema
Ção.

0 Nas configurações, a opção não é para Megoza Epbtaz.Inclusão
Esta opção é ativada pelo filtro na presença de elementos carregados automaticamente
assinatura digital M!
É que reduz significativamente o tamanho da lista e simplifica a análise).

N Clique duas vezes com o botão esquerdo do mouse em qualquer um dos elementos Autose
Iniciar leva ao lançamento do editor de registro e posicionamento em
A chave e o parâmetro correspondentes ao elemento de risada automática.

0 O menu de contexto permite remover o elemento, copie os dados em
Ferment do trocador (o ofício dos campos é um símbolo de tabulação), execute
Pesquise na internet com o nome do arquivo, ligue para a janela de visualização
arquivo tobat.

0 informações sobre os elementos encontrados do início automático podem ser salvos em
a forma de um protocolo de texto (seu | zaue) e depois compare com o sono atual
Skom Automobile Automobile Elements (seu | SoTrage).Descobriu discrepâncias
se destacam de cor.

Em uma nota

A possibilidade de comparar a lista automática atual e preservada anteriormente
O protocolo não está focado no certificado, mas, no entanto, é muito útil
Noah para um administrador e usuário do sistema- você pode salvar
TOCOL após instalar o sistema e todos os aplicativos básicos e depois os períodos
É para comparar a lista atual de automóveis começando com salvo anteriormente.Análise
Adicionado ao carregamento automático de fvilles será rapidamente detectar prejudicial
Programas não -NOSE.

Apesar das amplas possibilidades, este programa tem um ryal
restrições.

Com a ausência de oeste das rotas é a principal desvantagem disso
programas.Como resultado, uma raiz bastante simples e comum
(por exemplo, Nasklyeoptdeg e seus numerosos clones) podem ser bem -sucedidos
Mas mascare suas chaves de lançamento automático por interceptação de AR |-
funções responsáveis ​​por trabalhar com o registro.

Com muitos programas prejudiciais contemporâneos, eles são protegidos com sucesso de
Remoção de sales automáticas.Geralmente.Isso é alcançado por

pagina: 203

198 Capítulo 3

Verificação riódica e reconstrução das chaves do registro aplicadas
Programa malicioso para carregamento automático.Outra metodologia é
Removendo a chave atual e criando um novo, com um nome diferente.Repita
uma operação semelhante com uma frequência de 1-2 vezes por segundo leva a
Que no momento da análise, o Ashogiy $ encontrará uma chave, mas no momento de
tortura de seu bloqueio ou remover essa chave no registro não mais
Crianças - um novo com um nome diferente será criado.

Com os programas prejudiciais, mascarando seu autorol sem
Rutka-Technology.O princípio da operação de tais programas é criar
a chave de lançamento automático no momento em que o sistema é concluído e seu
Lamentar depois de iniciar o programa malicioso durante o carregamento do sistema.

C Ashogip $ não precisa proteger o processo de parar ou modificar em
memória.Como resultado, o programa malicioso pode à força
Para realizar o trabalho do processo ashogil.ehe ou violar seu desempenho
Ness.

A contra -ação a esses métodos pode ser realizada com
O poder dos anti -rubs da AU e o sistema AU Suag (descrito em detalhes posteriormente).
Nesse caso, basta neutralizar as rotas por meio de Aukh, ativado
Dive A2, SIAG4 e Lance Ashogiup $ como um aplicativo confiável.

Em uma nota

Ashchegip $ utilitário não contém bases atualizadas com uma descrição de novos princípios
Automóveis, por isso é aconselhável atualizar periodicamente a versão do programa.
Atualizações do utilitário vão regularmente, cada versão reconhece mais
O número de métodos de Lau de Automóvel.

A versão do console do utilitário é conveniente para análise automatizada
computador.O utilitário é controlado com a ajuda de parâmetros
linha de comando.Um exemplo de um conjunto típico de parâmetros:

Aksogip $ n.

O parâmetro -a neste caso ordena que o utilitário exiba todos os elementos
você é auto -launch, os elementos parâmetros -p -exclude do protocolo,
Sanny M!Para análises automáticas, é conveniente usar a chave -.
Os parâmetros Daine alternam o formato das informações exibidas do texto
(que é um formato padrão) em $ \ y.

Utilitário nyasktz

Utilitário nuaktm5 (vir: // mmi lotsoooe.oge/ai/) desfruta de enorme
Polaridade em várias conferências dedicadas à análise de computador
Para a presença de programas de espionagem ou trojan nele (Fig. 3.12).

pagina: 204

Programas e serviços públicos para o sistema de pesquisa 199

Ro de nós "1.99 1

A - .
Sochi para o ou tu ramtoa tuy para | re5r
Estou em M e O-Th.
G 20 OL Luna dos fios do ekho em Giya shl nina = vincula
91- PORRA
02- vn ang hour- 406649r-C802-4059-VET-704 Uvenoni, ›Kfeosgali rzeboyddoyae 6 ivier Dennniy
22 - vno são u + abbbibknevs i shi -Usonoo sao "Anna Zhsysn 9
G} Toobai yereers ve a Aro Areseria Ian 1
04 - para nós la: [bouopomap 9 coma ehe
24+ nma ri rozetka, pios derramar rin colog enroaccus enanei busrat el fi
Oh para nós, Al: [Kojyudifoblnay "sua véspera RTODGAT Roma do Sivakog Bourg egig aya hm va"
Nkym ayagi [amura] mutéia ehe
“Para nós, la ai.(Com certeza foi vendido] Sarreaaava vhr. Drr == Great Rules E sim "
- nm No. Taurss "E Argoosaki A \ Kazren Kozkazyaru Alanya Reging Rheomox Vekh Zone é diferente.
-Kmm dols [temo] "RGOOGEIT: rZOZAIR. Fibbeta Sok em Zm Ah"
NKO.Yip [stemon ele ao AO ASE cerca de 659
- Noah VI [mm "e Rosar em, roo este mos mal" prolosgevyd
Kim [45M555] "E. Outro no Mazepe Snee" Plefésios
Emir: Roroau Ur = G de PGOOGAG Richiadyanyugi, minérios de Rornichra Tera tudo
‚Py haa-
06 - Eve Sogchye Body Party?Para fazer upload de tudo em Ponoshchininski - Rrourea?Ras nan k _ wt
Ebdiya soy pag wat para fazer upload de produtores de zns - biiolagla: rende para mim para mim
|.
] $ 09 -Procurando por "Tod Gogweed Baszn's -" Reeve -vosv -b 4 -8029- Cathedral su, -Sarrosra Panin KM AH
|->-.

5kal & bi e sala sh

[sa |Mk Srysky |L 1

Tez ol zeaeo@ kit dd heikhya 29 urethy: |

04
s
04
[2
54
ry
Sy -
04
O8-

Arroz.3.12.Utilitário nivskti!

O principal objetivo da concessionária é executar uma análise expressa do computador
RA e a formação de um protocolo de texto com os resultados da auditoria.Básico
As características da utilidade:

Sobre isso é distribuído gratuitamente;
O tem um tamanho pequeno, em torno de 200-220 kb;

O não requer instalação e pode ser lançado com CO ou da rede
pastas;

C cria um protocolo de texto estruturado, que é convenientemente análise
ser manualmente ou com a ajuda de ferramentas automatizadas;

C permite "consertar" (botão sua sobreposição) de qualquer um dos descobertos
elementos.

COMENTE

O termo "correção" na maioria dos casos não reflete a essência da execução
Minhas operações, seria mais correto dizer "excluir".

pagina: 205

200 Capítulo 3

O utilitário abre principalmente com os dados do registro.Não contém fundos
Pesquisa de assinatura ou análise comportamental.Portanto, em todos os casos
A decisão deve fazer o usuário.

O protocolo exibe os utilitários lançados no momento da digitalização
Processos, elementos de auto -let.Serviços, várias configurações do navegador e
Módulos de sua expansão (VNO, painéis), configurações TSRLR.contente
NOVA $ arquivo e vários outros parâmetros.Todos os parâmetros são divididos em grupos,
Quando exibido na tela e saída no protocolo, todos os registros estão equipados
Prefixos, por exemplo, "O23" ou "B".A descriptografia de prefixos é apresentada em
Um certificado que pode ser visualizado quando o botão é pressionado.Disponibilidade
O prefixo simplifica significativamente o processamento automático do arquivo e a distância
A busca por parâmetros para sua exclusão e correção.

A principal desvantagem do programa é a falta de proteção contra as rotas -
A interceptação mais simples das funções em $ egmo4e permite que você se esconda da NBASKTI &
qualquer informação ou em vez de dados reais para emitir os valores de referência
chaves.Além disso, a concessionária é inútil contra programas prejudiciais,
o registro protegendo suas chaves através de seu monitoramento contínuo e
recuperação.

Despachantes de processo

Como você sabe, o gerenciador de processos padrão \ ip4o \ 5 $ distribui um mikiimum
informações sobre processos avançados e geralmente se tornam um objeto
Ataques dos Rutkuts.Para análise de um computador e um pedaço de malware
Os programas requerem ferramentas mais eficazes.Um desses meios
é o utilitário rgosez $ echrogeg.

Utilitário rgose $ $ echrogeg

Utilidade rgosez5 ehr/ogeg
(Ir: // office zuzitsygpa 5. sot/it $/minério $ $ echryuga.i e!) -
Este é um despachante de tarefas com funções avançadas (Fig. 3.13).

O utilitário tem as seguintes características:

0 Tamanho da distribuição 640 KB, o tamanho do arquivo executável é de 1,3 MB:
C é distribuído gratuitamente:

O não requer instalação e pode ser iniciado a partir de uma pasta SB ou rede;

C pode misturar o sistema de processos do sistema.

pagina: 206

Programas e serviços públicos para pesquisa do sistema 201

Seus oryugs do que um nalf para o paraíso do Ore55 (XE Chefr
Eu sou

Pvezly
Feridas em torno de $
Fraquidade para Ana.
Sem no AZ
Jogador ma
O processo da batalha

\ Vasematechones

\ Eixo vasido “chu 0001 ema

“Vaza Mala para a promoção Vienna Children Re.
“Veenali: Yubasna está perguntando,

\ Zazemaleonesv \ ino -zaginels ai assy,
\ Oeuk \ kzes 0
Samoa, mas vb_mechova gogi
Salom Aa Kob, Mstava Ayelmikh Sopigyug
SMA MI \ MATN96_MKLOSE OTIOKIA SOPRUYOGN
Samoa Ambos Altar de Meslose Bioony Selletult

|.35

Arroz.3.13.A janela principal do utilitário rgosez $ echrugeg

Na janela principal do programa, uma lista de processos é exibida, atualizada de
frequência sintonizada.A lista de processos é externa,
O grupo está no processo dos pais.

Na parte inferior da janela, um painel com uma lista de abertos
Nap ou bibliotecas carregadas do processo atual.Para cada um dos
Os processos de colocação podem ser causados ​​por uma janela de propriedades contendo adições
Informações corretas sobre o processo e o arquivo executável.

Sobre a guia PPAR contém informações sobre o arquivo executável, a linha de comando
KE (do qual o processo foi lançado), o catálogo atual.

Na guia Subapso, ela contém vários contadores de desempenho.
Informações sobre o uso da memória.

Na guia Richogtapse Suga, contém gráficos de desempenho para
O processo escolhido - um cronograma para o uso da flor e ocupado
memória.

pagina: 207

202.Capítulo 8

A partir da guia Tegef $ - flui informações.Mostra uma tabela de fluxo,
Além disso, o endereço da função executado no fluxo é recalculado
Transmitido para a conveniência da análise (neste caso, o endereço é exibido como <nome
Módulo>!<Cunction>+<flowing>).

Na guia Tcrlr contém dados sobre TCR e portas de relógio, ouvindo
O aplicativo, bem como as conexões TSR instaladas.Para ka-
Linhas de Ode na lista podem ser chamadas de janela mostrando a chamada para empilhar
No momento da abertura do porto.Esta é uma função muito útil, pois com seu
pode -se esclarecido poder quem abriu especificamente a porta - um processo, um dos
seus fluxos ou biblioteca carregados no espaço de endereço
Cess.

7 Zesshyu Tab contém informações sobre os privilégios do processo e direitos
vários usuários no processo.

A partir da guia do epugoptel exibe a lista de libras do processo do processo
e seus significados.

Na guia US $ 5110, ele exibe linhas de texto encontradas no arquivo.Sobre
Este marcador é um interruptor indicando onde procurar texto
Linhas - na imagem de um arquivo na memória ou em um disco.Análise de linhas de texto
Vale a pena colar na memória e, em muitos casos, você pode encontrar
Muitas coisas interessantes para análise - por exemplo, aveia, os nomes dos antivírus e
EGEMMA |(que indica a presença de um código, que por algum motivo produz exposição
Escountion usado para proteger o computador) ou mensagens,
exibido na tela.Para simplificar a análise, o possível
a preservação das linhas de texto encontradas e a busca por elas.

Além de exibir informações detalhadas sobre o processo do rgosez $ ehr/ogeg
chamadas para mudar a prioridade do processo e seu link para os processadores, antes
para derreter o processo e todos os seus fluxos (e continuar a implementação
processo suspenso e todos os seus fluxos), execute forçado
a conclusão de um processo ou árvore de madeira.

O utilidade rgosez $ ehrugeg tem uma funções adicionais de $
Para procurar programas maliciosos e pesquisa de sistema.

Com a busca pelo processo através de sua janela.A janela é selecionada visualmente, com ajuda
Arrastando um ícone com a imagem de uma visão da janela do rgose5 $
Ehr \ ogeg.Esta função é muito conveniente para a busca do programa AZ \/Age, retirada
Janelas diárias com informações de publicidade.

0 Pesquise uma biblioteca ou Napa nomeado.A busca pela biblioteca é realizada por
O nome dela, a busca por Nap {e - pelo nome do objeto associado a ele.Resultados
Você é exibido na forma de uma tabela.

C Verifique as assinaturas de arquivo digital.Na lista de processos pode ser
Para repreender uma coluna com os resultados deste teste.

pagina: 208

Programas e serviços públicos para o sistema de pesquisa 203
E -idol outro MD

0 lançando o processo em nome de outro usuário ou em nome da Shtid
Lagos com restrições máximas.

A principal desvantagem deste utilitário (assim como a maioria dos outros
GIH) é a falta de proteção contra rotas.

Pesquisando e bloqueando utilitários
espiões do teclado

Para procurar espiões do teclado, três tipos de programas podem ser usados
produtos.

0 Qualquer produto antivírus.Todos os antivírus em um grau ou outro
pode encontrar espiões do teclado, mas o shiion do teclado não é
É um vírus e, como resultado dos benefícios do antivírus, não é suficiente.Produzindo
Os corpos de alguns antivírus incluem detecção de teclado
espiões em bases expandidas ou fornecem uma opção separada,
permitindo a detecção de chaves.

Com utilitários especializados que implementam o mecanismo de assinatura
A reivindicação e os mecanismos de busca heurística.Um exemplo é
Lita AU7, combinando o scanner de assinatura e o sistema de detecção de chave
Viator espiões com base em armadilhas.

Com utilitários e programas especializados destinados à exposição
Cura dos espiões do teclado e bloqueando seu trabalho.Semelhante
Os programas são mais eficazes para detectar e bloquear o
Viature espia, porque, como regra.pode bloquear a prática
Através de todas as suas variedades.

A principal dificuldade de detectar um espião de teclado usando
A assinatura é que o desenvolvimento do espião do teclado não está representado
é de particular dificuldade, e na prática do autor havia teclado
Espiões personalizados.

Dos programas espenializados, o interesse pode ser comercial
Rpuausukeuboaga e API API \ YURVEG.

Riuasukeuboaga

Utilitário riuasukeuboaga (em p: //mchchu.behreka.y2/) é comercial
O produto, o custo de uma cópia é de US $ 89 (Fig. 3.14).Programa
Riuasukeuboaga trabalha em segundo plano e detecta
programas suspeitos de rastrear o teclado.Em caso de necessidade
O usuário pode desbloquear manualmente o trabalho de qualquer uma das detecções

pagina: 209

204 CAPÍTULO 3

programas de esposas.Para detectar espiões de teclado, este
Um grama não usa a base de assinatura, a detecção é realizada pela heurística
métodos.

G] g "vetzalnaya
Para eles] expandido |TURA

[G] desconecte o protetor de tela no início da passagem

Exibir o ícone na bandeja do sistema

Responda à fraude sobre os mestres em Spakh
Cap

Desconecte os efeitos do lanche

Desconecte os efeitos visuais

Escolha o estilo

Arroz.3.14.Riuasukeuboaga,
A janela principal do programa

O teste do programa mostra que ele neutraliza efetivamente
espiões do teclado com base no uso de armadilhas, cíclicas
Pesquisa de SKU e filtro de driver de teclado.Além disso, o programa é
Trolls a presença de suas interceptações em kebug1sezsk1reogt61e5Vado »
algum intervalo (cerca de 5 segundos) e restaura interceptações em
chá de sua neutralização.Em particular, o riuasukeuboag intercepta a função
Rexmesazade, que faz um exemplo um exemplo de um kelogter do regime do núcleo
Com base na interceptação da Rakeszade (este exemplo funciona alguma não divulgação
Tempo de vida, até o próximo cheque do kebig: Serzse1reogta1e $ kommersant).

Em uma nota

Uma característica do programa Ryuasukeuboaga é o disfarce de seu principal
O processo da tecnologia (consulte a seção "Keta! Fashion Goyo", capítulo 2).Vestígio
Vanitel, verificação do sistema usando anti -rhrates e utilitários para pesquisar

pagina: 210

Programas e serviços públicos para o sistema de pesquisa 205
W - - DIGZHK - DC UR -

Processos ocultos levarão à emissão de um aviso sobre a presença no sistema
processos de mascaramento.Este é um comportamento normal para esse utilitário,
Não representa um perigo.

AAUAPAPSED AOO keyooddeg

O programa pode ser baixado no site do desenvolvedor (nº r: //m.-apb-
Keyurrreg.pe/), volume de cerca de 800 kbytes.A utilidade requer instalação, depois
As instalações são necessárias para reiniciar.O programa pode funcionar em automação
modo mítico ou de acordo com as regras criadas pelo usuário (Fig. 3.15).

|Learsen pp kauroeg mu.5 Imm I G. G.
Retrah mn norus ber
1 ffof® hee

Sato aaa Tyudy - Simeofschy - meu lagarto pedarimi
IAS Solnov/ Arca de Z2Snaya Vekh Step Bode
© Zminobmai Out After the Namust 28 U 'Wu M "0 Library RH] Bridge Evovara

Ebonvno Sarshshv rgbeat
O nariz do uz vbi runri i \ 'aka deu um - uma biblioteca de pequenos gestos

Arroz.3.15.Adapseb Ap Keujodereg,
A janela principal do programa

O estudo do programa mostrou que ele descobre com sucesso o básico
Os tipos de espiões do teclado e neutralizam -os.Ao ligar
Modo de operação de acordo com as regras do usuário automaticamente
entra no modo de treinamento.Quando um keiogter é detectado, dia-
Janela lógica com informações sobre o objeto descoberto (Fig. 3.16).

pagina: 211

206 CAPÍTULO 3

Ae yat - a4uapseya ami]

Lou

Reobgagi Plz Deesvos em um sonho Leru © Penya Keuzoal Esbniu

AA.

F Ca \ Dezi 1 m bp...A

# Aksovto 5 popweg cubo: aobiva conhecendo goyomigo tiba
E |

ACARDY VP ONS 04 ASAZHNY ROM KEROS 9 ANI WU.bigode pni 1 Aofkasez ai kedooo rom
1 Vauvto Rapae No. Ansust

[] Arzb Coma do AS GIIE OSE ® Aoschabsayu 2 Sing
[4 = _) de por

Arroz.3.16.Mensagem em caso de detecção de keilger

O usuário pode permitir uma operação adicional do teclado
um golpe ou bloqueie -o.A vantagem indiscutível do programa
Mensagens informativas produzidas durante o treinamento podem ser consideradas -
A4UAPSYA ALPO Keureveg determina o tipo de interceptador e, no caso de instalação
quais armadilhas indicam não apenas a armadilha que contém a biblioteca, mas também
O aplicativo que está tentando instalar esta armadilha.

Apesar do fato de a concessionária ser paga, seu 11A | -version funciona em
Modo Funcional em um período de 15 dias e desta vez
Não é o suficiente para verificar o computador.

Farejador

Sniffer (do inglês.
"Snakhach") foi projetado para interceptar e análise do tráfego de rede.Interceptação
Os pacotes são possíveis devido ao fato de a arquitetura da maioria das redes locais
com base na tecnologia do escapado, no qual vários dispositivos de conexão

pagina: 212

Programas e serviços públicos para pesquisa do sistema 207

Mas para um ambiente de transferência de dados e é usado em conjunto.Pacotes
Eschegp!
Após o recebimento de pacotes, o cartão de rede aloca pacotes por mas-
endereço.Essa filtragem pode ser desconectada com troca
Cartão de rede no modo de recepção de todos os pacotes - o RGPU $ zio $ chamado
Tod.

Ao usar os sniffers, deve -se ter em mente que esta ferramenta
Tem um duplo propósito.

9 Sniffer pode ser usado por programadores para depurar trabalhando com
Uma rede de aplicativos ou fins educacionais.

Com os administradores podem usar a LLL da análise LLC da labigiga
redes, diagnosticando problemas em seu trabalho, procurando vírus de rede, detectando
A atividade de rede dos favoritos dos Trojan, a detecção da rede
ataques.

Eu posso aplicar um sniffer para a análise do tráfego de rede
ka para obter informações ou senhas confidenciais
Usuários.

C) Um malware pode conter um reservatório
análise não autorizada do tráfego de rede e coleta de informações sobre
Os critérios atacados para o envio subsequente do atacante.

Portanto, usando o sniffer na rede corporativa, ele deve ser esclarecido no inferno
ministros ou especialistas do Serviço de Segurança, é permitido
Uso pelas regras do trabalho e pelo fornecimento atual de proteção
Informação.Este é um ponto importante, já que o mais frequentemente usa
Os sniffers em uma rede corporativa são proibidos por razões de segurança.

A maioria dos sniffers modernos contém instalações suficientemente poderosas
Chuva para a análise de pacotes de rede, reconstrução de sessões de rede para
Protocolo TSR/R, conduzindo várias pesquisas estatísticas
(por exemplo, a composição do tráfego analisado, calculando o volume do transferido
Informações com agrupamento por hosts e protocolos.P.).

Ao usar os sniffers, vários recursos devem ser levados em consideração.

C) A maioria das redes modernas é construída usando um interruptor
fosso.O interruptor no caso mais simples leva a base dos mac-adres da rede
dispositivos conectados às suas portas, o que lhe permite abordar
Para corrigir pacotes para as portas apropriadas, isso permite descarregar a rede
e aumenta significativamente sua segurança, porque torna impossível
A interceptação do tráfego de toda a rede.Alguns interruptores têm um especial
Funções de ciclo que permitem que você gire temporariamente a comunidade
Tator em um hub (neste caso, cada pacote é transmitido para todas as portas
interruptor) ou para arar uma porta como uma porta para o monitor

pagina: 213

208 CAPÍTULO 3

Toque e configure a duplicação de pacotes de determinadas portas neste monitor
Porta de anel.Portanto, antes do uso do reservatório,
estudar a topologia da rede e, se necessário, aceitar especial
mede até a substituição temporária do cubo do interruptor durante a análise
Tráfego.

Sobre o uso de um sniffer em um gateway ou marchrutizer, você pode analisar
para o tráfego, passar entre redes ou entre uma rede local e
A internet, que é útil para busca imediata por vermes e
bots de spam.

Existem casos conhecidos de operação instável de alguns cartões de rede no modo
Rgopisioi $ to4e.

Sobre as técnicas de hacker para interceptar o tráfego de PCs especificados na web
com a troca de pacotes (a metodologia mais famosa é tão
Soldição ACR de ACR (do inglês 5ro/-mistificação)).

No momento, muitos sniffers de vários fabricantes são conhecidos
telia, mas sua principal funcionalidade permanece inalterada - capturar
pacotes de rede e sua análise.Nos sistemas operacionais do servidor M!
Existe um analisador de tráfego de rede padrão - Megmark Pug.No chmx-
Os sistemas são um sniffer {sddir, que, apesar da completa ausência
interface gráfica, tem as mais amplas possibilidades e muito
conveniente para várias tarefas relacionadas à detecção e registro de
Ketov de acordo com as condições especificadas.

Dos sniffers comerciais, a distribuição foi distribuída | 115 megmogk TGAIS
Apaeugheg (vp: //mchui.euue.sot/i6/) e sott \ uem (bp: //mchu.4atosis), de
NÃO -PROFIT - Um número de sniffers baseados na biblioteca \ u/mptrsar
(Ir: // Trsyar. OG?), Em particular, Eschehea!(Chu. E@egaa|.sot) e APA!

(Bp: //apa1uheg.roshch.i).

Sott \ Meme

Sott \ me \ sochno tem um tamanho pequeno, mas ao mesmo tempo executa tudo
As principais funções necessárias para a análise do tráfego de rede.produtos
é um comercial, o custo de outra versão sem restrições em
$ 300.Além de gravar pacotes de rede, ele possui várias funções que
Pode ser útil para aprender uma rede.A janela principal do programa é mostrada
Na fig.3.17.

Sott \ ue \ m permite:

Sobre a reconstrução de sessões de TCR, o que é muito conveniente, especialmente
para analisar o trabalho sobre os protocolos da ETR e NTTR;

pagina: 214

Programas e serviços públicos para o sistema de pesquisa 209
- E

Arquivo Ponsk Bad Inirzhelye Configurações Stevele Posveta SpoSeve
E O@S-g- nós

71 Retáticas |7 pacotes em Pozochfiyly - DI da direita |40 pregam
Jonah Mas Demolição Faer - Martha
Ilsa Mastuuuurazya 32
Seria Urae BuyNoye 06} 1
Interruptores de thronpeio
Zraiyya |YetRertai p 245 g de

No. 1
Rasor Fryinat 0?Morcego 4 - ...
N Radya, 2322 - ph = p.

G
Iziisstiviye sd 2 teleys
AO: -: += = =
SAWING A dor de 5}.Oh boom, = #6 de nós a =, você
Tira Syo Zigika 10 (5) - 5.1
O gênero é um SR (93 i
Aqueles: Oz REATE

|-
Para cantar ani!020000 (9) ›
TN em Viea fyy (12597 Hunts 4e ve sho 65 60 93-27 65 ITS 2 05 wa uz com eles

RAZCISO NOR (51. Tor 020010 G: ++ IE 24 como 14 6V AE 14 8. ® Z-K
Simidade 0485 (4) - Soichkt Bio "

Deus [p 172.20 7.28 Shazoz er 40 42 21 |: zy8ka
Slalnort TR 172002728 00046 e] 43 p.G B0 PA

- s- 0 = 0050 re rp r.

e Arksha 050050 em AK YAR 43 43 HG-BAAS
= Um

culpa <

O iniciante levou o veterinário sobre o relógio, Arya Che!2 eu.Lutar VI Pravyvy.|.

Arroz.3.17.A janela principal do programa, colocando o analisador de pacotes

Sobre a análise de pacotes.O analisador realiza a descriptografia do
Skolkov escapando do TCR, 1R, arr.De acordo com a documentação de SottMe \ M,
Mantenha uma análise de mais de 70 protocolos diferentes;

Sobre filtragem de pacotes capturados de acordo com arbitrário
pesca dada pelo usuário.As condições são registradas de acordo com o descrito
no certificado das regras;

Com certas ações no caso de eventos
tipo Nogo.No caso de eventos descritos pelo usuário, ele pode
Uma notificação de e-tie, lançamento dos programas fornecidos, inclua
Gravando a atividade da rede e ativando as regras descritas anteriormente
Filtração do pacote.Este modo é conveniente para procurar computador
Úteres infectados com um vírus de rede;

0 Capture pacotes de acordo com o cronograma criado pelo usuário,

O Gere pacotes arbitrários.Interface do gerador de pacotes e
Interface lógica do analisador-o pacote é exibido em um não-chefe,
Os resultados da análise dos campos das manchetes dos pacotes são exibidos.Para gerar

pagina: 215

210 CAPÍTULO 3

O pacote Cure fornece o cálculo automático das quantidades de controle.
O pacote formado pode ser transferido para o número especificado de vezes de
Defina a velocidade.

A presença de um gerador de pacotes permite estudar a reação de aplicativos de rede
Para pacotes de um determinado tipo, que é convenientemente LIA de rede
Rimificações.Pacotes gravados podem ser preservados por Lly do subsequente
análise.Por padrão, a conservação é realizada em seu próprio formato
Sott \ iu \, mas as exportações são apoiadas para outros formatos, em particular, em
Arquivos de texto com uma separação.A possibilidade de exportação para formulários de texto
Você é conveniente para analisar informações com sua própria ajuda ou
Msgoza ehsa |.

Efege!

Sniffer e'shegea |(UU, Efegheya | .sot) foi originalmente desenvolvido para Mpich
Plataformas, mas atualmente existem versões em U4o \ $, mas 0 $
X, Egeevzo, AH, Zom e vários outros sistemas.Sniffer se espalha
Juntamente com os textos iniciais, o tamanho da versão da versão 0.99 para o wipdo \ z z
Compõe cerca de 12 MB.Para o trabalho, ele precisa de grátis
Countsed Libraries Ultrsar {para \!Em di-
STRIBIV PARA ULP4O \ Z Library \ MprSar já está ligado, então é
O carregamento desnutado não é necessário.

O princípio de operação do sniffer é construído em pacotes de gravação para o subsequente
análise.Durante a gravação de pacotes, estatísticas mostrando
o número total de pacotes capturados e o número de pacotes para mais
Protocolos comuns (Fig. 3.18).

O registro de pacotes pode ser interrompido à mão ou definir um ou mais
Condições da parada de gravação automática.A parada de gravação é fornecida
Depois de tomar um determinado número de pacotes, registrando um determinado volume de
Formação ou após um determinado tempo a partir do momento em que a gravação começou.
Para registrar o tráfego de rede por muito tempo
Rena configurando a divisão automática de arquivos em fragmentos.Em particular
Estilo, quebra pode ser realizado quando os arquivos são alcançados
O tamanho e o modo de rotação automática de arquivos são suportados.

Uma característica distintiva do Eschege!é muito mesquinho e conveniente
Um filtro equipado com um construtor visual.Visual Builder
Elimina a necessidade de lembrar de cor os nomes dos campos.Na Listagem 3.1
Exemplos de várias linhas de filtragem típicas são mostradas.

pagina: 216

Programas e serviços públicos para o sistema de pesquisa 211

Euteai: Sarata é aquele Maguya!1

Arroz.3.18.Janela de estatísticas
No processo de gravação de pacotes

1p.95e == 172.20.114.34
Ssr.rote == 80 ||Par
Ebv.ada == ela: ela: ela: ela;Ela: ela: ela

!
EA 1252 APA ESR ROGE EA 80)}

As condições de filtração podem ser introduzidas manualmente ou salvas em
Biblioteca de Condições sob nomes semânticos.

Depois de concluir a captura de pacotes na janela principal do sniffer, ele é exibido
Lista de pacotes capturados (Fig. 3.19).

A seleção de cores de linhas é uma função opcional de olklood.
Além disso, você pode criar suas próprias regras de descarga de cores e
DACT os existentes.Eo nº Eagle na barra de ferramentas permite

pagina: 217

212 Capítulo 3
Defina as condições para filtrar pacotes já capturados.Para ver todos
pacotes capturados, é necessário limpar o campo com o texto do filtro com
Eu costuro os botões CEAG.Pressionar o botão ARMA aplica a condição atual
Filtragem.A função de filtração é muito conveniente para a análise do tráfego,
Benno durante a investigação de incidentes na rede e procure traços de rede
o ladrão de vírus e programas de Trojan.A conveniência se deve ao fato de que
FER pode ser configurado para capturar todo o tráfego para obter o total
Protocolo de atividade de rede e aplique filtros para sua análise.

|
O o W:

Bam bnchfa vuu pu

-> BS em
Nenhum

m _- de, 11 “2.-1 n „1 ps de batida
1 $.559578 218. = 24,11 a |‚Meta.> 12%1 g (E1M, AE

3. PS 1904.37.43.E |P> 12 TMK em
3% 5.979535 196. 57.4.B8.P77r/.3 302 Urina Tatshu M
55 3.279645 194. 57,43.2, nem> 1299 ga1y, 0] 0

VIH 0,11%.331 g onde -\.14. F.
De 6. em ZV 87, TA 172.29 334. M V S sobre
Ry.Ko
5 Reza 28 (407 Bul 3: #1. 4: Clique em Biazhas)
# SSR 11. 370: Azat com OL HARO FA (00341302124), O5TU TII ARTFS WT (00.0146
$ Tithegpet rg0k0c0 ". Z7S 112,20.114.134 (1112.20.114.100), 09: 134.67.45.98 3154.67.55. 90.

|

76 como 14 72 86 S2 43
Ra 94 ta 26 2 <$ 0 18
Como VE 74

oh.
© O46 65 72 ZR 69 54 34 37 31 39 38 39 Z 74 para 3: #240571 7389!T

Ef z “2 AL No. 2 No. 24 22 97 34> & Z Ta para 73 g 4-42

TG P: 85 27 86 5 Gira 0

Arroz.3.19.EMEGEA!, A janela principal da janela

Analisador de pacotes Eschehea |É típico para os sniffers modernos
e mostra as informações detalhadas do usuário sobre todos os campos de todos
Pacote Golovkov.Além da análise dos campos dos títulos, muitos
Informações para protocolos de alto nível, por exemplo, ETR e
Nttr.Além da análise de pacotes individuais, a função da restauração
As novas e US $ 51 sessões (Fig. 3.20).

pagina: 218

Programas e serviços públicos para o sistema de pesquisa 213

Mega: Mossa y 29. Soja

SERS "Poder:
Peso = Pst 7: AR.IT 1AT "
Por exemplo - m> -5 a © coetet1;M5TE 6.01 e \ pboi $ kt We 51;MT SOW 1.4
651 UT: E
Lugares ‘op: kva -etlie
Okile;Ura = fisarie nn

R/2.1 302 moji tapogag lu
Shchcheg: 2/1.0

Che: Tyv.-\ ar '2606 15: 014A3 SMT

Esetchevt istr:/endoat, 114% “Ha/eoiltag>

3 = 7 798;2 = 1 10;1513;g =;Tuva: 5 = 2024 “765;4-32;Guy -0.2491102135071655
G & OPA;SCA

ZSPA-Soltgot "em um dia

[Emo] Eurozhetovol (588 Bush)

oh
Com aaraenfnniy |

Arroz.3.20.O resultado da reconstrução de sessões de TCR

Além da concha gráfica de Escheaa!Contém vários utilitários da equipe
linhas que permitem capturar pacotes e trabalhar no protocolo
Minha atividade de rede.Por exemplo, o utilitário 1ehegea!
Sniffer de console funcional (Listagem 3.8).Por exemplo, inicie
Com parâmetros:

Seeevwegea1.ehe -12 e sr

Ativa a captura de pacotes para a interface de rede número 2, válida
O filtro, neste caso, apenas pacotes TCR são capturados.

0,000000 172.20.114.134 -> 213.180.204.11 TSR 1661> Fan: 5m] $ e = 0
Tep = 0 m55 = 1460

0.104684 213.180.204.11 -> 172.20.114.134 TSR NER> 1661 [$ MIND, PERDE]
$ e9 = 0 Ask = 1 No. 1g = 57344 calor = 0 m $ $ = 8910

0,104731 172.20.114.134 -> 213.180.204.11 TSR 1661> Wind [Ask] $ ea = 1
Ask = t 9111-65535 [TCR DEES- $ ohm tmsovvest] tep = 0

0.104867 172.20.114.134 -> 213.180.204.11 NTTR Set / nttr / t.

0,317144 213.180.204.11 -> 172.20.114.134 TCR [TCR do inverno
e geazeet1ea rou]

pagina: 219

214 CAPÍTULO 3

0,323016 213.180.204.11 -> 172.29.114.134 TCR [TSR Zedlele
e geazet1ea 200}

0,323064 172.20.114.134 -> 213.180.294.11 TSR 1661> ner [Ask] $ e4 = 59950
Ask = 2821 H1P-65535 [TCR SNESKUA TNSOVEST] KOA = 0

Utilitário antivírus a \ y2

Essa utilidade do desenvolvimento do autor foi concebida como um universal
Strument para Apalys do utilitário do sistema é gratuito para empresas privadas e corporais
aplicação provisória.Sua cópia pode ser encontrada neste
CD do livro.Durante o desenvolvimento desta concessionária, a ideia principal
resumido para conectar a funcionalidade de vários
Vários utilitários usados ​​para pesquisar e destruir malicioso
programas.

Utilidade AU7.Possui funções adequadas.

Com a busca por malware conhecido por assinaturas armazenadas em
Base atualizada.Por um lado, é conhecido.que as capacidades do sinal
A pesquisa de turnê é limitada, pois apenas os descritos em
Programas maliciosos base.Por outro lado.Detecção de
malware mensageiro durante o estudo do sistema simplifica
Este estudo permite que você realize tratamento automático.Sinal-
O analisador de turnê Au é bastante simples no dispositivo, o que permite
Verifique os arquivos com alta velocidade.Por outro lado.sua nomeação
Consiste no detector expresso de idade comum.

Sobre o banco de dados atualizado de arquivos seguros.Inclui assinaturas digitais
Dezenas de milhares de arquivos do sistema e arquivos de cofre conhecido
Cessov.A base está conectada a todos os sistemas A \ U7 e trabalha com o princípio
Os arquivos "estrangeiros"- seguros não estão em quarentena, para eles
A remoção e retirada dos avisos estão bloqueados, a base é usada
Rutkin, sistema de pesquisa de arquivos, vários analisadores.Na frequência
O gerenciador de processos construído destaca processos seguros
e serviços coloridos, os arquivos de pesquisa no disco podem excluir da pesquisa
Arquivos famosos (que são muito úteis ao pesquisar no disco do Trojan
programas).

Sobre o sistema de detecção de gancho construído.Pesquise por Ki do estado está sem exemplo
assinaturas com base no estudo de biblions básicos do sistema
texto para interceptação de suas funções.AUI não só pode encontrar
desça, mas também organize um laço da operação correta do trabalho
Lake Gos (Ki para seu processo e Kege Moda Gos {Ki no nível
Tópicos.

pagina: 220

Programas e serviços públicos para o sistema de pesquisa 215

0 microopogramas da recuperação do sistema.Microopogramas são realizados
Restaurando as configurações do Echrogag NOVEGPAG, parâmetros de lançamento do programa
e outros parâmetros do sistema danificados por programas maliciosos
mi.Restauração é iniciada manualmente, parâmetros restaurados
indicado pelo usuário.Um sistema semelhante automaticamente exemplo
está relacionado ao remover alguns dos programas de tiro para os quais
É necessária uma limpeza ou modificação não padrão dos parâmetros de registro.

A partir do microprograma da verificação heurística do sistema.Microopogramas
A busca por zru bem conhecida e vírus em sinais indiretos -
Com base na análise do registro, os arquivos no disco e!em mente.

Com um detector de espiões do teclado (Keuroreg) e Trojan de ... Pesquise
Keugovreg e Trojan de.A base da análise do sistema é realizada sem
o uso da base de assinatura, que permite detectar com bastante confiança
Rive Up com antecedência Trojan desconhecido de.E Kagonguyeg.

Sobre o analisador embutido Umpzosk $ RI/T $ P-LUST.Permite que você analise
Para compor configurações, diagnostique possíveis erros na configuração e
Realize tratamento automático.A possibilidade de diagnóstico automático
Nastics e tratamento são úteis para usuários iniciantes (em serviços públicos
O tratamento automático do tipo 15 de Ryes está ausente).Para pesquisa
VID/IT5R manualmente no programa, há um gerente de configurações especiais
E $ P/ZR1.Para o trabalho do analisador, Uypzosk Berrysre é aplicado a
Anti -Rutus.

Com um processo, serviços, serviços e drivers construídos.Projetado
estudar os processos secos e bibliotecas carregadas,
Serviços de filhotes e motoristas.Para o trabalho do gerente de processos,
A ação dos anti-rusters (como resultado- ele "vê" as máscaras
processos de rutkin).Despachante do processo de associação com a base
Arquivos seguros a \ y7, arquivos de segurança identificados e de sistema
Eles se destacam em verde.

Com um utilitário -in construído para encontrar arquivos no disco.Permite que você procure um arquivo
De acordo com vários critérios, os recursos do sistema de pesquisa são supérfluos
Oportunidades de pesquisa sistêmica.Os resultados da pesquisa estão disponíveis no formulário
protocolo de texto e na forma de uma tabela na qual você pode marcar o grupo
Arquivos para exclusão subsequente ou quarentena.

Sobre o utilitário de construção construído para pesquisar dados no registro.Permite que você procure uma chave
Chi e parâmetros de acordo com uma determinada amostra, os resultados da pesquisa estão disponíveis no
protocolo de texto e na forma de uma tabela na qual é possível observar
Quantas chaves para sua exportação ou exclusão.

Sobre o analisador construído de portas abertas de TSR/Chedor.Para ele
A ação dos anti-rusters, em \ ipdo \ s $ x r lly,
Marcar o processo de porta.O analisador é baseado na renovação

pagina: 221

216 CAPÍTULO 3

a base laminum dos portos dos famosos programas de trojan ou flotooog e de
Serviços do sistema de avisos.Procure portos de programas de Trojan
Chen no algoritmo principal para verificar o sistema- ao detectar
Portas visuais no protocolo são exibidas, indicando,
Quais programas de Trojan são caracterizados pelo uso desta porta.

Com um analisador de recursos comuns construído, sessões de rede e abertos
arquivos.Funciona em \ mt9x e mu \/2k/xp.

Com exclusão de arquivos heurísticos.Sua essência é que, se no curso
Os arquivos de tratamento foram removidos e esta opção foi ativada, então
Estudo automático do sistema é encontrado, cobrindo aulas,
VNO, extensões 1e e EHR |
Umpyurop, zeril.
Tomaticamente, eles são treinados com a entrada no protocolo de informações sobre
O que exatamente e onde foi limpo.Para esta limpeza, usando ativamente
Há um motor de microprograma para o tratamento do sistema.

C Verificando arquivos e arquivos compostos.No momento, eles verificam
XIA Arquivos do Formato 7tr, Comissão de Atestamento Superior, SAV, C71R, SO;Cartas eletrônicas
arquivos de correio e MNT;Arquivos SNM, alguns tipos de programas de futeg,
Adicionando informações no final do arquivo executável.Prever
Rena é a capacidade de salvar cópias de arquivos descompactados para o longo
A análise muito manualmente.

Com verificação e tratamento de fluxos de arquivos e catálogos MTA.

Sobre scripts de gerenciamento.Permitir um administrador ou benefício experiente
Vitel para desenvolver scripts que executam um conjunto em um PC de usuário
Operações decavadas.Em particular, os scripts permitem que você use a AUE em
Rede corporativa, incluindo seu lançamento durante o carregamento do sistema.

Com um analisador de processos.O analisador usa redes neurais e micro
Análise gramas, ele liga quando a análise expandida em
O nível máximo de heurística foi projetado para procurar suspeito
Tel processos na memória.

Com o sistema Aug Sciaga.Destinado a lutar com difícil para casa
Programas de denúncia podem, além de Au, proteger esses
O aplicativo pelo aplicativo, por exemplo, outro antibish e antivírus
Programas de NY.

Como pode ser visto na lista de funções, durante o desenvolvimento de um U7, o objetivo foi perseguido
Combine o número máximo de funções em um programa, útil
para o estudo e tratamento de um computador.Momento positivo
Essa integração é a relação dos módulos- por exemplo, a base da segurança
Objetos são usados ​​por todos os subsistemas de Au7 e anti -traços e Au2
Siag4 suture todos os sistemas de rotas ou os efeitos de malicioso
programas.Por outro lado, o acerto de contas para universalidade é menos

pagina: 222

Programas e serviços públicos para o sistema de pesquisa 217

A funcionalidade de muitos subsistemas- por exemplo, o gerente de processos
ow \ u7 perde na funcionalidade do rgosez $ echrogog, da mesma forma
Podemos dizer sobre o anti -ratutkit ou anti -qulogger.

Gerenciador de processos

O processo de Built -in de processos AUI tem um desempenho típico para programas
Este tipo de funções- exibe uma lista de processos avançados, biblions
Teques e janelas do processo selecionado (Fig. 3.18).

* Dispatcher of the PotsoSsoi
Parâmetros precedentes
Cess R Descrição Shousdal

rapé para amplificador

Inball com um processo de ação

Che Paul Nug
1

Arroz.3.21.Despachante de processos a \ y2

Além das funções típicas, está equipado com vários especializados,
Razoável para a busca por programas prejudiciais.

Com o gerente de processo AU7, é protegido por anti-rutting e contém especial
Fundos para encontrar processos ocultos.Essas medidas não permitirão o ga-
para detectar qualquer processo de mascaramento, mas contra
Métodos de mascaramento comuns, eles são muito eficazes.Máscaras

pagina: 223

218 CAPÍTULO 3

O processo de direção é liberado na lista em vermelho e na nota
A metodologia é indicada pela qual um disfarce é implementado
Cess.

Com todos os processos e bibliotecas são verificados no banco de dados de objetos seguros
Ay.E de acordo com o catálogo de segurança M!Stands seguros são destacados
em cores, o que está em conformidade significativamente com a decisão sobre isso
O objeto é prejudicial e disfarçado como uma sistêmica ou ação
É sistêmico e seguro.

De cada um dos objetos podem ser copiados em quarentena e
Datado da quarentena de arquivos seguros é automaticamente bloqueado.Pré-
O botão para copiar em quarentena de toda a execução negligenciada é
arquivos nus.não identificado no banco de dados seguro.

C para cada um dos cc] o processo exibe uma lista indicando seus
Dunces, coordenadas e títulos.

Do gerente de processos, pode remover os despejos de qualquer processo avançado
ou carregado O, para a análise pós -análise.

Com o menu de contexto da lista de processos permite pesquisar
Lançador com o nome do processo (ou biblioteca) usando a pesquisa
Sistemas de saída do Soor! E, uapdeh, katyg.A chamada também é suportada
em Aus.Pesquise no registro denominado arquivo.

Joint venture] suporta descarregamento forçado de qualquer biblioteca selecionada
processo.Deve -se notar que essa operação geralmente é
dietas para o mau funcionamento do processo que o usa ou de seu imprevisível
Então, você pode usar esta operação apenas no caso
precisar.

O gerenciador de processos foi projetado para analisar os processos manualmente.Além do mais,
Um sistema de análise automático é fornecido.Para ativá -lo,
é necessário ativar o cheque de processos avançados, colocar o nível de eur-
Bifes ao máximo e instalar a análise estendida da sinalização na guia
Parâmetros de pesquisa.Depois de instalar esses parâmetros, é necessário incluir
Leia a auditoria e durante a verificação de processos avançados serão realizados
Sua análise.Se propriedades e funções suspeitas forem encontradas no processo
O protocolo é exibido por informações com avisos (Listagem 3.9).

Pistina 3 9, Protocolo Fodigmont do Anapisator do processo Au

C: \ M1P90M5 \ C5+55.EH - Pscusion em \ 1x115.i1p32.re_tura1
(grau de perigo 75%)

Analisador - estudando arquivo com: \ igoom $ \ s5u35.eh

(E $]: pode trabalhar com a rede

[RI]: Ouça as portas TSR!

[E $}: o aplicativo não tem zidima scon

pagina: 224

Programas e serviços públicos para o sistema de pesquisa 219
} -

[E $]: EHE estacionamento

[$ 2]: colocado em uma pasta do sistema

[$ 2]: Gravado no AutoStart!!

[{E5 $]: Carrega Vasart - talvez trabalhe com uma chamada?

Esta informação não permite tomar uma decisão, o processo é perigoso ou
Não - isso é informação para o pensamento.Nesse caso, o protocolo é trazido
Den para o programa Trojan TGODAP-RGOHA.
Desatualizado usando o analisador descrito.Como é fácil notar, nome
O arquivo é semelhante a um sistêmico e é colocado em uma pasta do sistema.No entanto
O analisador detecta o uso do empacotador, o fato é registrado
Ouvindo portos de TCR.O que está no total com a colocação desse objeto em
Pasta do sistema e sua presença no início automático permitem que você aceite o arquivo
Ressentir -se.

O analisador pode emitir os seguintes avisos:

Com suspeita do ouvido.- durante a análise da estrutura do
Um arquivo nu detectou violações nas manchetes ou outras anomalias,
por exemplo, o ponto de saída do arquivo indica não na seção de código, mas entre o
íons ou na zona do título.A retirada de tal mensagem pode
caminhe durante a análise de arquivos compactados por alguns pacotes,
deixar liberdades com o formato do re-arquivo;

0 pode funcionar com uma rede - significa que o processo usa bibliotecas
Digite, Get, Itop, \ 52_32 e pode potencialmente conduzir uma troca com a rede;

C. Pode enviar e -mail?!- significa que durante a análise do processo no
Puffy um código de programa ou constantes, típico para o aplicativo
queima e envio de correio;

0 suspeito do fato do correio/spam - significa que o aplicativo
Instala conexões com um determinado servidor de acordo com a porta 25 ($ MTR);

Com os dados dos dados na porta 80 (NTTR) - significa que o aplicativo
Define conexões com um determinado servidor de acordo com a porta 80 (NTTR);

0 ouve os portos de TCR - durante o estudo do processo, foi estabelecido,
que ele está ouvindo Olin ou várias portas TCR;

Com tgodap.rz \!?- Durante a análise do processo, um código de programa foi identificado ou
dados típicos dos programas envolvidos em senhas e
Programas de programas como 1 também, TVI.P.;

Com o perigo-suspio
O processo é descoberto e, de acordo com o analisador, o disfarce
feito de acordo com o método ocular;

|O aplicativo não tem janelas visíveis - o aplicativo não tem ninguém
visível para o usuário da janela;

pagina: 225

220 CAPÍTULO 3

Sobre o Packer?- De acordo com o analisador, um arquivo executável é possível
Mas, compactado por um empacotador ou protegido por um Tipo de proteção de articulação A $ rgosg;

C está localizado na pasta do sistema- uma declaração do fato de que o arquivo está misto
no sistema de pastas;

Com atributos suspeitos - um conjunto suspeito foi encontrado no arquivo
atributos.O arquivo usual, em regra, é redefinido atributos, ou
O atributo está bronzeado arquivado.Os programas de Trojan costumam definir
Seus arquivos são atributos ocultos e sistêmicos;

(C com um lançamento de carro - o analisador descobriu que o programa de estudo
registrado no início automático;

Pode supostamente lutar contra antivírus - significa que no decorrer
A análise do código da máquina e dados de dados revelou uma característica de código
para programas que neutralizam antivírus e Eemay;

Com um alto grau de probabilidade pode combater antivírus- an-
lógico para a mensagem anterior, mas a probabilidade de correção disso
Há mais conclusão:

Com o pagamento pode modificar os parâmetros de Ehamay e segurança
O processo - o processo contém um código de programa característico dos programas,
realizando modificação não autorizada de configurações
Eyem |;

C contém um detector de depurador e utilitário de monitoramento?- O processo é
Você pode verificar a presença de um depurador ou sistema utilitário no sistema
E |.

Com o download de O, Vasarg - talvez possa trabalhar com uma chamada?-
O processo usa um quartel ou carrega um kazart.

Qualquer um desses avisos não é um critério de classificação
O programa estudado é malicioso.Esta é uma informação adicional
matcação que permite formar uma lista de processos para os quais
É necessário prestar atenção primeiro.

Estudo automático do sistema

O estudo automático do sistema foi projetado para simplificar o
um estudo de manifestação do computador.Chamando pesquisa automática
Arquivo do menu |Pesquisa do sistema (Fig. 3.22).

A tarefa da pesquisa do sistema é construir um protocolo consolidado
Formato NTME contendo os resultados de verificar o sistema por todas as análises
Torá construído na vila.Ao construir o protocolo, automaticamente

pagina: 226

Programas e serviços públicos para o sistema de pesquisa 221

Os dados são filtrados em arquivos que passaram os cheques no
a base dos objetos seguros de Au7 ou identificados pelo catálogo do m/sag.
Essa abordagem pode reduzir significativamente o volume do protocolo e
Simplifica sua análise.

* Protocolo de Niya Snstemi

Oh iimu canta ela

Culpado

Sobre mbiio "+ gu

Sltsib e tiro

Mamulyn é simples de rugir

Vvzospisk

Troiki ©

Os portos de Toralu

Modip Reusmnirozhny [994

MUHELEY brotou com fio e

Madyli Svist Sistya Teta $ trinovs
A Dinamarca é um faldy Hawk de Tazi Volodya
VGisi Ferp +95

Verifique Piochchae -e Pratozho 16 {Ly Subofnonny Kli 00
Goeving Interein Hearts Am Surfication AM:
Teot er arkiv g prot*sl 4 noslodny sys

Ga e neniy
Op: << [xx eeplit

Arroz.3.22.Janela de configurações
O protocolo da pesquisa automática do sistema

Antes de conduzir o estudo do sistema, é necessário convencer
Xia na ausência de rotas ativas nele.Em caso de suspeita de disponibilidade
Rutkin deve ser neutralizado pela AUL.E somente
depois disso para estudar o sistema.

A composição do protocolo é determinada pela janela da janela do protocolo de estudo

Tópicos:

Sobre processos de execução - se este sinalizador estiver instalado, então no protocolo
Informações sobre processos avançados estão ativados;

Do processo de processos- disponível apenas com a bandeira marcada de
Processos de filhotes, sua instalação leva a adicionar ao
Formações nas bibliotecas usadas por processos negligenciados.Sob-
São mantidos dois modos de adição de informações sobre as bibliotecas: conclusão
Liste osh.para cada um dos processos ou construindo uma lista separada
Bibliotecas sem repetições.No segundo caso, na tabela da biblioteca, adicione
Há um campo com uma referência aos processos usando a biblioteca;

pagina: 227

222 Capítulo 3

De serviço e drivers - a instalação desta bandeira leva à adição
para o protocolo de informações sobre serviços e drivers carregados no momento
sistemas do sistema;

Com o módulo do espaço do núcleo- a instalação dessa bandeira leva a
a base do protocolo da lista de módulos do espaço do núcleo no momento de
seguindo o sistema.Esta informação é amplamente cruzada com determinado
A seção do serviço e dos drivers, mas vai para outra maneira.
Comparação da lista de módulos do núcleo e a lista de motoristas podem
usado para procurar módulos mascarados no método OKOS;

[Não.

Automóvel - sua instalação leva à adição de dados ao protocolo de dados
Sobre todo o analisador AU apoiado por Au.elementos de launces automáticos;

Configurações de SPR/T $ P;

Portas TSR/Cr;

Módulos de expansão GE (VNO, painéis ...);

Módulos de extensão do condutor;

Pressione módulos de expansão (monitores impressos, provedores);
Tarefas do planejador de problemas, então um Eschet:

Registros de arquivo, mas $ t $.

Por padrão nas configurações para a formação de um protocolo de pesquisa
Estamos instalados sinalizadores para excluir arquivos do protocolo, identificados como
Segure e adicione o protocolo da última varredura AU7.Exceção
É recomendado do protocolo de arquivos seguros, pois reduz o volume
O protocolo é várias vezes.

O estudo do sistema geralmente leva de 20 a 30 segundos, mas pode ser

desacelerou no caso do monitor incluído usado em um PC
antivírus.

ooooosoo

O sistema de pesquisa do sistema pode ser automatizado usando
Linguagem de programação Skripte mantida na AUL.Um exemplo de tipo
O script Vogo é fornecido na Listagem 3.10.

Listagem 3.10, Skrmpt típico, tratamento de incentivo de uma mesa de sistema
E a pesquisa de Systma
Waah
AUZSHOCHO1E: $ 61119;
Problemas1p
// formação do nome da pasta de trabalho
A \ y2to901x :: = SESU 201XEOGA + '106 \';

pagina: 228

Programas e serviços públicos para o sistema de pesquisa 223

// Criando uma pasta de trabalho
Steaer1Keseokhu (autogocho1 y);
// ***+*Configurações A2 ** ++*
// Ligue Karentin
Zeierdau> {'zebtahape1ta = u');
// Arquivos de cópia excluídos durante o tratamento
Zeeirau?('/ZetpBesed = \');
// Permitir tratamento
5 -Sordal \ y2 ('ve] y1x = y');
// Ligue os anti -rubsitos
Zesmrda \ m2 ('Ape1vosk1 buzepuu*);
// Digitalizar o disco do sistema
Zebirdaui {'5sam =' +beiebuzmo15k +': \');
// Lançamento da verificação
VIP5SAP;
// Preservação de quarentena
Steatbihape 1 pEAGS1E (AU210901:+'OGAP1SHE.21R');
// execução do sistema do sistema
Ekesesbuzsnesk (AU2GOA01:+'ZUZSressk. VE ");
// Conclusão de Au2
Ehztaus;

EP8.

Para o lançamento do AU7.Com este script, é necessário salvar o script no texto
Arquivo e inicie Au7, com agosto. Zstera = nome do arquivo.

Para estudo em massa de vários computadores (por exemplo, em local
uma rede de uma empresa ou rede doméstica) outra pode ser útil
Script (Listagem 3.11).

Pisting 3.41.Script durando um estudo dos comunadores na web

Beth
// Verificando - Locks nomeados computador
1e rosas ('abmtm', seesotrhysumat) = 1 sucata ex1au2;
// pausa para deixar todos os programas carregados de automóveis iniciarem
51er (50);

pagina: 229

224 CAPÍTULO Z.

// configurando um \ 2

Zetlrau2 ('h5ebagap #p = y');// Ligue a quarentena

Zebrau2 ('rg {og16u = -1');// prioridade reduzida

// ativando o cronômetro de guarda por 15 minutos

Ase1uas \ atsvrod (60 ”15};

// Lançamento da verificação

VIPBSAP;

// Adicionando dados no nome PC

Aaatoych ('---------------'):

Aaatogoch ('protocolo do computador'+begsotriveHmat);

// bengala automática

Ekheseaisobaagap 1t;

// Preservação do protocolo

Zauger (bezau201geskoga+ '\ 1.0s \'+ be-sutsagmat+ '_109.6he')};

// execução do sistema do sistema

Ekhesikebuzsnesk (sesau 201 berse+ '\ kommers \'+ Creatorigmata+
'Universidade Universal.

// Conclusão da AU?

Ehzeaul;

EPA.

O script fornecido na Listagem 3.10 é a memória de digitalização
computador, executa o Auto Carandin de todos os arquivos que não são identificados
como seguro ou sistêmico, mantém o protocolo de varredura e
uma participação da pesquisa do sistema sob um nome único contendo como
Nome da rede prefixo do computador.Esquadrões deste tipo são úteis para
administradores de sistema, pois com a ajuda deles você pode rapidamente
Pegue informações de muitos PCs.

Restauração do sistema

A recuperação do sistema é uma ferramenta embutida no AUI,
atribuído para eliminar automaticamente os problemas mais típicos
com as configurações do sistema que surgem como resultado da atividade de prejudicial
programas (Fig. 3.23).

O nome desta função não reflete com precisão sua essência- na maioria
Para os casos, o termo "restauração" é entendido como "redefinir os valores
padrão".

pagina: 230

Programas e serviços públicos para pesquisar o sistema

Restaurado pelas configurações do sistema

Restaurando a mudança do lançamento de EHE, Honeycomb, RE Files
Redefinir configurações de prefixos de protocolos e \ eg!Eh'ogheg no Staller
".Restaurando a página inicial da Meta!Ehr! Oiag
* Redefina as configurações de pesquisa MEGLE!EHR/OGEG para padrão
Restauração de configurações de desktop
Lelige Euch Rosice $

Eu} executar as operações marcadas

Arroz.3.23.Restauração do sistema

A recuperação do sistema permite resolver os seguintes problemas:
C.M. Restaurar os parâmetros de lançamento de arquivos ehe, SOM.Ré,

|

|.
|.

GMK, Watts, Peso, 5CV;

225

Despeje as configurações dos prefixos de protocolo que você costura echrogag no acampamento
Grate (ao mesmo tempo, todos os prefixos existentes são removidos, após o que

um conjunto de recrutamento padrão é criado);

Realize a restauração da página inicial IGPEG EHR | OGEG;

para descartar as configurações de pesquisa do Qiegpag Echrogeg e várias outras configurações para

padrão;
Redefinir as configurações da área de trabalho:

para remover toda a roice $ (política de restrição) da atual
Do utilizador.As restrições são armazenadas no registro e são frequentemente usadas
Programas de denúncia para bloquear várias funções \ mtdo \ 5,

Responsável pelas configurações da UYID;
remoção da mensagem exibida durante \ mig.o2op;
Restaurando as configurações do condutor.

pagina: 231

226 CAPÍTULO 3
Ai -
Todas as funções de recuperação descritas podem ser executadas naturalmente
manualmente.Com a ajuda do editor do registro.Olnako é a edição de numerosas
As chaves do registro e a introdução de valores padrão neles são trabalhistas
a operação, por isso é recomendável aplicar essas funções de restrição
Notícias.

A recuperação dos microprocogramas é armazenada em um atualizado

Base a \ u7, portanto, como novas amostras de programas maliciosos estão estudando
Microprams complementam e melhoram periodicamente.

Quarentena automática

A quarentena automática permite criar cópias de todos os arquivos que
descobertos durante o estudo do sistema e não são reconhecidos pela base da segurança
Au7 objetos, e de acordo com o catálogo por mystose (fig. 3.24).

* Cópula automática em quarentena

Cópia de stonitinasky em quarentena nzo-

L Processos de execução
@BeAVolla Processos de produção

(Eu sou sleda e drivers
|Os módulos do núcleo
Glavtosepchauk

Portos Tseayur

G Configurações do visto/EP

Módulos de expansão (E (VNO, Penali}

Modups de expandir o condutor

|.

e

[Eu sou um planejador do Taz® Zsizayag Problem Planner

E para homenagear a união

Arroz.3.24.Configurações automáticas de cópia
Em quarentena

Esta operação é conveniente para resolver vários problemas:

Com cópia de arquivos de vários PCs da rede local para o subsequente
Análise centralizada.A operação de podobia é conveniente no decorrer da luta contra
epidemia, pois para verificar os arquivos AU7 da quarentena que você pode
o fio de vários antivírus e de acordo com seus protocolos para compor rapidamente
lista de PCs infectados;

pagina: 232

Programas e serviços públicos para o sistema de pesquisa 227

Coleção automática de joint venture de arquivos que valem primeiro para verificar
em vírus.Esta operação é conveniente em caso de pesquisa remota
um computador para o qual não há acesso irrealista.

Considere um exemplo de um script que realizou o estudo do sistema e automaticamente
Quarentena tática de todos os arquivos que aparecem no protocolo de pesquisa.

Listagem 3.12.O script do DN da opeção eutomética do sistema
Não é um envoltório

Waah
Augooozo1x: 55: 119;
Kommersant1p
// formação do nome da pasta de trabalho
AUGULOOAH: = Seauri1testom + '106 \';
// Criando uma pasta de trabalho
SGATE01 Hesfoku (A \ 210901);
// execução do sistema do sistema
Ekhesisubuz ses (auagoao1g + 'zuzsnnesk. V');
// realizando quarentena automática
Ehesi+easiooagapte1ta;
// Preservação de quarentena
SOBEDTEBIGAP1PiATATUTE (AU 210901 e+'E11E $ .21R');
// Conclusão do trabalho au
Eh eaua;
EPA.

O lançamento desse script pode ser realizado com a ajuda de um arquivo de IVA que
reduz as ações do usuário para iniciar este arquivo e enviar o conteúdo
Mooo Gos para pesquisa.

Sistema A \ 2 sedaga

A tecnologia AUKH SIAG4 é baseada no KEGP!
O acesso de aplicativos avançados ao sistema é inadequado.O motorista pode funcionar
Qonos em sistemas baseados na plataforma MT (começando com o MT 4.0 e
Acabamento U15A veta 1).O objetivo do sistema é reduzido a várias funções.

G A luta contra programas maliciosos difíceis de acarretos que são
Coloque as chaves do registro e os arquivos excluídos, comece a parada

pagina: 233

228 CAPÍTULO 3

processos de ninhos ou de outras maneiras impedem sua remoção.Esse
O principal objetivo do sistema.

C} Proteção de aplicativos confiáveis ​​dos não transmitidos.Esta função é
chamadas para proteger a AU7 e seus apêndices de confiança do
ações de malware de trabalho, que em alguns casos
Simplifica para verificar e o tratamento de um computador.

Com a distribuição da ação do anti -assédio CH5EGMO4E para outros processos.
Por exemplo, utilitários como Zsappeg respeitável, OG \/e Sita PT, Nuaskta &
etc.
CamaradaNesse caso, você pode iniciar a AUI, realizar a neutralização de sulcos
baleias para seu processo e depois ativar au7, ciag4 e iniciar o scanner
Rig \ Este PT como um aplicativo confiável.Então o motorista do AU7, Span
assumirá a função de proteger o processo de execução, incluindo
Não permitirá que Rutkin modifique sua memória.Naturalmente, dado
A tecnologia não é uma panacéia de todos os tipos de brigas de 5egMode, mas
Seus principais tipos (em particular, a sabotagem do reepdeg e seus clones) pode ser
Neutralizado dessa maneira.

No momento da ativação do sistema Autsagy, todos os aplicativos são divididos condicionalmente

Em duas categorias - confiado e incrédulo.Em anexo confiado

O motorista não tem nenhuma influência, embora sem princípios

As seguintes operações são proibidas:

Com a criação, modificação e remoção dos parâmetros do registro;

Com a criação de arquivos com extensões de EHE, Chi, US $ 5U, Osh, 5sg, Sr, R, Ba Hente Cem
em qualquer disco;

Com apelo aos dispositivos \ demse \ gamr, \ aems \ iar, \ de \ msu \ sr,
\ Demse \ r;

Com acesso a Demze \ rwyatyatyatyathhtu (que bloqueia as operações com físico
memória de $ $ egmod);

Com a instalação de motoristas (é uma conseqüência de bloquear o trabalho com o registro
rum);

Com o lançamento de processos;

Com a abertura de processos avançados com um nível de acesso que permite
Pare ou escreva em seu espaço de endereço;

Sobre a descoberta dos fluxos de outros processos (ao mesmo tempo, um processo incrível
Não é proibido abrir e interromper seus fluxos).

A confiança inicial é apenas o processo de AUI, mas no menu da AU
Siag@ |Execute o aplicativo como um confiável pode iniciar qualquer
Lidificação.Para aplicativos confiáveis, o princípio da herança se aplica
Relações de confiança - todos os anexos lançados

pagina: 234

Programas e serviços públicos para o sistema de pesquisa 229

Os processos também são considerados proxy.A herança é importante para o correto
O trabalho de muitos programas, por exemplo, VCO Veoeg das versões mais recentes
Cria um segundo processo no processo de seu trabalho.

No decorrer do trabalho, a \ u7 siag4 intercepta várias funções principais, então
seus conflitos com anti -grupos que têm a função da verificação e
Restauração do zot.

Pesquisa de arquivo no disco

O sistema de pesquisa de arquivos de disco construído possui vários recursos,
Especialmente fornecido para simplificar a busca por programas maliciosos
(Fig. 3.25).

Com uma pesquisa de -in construída, o AU7 é protegido por anti -infirutics.Portanto, pesquisa e
A quarentena de arquivo é possível se houver uma raiz ativa no sistema
Lago.

Com uma pesquisa de arquivo para várias máscaras é possível (o número de máscaras e seus
A complexidade não é limitada).

"N msk arquivos № dnesyai
Diet, PA = Gran tr gmtisk

‚7,3 FEIP da força aérea (ou máscara} ^ 5*2 ^ 91" 5 $.

= De acordo com o disco+fluido (c)
° E e Zena (Vyat) - mais) №1000 B |
> Tre Data of Consupered in ZibleZo-B No. 1022005 1042005 |
|Não = e [Dange}
2035 o \ o-discrod 0) g.

(7 Sinqual Falp. Famous Ami Kah Systems Safe
2 excluem arquivos.Tendo passado por cima da sobrecarga do meu
[G para adicionar arquivos de negócios à fraca

O;©

Canal |Arquivos encontrados

FALG -.‚Azmer Criação Data - Nodifik Data

==.
‘Chukch A ferla afundando em queratina] © Exclua o notável.Khafiles]

oh era m senhoras - - - - s - osb

EM

Arroz.3.25.Subsistemas de pesquisa de arquivos Janela A \/7

O Na pesquisa, existe a possibilidade de excluir arquivos que foram submetidos a verificação de
O catálogo de segurança do msgoza e o banco de dados de objetos AUI seguros.Na dor

pagina: 235

230 CAPÍTULO 3

Os pneus dos casos são recomendados para incluir os dois filtros, o que é significativamente
afeta o número de arquivos encontrados, especialmente se a busca por
Em uma pasta do sistema.

De qualquer um dos arquivos encontrados, você pode excluir com remoção automática
Registro da ILN para copiar Lryamo da janela do sistema de pesquisa.

Além de encontrar arquivos em execução do usuário, existe um possível
a criação de scripts que pesquisam o arquivo no disco de acordo com o
critério.A funcionalidade de pesquisa do script é muito maior,
Quanto é a possibilidade de analisar cada um dos arquivos encontrados.
Em particular, a linguagem do script fornece funções de assinatura
A reivindicação nos arquivos.Pesquise com uma análise de assinatura pode ser muito útil
Para automatizar a busca de novas variedades de malware
assinaturas próprias.

Considere exemplos de scripts para pesquisar e analisar arquivos.No mais simples
Caso a pesquisa se resume à criação de um procedimento executando um recursivo
Ignorando uma árvore de catálogo (listando 3.13).

Pistal US $ 15 Pesquise um arquivo em uma disiva de um pedaço

Rgosegula 5 SAP) 1x (AO1EMAPA: $ & X1P9; ABSAPO01G: BOO} EAP);
Uag
E;Teshebeags;
Bedalp
Ab1tmasha: = poderia!01 (ar khmape);
E5: = tepbeagksn.
E $.Eapae1 ge (ar1mashchera + '*.*');
uv11e e5 $.
Ze 5foisizvakhthekh (ag masha + e5.er11empa);
1e 23.1501: Black Super
1st AZSAPBOY01 AP (RIDA111MASHMA <> ') APA (P $ .E11EMATE <>' .. '} Spark
ZSAPB1 T (AO1 MOM + E5.E11MASHECH, ABSAPZOO1G)
Epe e} ze
1 Tochegsazaz (e5. Iz1emama) = 'Egodap.911' Enp
Aaatotod ('encontrado fiel' + ag1mumary + e $ .e11Mapma);
E5.lpamech;
EPA;
E5.EGEE;

EPA;

pagina: 236

Programas e serviços públicos para o sistema de pesquisa 231

Problemas1p
Zsap01u ('c: \', +gii};

EPA.

Este rabisco contém a função de $ sapr1t, que procura o arquivo
Deitar em um determinado catálogo.O segundo parâmetro da função afeta o recursivo
Ignorando o catálogo.Se for igual a Eatze, então um desvio recursivo de uma árvore
Não há catálogos e a busca por arquivos é realizada apenas no gato dedicado
LOGA.Se o segundo parâmetro for seu, o desvio será feito.estrutura
Catálogos Rable, a partir do dado.

O valor prático deste script não é muito alto, pois em essência
Ele procura um arquivo pelo nome.Script com análise de arquivo não-
Quão mais complicado (Listagem 3.14)

Pete para o parafuso da abertura do Omonosobos das medidas de Lo
// Adicionando uma mensagem ao protocolo

Rgosedige AZZA1ACT (AE11EMATE, AMZA: $ ZEG1PA);

Problemas1p

// mensagem para o protocolo

Aaasogosd (*>>>> '+ae11emama+' suspeita de ‘+am53};

// Adicionando um arquivo de quarentena

Ozagap1Ptee11e (AR11EMATE, 'Suspeita de'+amza);

BS;

// Digitalização de arquivo

Rgosedica bsapa1le (ae1} emashe: $ 5G119);

Problemas1p

Zes5 taeezttech (ae11empa};

Toa9e1111etoveyee (ar11mamama);

1e zeksn51ot ('2e 61 64 20 77 20 61 2p 72 20 65 2e 63 63 6e',-20.000, 0)
> = 0 EP
Azoatatt (AR11MASHECH, 'Admage. Taken2p'};

Egeevia, por exemplo;

EPA;

// digitalização da pasta (com desvio recursivo}
Rgosediga zsappat (apo1kmats: 56g119; absoum01g: kooo1eap);

pagina: 237

232 CAPÍTULO 3

- = azz, c: |:/: - = -/ -/ |

Uag
E5: Esses!Ebeyags;
BVD1P
AO] masha: = Mott101g (Ao1gman);
SI: = TR11EBAAGSY.
$ 2.E1p9e1g 3% (AO1 para mamãe + '*.*');
SOB
1 e $ .1501x EPEP Bed1p
1º Absapza601 AP@ (e $ .r115mate <> ') apa (e $ .e11matma <>' .. ') está mentindo,
5 SAP01T (AB1GMAMA + E5.E11MASHECH, AZSAPBAR01 K}
EP E1ZE
ZSEPER11E (AO: MOM + E5.E11EMATE);
E. E1pamech;
EPA;
Eveeeee;

EPA;

Problemas1p
Zsapr1tg ('c: \', ge);

EPA.

Este script contém uma função já familiar para nós na Listagem 3.13
Zsapo1k com uma diferença no céu - em vez de comparar o nome do encontrado
Um arquivo com uma amostra no nosso caso para todos os arquivos que uma chamada é feita
Funções $ sala11e, executando uma análise de arquivo.Função zsapi, em seu
fila, carrega o arquivo estudado no boofer do analisador a \ u7 e
A pesquisa de assinatura é.Nesse caso, a assinatura atua como um
Rim de byte, característico de Aya \ /age.gok2t.Em caso de detecção de SIG
A natureza é chamada de função do script de Azzalahi, adicionando uma mensagem a
O protocolo e a cópia do arquivo de quarentena suspeita.

O script fornecido na Listagem 3.14 pode atuar como um protótipo
Para desenvolver seus próprios scripts que pesquisam novos
A novidade de programas maliciosos.Scripts semelhantes são úteis para o
uma análise de computador e pode ser usada em conjunto com a automação
a quarentena e a pesquisa do sistema.

Em uma nota

Todos os comandos do idioma do script a \ u7 são descritos em detalhes no sistema de referência.
Para cada equipe no certificado, você pode encontrar um ou mais típicos
medidas de sua aplicação.

pagina: 238

Programas e serviços públicos para o sistema de pesquisa 233

A função de análise de assinatura suporta o próximo tipo.

Cerca de xx-byte deve ser igual a xx, onde xx é o valor em hexadecimal
Nom.Exemplo: 55 aa 45 21. Esta é a assinatura do tipo mais simples,
semelhante à cadeia de pesquisa em editores hexadecimais;

C! XX - byte não é igual a xx, onde xx é o valor do byte em hexadecimal
forma.Exemplo: 55 aa! 45 21 - O terceiro byte da assinatura não deve ser
igual a 45N;

COM ?- Byte pode ter algum significado, é essencialmente um passe de byte em
análise.A indicação desse elemento no início e no final da assinatura não tem
Faz sentido, embora não seja um erro.Exemplo: 55?AA ??45 21 séculos
Este caso por bytes na posição 2, 4 e 5 não são analisados;

C?
Isca em forma decimal.Exemplo: 55 aa?
Semelhante à assinatura 55 aa ???2?45 21;

In -xx -passagem vários bytes (de zero a atingir o limite da análise
a área do rublo) antes da parte de trás do byte ser igual a xx.Exemplo: 55 AA *45 21;

C -xx, uu -apresenta uma verificação da condição do isolador> Amo u = xx.
Esta operação permite comparar os bits especificados na isca, e não o todo
Isca inteira.Lacunas neste design (antes e depois do AIM)
É permitido, pois a lacuna é o separador dos elementos na assinatura.
Exemplo: 55 -0a, 0e -neste caso, a assinatura dos sons da assinatura
Como "O primeiro byte é 55, e o Mlal -i tetrad do segundo é igual ao OD".

Despachante de automaturas

Controlador de operação de automóveis A \ U7.analisa os principais métodos de início automático e
Faça uma lista de programas carregados de automóveis.

Comparado aos análogos, ele tem uma série de funções especializadas
Cide útil para procurar programas prejudiciais.

A partir do controlador do Missile Auto, a AU7 é protegida.

Sobre os elementos de lançamento automático são verificados pelo banco de dados de objetos seguros e CATA
Loga Megoza.Objetos seguros são distinguidos por verde.

Com o despachante do automóvel está associado à quarentena - você pode copiar qualquer
A partir dos arquivos gravados no autorol em quarentena diretamente do dis-
Petcher.Além disso, a cópia automática é fornecida em
O guerreiro de todos os arquivos que não são identificados como seguros.

Sobre o sistema AU7 SOIAG, ​​o despachante automático de lampline pode ser um exemplo
para a remoção de elementos de lançamento automático de pro- malicioso ativo

pagina: 239

234 CAPÍTULO 3

grama.Nesse caso, Au Siaga bloqueia tenta restaurar o
linho ou elementos bloqueados do lançamento automático.
Programa de denúncia.Esta função é muito relevante, então
como desenvolvedores de prejudiciais em termos de mais e mais frequentemente usam métodos semelhantes
Selvagens de proteção.

Recursos de oponentes úteis

Além desses utilitários e programas para pesquisa de computador
Recursos especializados podem ser úteis, que podem executar
Certas verificações no modo OP LE.

Site ner./liili.Igi A!Sot/

Este site contém muitos estatísticos interessantes
formação.Mas sua principal função é verificar qualquer arquivo de vários
E -antivírus.No momento da redação deste capítulo, o site usado
24 antivírus.Esta verificação representa um enorme prático
Teres, uma vez que as bases de todos os antivírus são constantemente atualizadas e simultaneamente
O uso de um grande número de antivírus aumentou significativamente
lê as chances de detectar um objeto malicioso,

Como pode ser visto a partir da fig.3.26, o arquivo suspeito transmitido para análise foi
Detectado apenas por quatro antivírus em 24, o que confirma o
Fectitabilidade de tal metodologia de análise.

Antes de enviar um arquivo para análise, você pode bloquear seu automático
envio para analistas.Para fazer isso, antes de enviar o arquivo, você precisa de seda
Pare o botão OSHA, após o que será exibido pelo cruzado.

Outra função útil do site é a capacidade de incluir US $ 5 $ 1g--
criptografia das informações transmitidas.Este modo é conveniente no caso
Trabalhe na Internet através do RGHU-SERVER com proteção antiviral ou exemplo
outros meios de filtrar o tráfego.

Site vpr:/l/giz $ 5sap./ON!.

O site ugizsap.0#.
A honra dos antivírus usados ​​é menor - 15 peças.Além de verificar os arquivos
Em vários antivírus neste site, há um analisador, execução
Uma tentativa de determinar o empacotador.

pagina: 240

Programas e serviços públicos para pesquisar o sistema

E sem gentileza.Expelido e Bivorea IRA GA1
derretendo a edição "KD escolhido Sorene Sklomek

9.0 A P não © 2-6 c.-@%

Quem é 4116.2 goara

Suriessa Zsaazgila Sazshe de ° 1055 ”, Hesvouf M Mtoztoy] 26 04 24 2006,

08:31:28 (conjunto)

Ponto!FISTO

M5: 4625359643240 A6896532415756187509

Saiba: A22175350464091370429414512415992600A4-+910
Idade de espuma para proibir a idéia de lsa de aa aa que sone eu
Sobre Tsiv Ha'ls.Sou uma parte de Aloe do mesmo Aloe U e da ISS da rede de sprays Gnyago5 é Vomuvan: então 98 Nate
Som um rgomyst, espuma 00 mot grin mifa pr al gnys sig 9 não para vela, charog eo rot oik zi
E W.

9_+ d ssa dê chi com um ha x fr »_
Oh merda para lama

MTU 6 em seus velas seduzindo fu

Em m> _zhk.T-shi =

Arroz.3.26.Resultados suspeitos de varredura de arquivos

conclusões

Para realizar um estudo eficaz do computador, pesquise e destrua
é recomendável preparar CO ou RNAZP-DISC,
contendo todos os utilitários gratuitos descritos neste capítulo.

pagina: 241

Capítulo 4

Métodos de pesquisa do sistema,
pesquisa e remoção
programas maliciosos

Então, nos capítulos famintos, examinamos os desenvolvedores usados ​​pelos desenvolvedores
tecnologias e utilitários de malware que podem ser aplicados
Para procurar malware.Com base nesses dados, você pode
Para controlar a estratégia para verificar o computador sem o uso de antivírus
gramas.

Preparação para análise

Antes da análise do computador, você deve encontrar a resposta para várias perguntas.

1. Qual é o problema com o computador, o que exatamente é
isso é.A eficácia depende da precisão da resposta a esta pergunta
Análise adicional- infelizmente, na estagnação dos casos, análise de
Está apertando com a formulação do tipo "o computador parece diminuir".

2. Na presença de manifestações externas de atividade, é presumivelmente
Um programa de denúncia deve estabelecer a frequência de sua aparência
NIYA e verifique se eles estão associados à disponibilidade de acesso à Internet.

3. É necessário determinar aproximadamente o momento da aparência provável de prejudicial
o programa nariz.Naturalmente, para estabelecer com precisão essa dificuldade
Mas, mas é necessário um intervalo aproximado com uma margem para instalar.
Conhecendo o intervalo de tempo, você pode pelo menos pesquisar no disco
arquivos criados durante esse intervalo de tempo.

pagina: 242

238 Capítulo 4

4. É necessário esclarecer quais ações foram executadas antes
o surgimento de um programa malicioso.A prática mostra isso
A aparência de vários programas maliciosos ocorre após a instalação de ka-
qualquer software, abrindo cartas suspeitas
Ou sites da Internet.

Pesquisa e neutralização de rotas

A busca por rotas deve ser a primeira e obrigatória etapa do estudo
sistemas.Isso se deve principalmente ao fato de que Rutkin pode ativamente
neutralizar a pesquisa do sistema, processos de mascaramento, arquivos n
As chaves do registro.A luta com as rotas pode ser dividida em dois estágios.

Com a busca por Rutkin e o registro do fato de sua presença no sistema.Quando
A detecção de Rutkin deve determinar seu tipo e avaliar a possibilidade
a intervenção do sistema.

N neutralização de Rutkin.Geralmente se resume à restauração de danos
Código de software na memória e restauração de endereços na tabela
Importar (ZZGModa) e Kezheguzse put1reogta1e (Kegp! Fashion).Dado
A operação pode ser realizada usando programas do tipo Au2 ou
Um meio de destruir os arquivos Rutkin e reiniciar executáveis.

A busca por rootkit é uma tarefa difícil devido à variedade de TNPA TT.
Camarada e métodos para sua implementação.A análise pode ser difícil no caso
no PC estudado de aplicativos que executam a interceptação de funções para
Monitoramento de um sistema ou outros objetivos - por exemplo, antivírus, eigu/ai,
Sistemas de proteção proativos.Considere na prática vários típicos
Casos de lesão por computador com Rutkin.

Exemplo da análise - Vaskaog

Esta forma é uma das mais comuns e até.
Ruttors de programas de Bascaog com rutkutka-masking, implementação
laminado com um nível de motorista do núcleo.Para a detecção é aplicável
Dois utilitários - AUL, (Listagem 4.1) e Treachbur (Listagem 4.2).

Pistiga $ 1. Protocolos de sapote aur

Função de Chap1tet.
ArtSoden1} pergunte.Proto

1.2 Pesquisar interceptores de arte que trabalham no modo de Kegpa1

pagina: 243

Métodos de pesquisa do sistema, pesquisa e remoção de malware 239
A função 2MSGeatherGosesse $ (2e) é interceptada (80583543-> 29E1S482),
Interceptador com: \ itmoon $ \ zuzbet32 \ Pikhkaki.5U5

A função 2MSGEACOSA $ ZEKH (30) é interceptada (80588503-> e9E20S7),
Interceptador com: \ ogpmoi $ \ zusey32 \ ptx4xm.Zam

A função 2Motry Office $ (7a} é interceptada (8057459-> e9E1S2E4),
interceptador c;\ Itmoi $ \ zUSOT32 \ PIKH4CHT.Zuz

A função 7Motniya (80) é interceptada (80597S0a-> e9e1stev),
Interceptador com: \ itmoic $ \ zuseet32 \ pihacht.Uz

A função 2Mocohubzheeskokuy (91) é interceptada (80574Ra0O> P9E1S368),
Interceptador com: \ itaron $ \ zuseel32 \ piac4cht.5Uz

A função 2MoceGubuzkettyogta (AO) é interceptada (8057SS27-> P9E1STAI),
Interceptador com: \ Morning $ \ Zusey32 \ Pikh4xm.Zuz

Funções testadas: 284, interceptado: 6, restaurado: 0
>>>> Descobriu um disfarce do processo 188 S: \ m1pdd $ \ echrog.

5. Pesquise interceptores dos eventos do teclado/ratos/Windows (Keu1oddeg,
Trojan Ry.}

S: \ itmron $ \ zusey32 \ pih4h.911 -> suspeita no keu1ddeh
Ou Trojan Oosh

Rede neural; verifique o erro

6. Pesquise por portas de porta abertas/ors usados ​​por programas maliciosos
No banco de dados 319 descrições de porta

Neste PC, 8 portas TCR e 11 portas de portas são abertas

>>> Preste atenção: Porta 16661 TSR - Vaskdoog.

Ouça 4.3.Fragmento do protocolo oo de Euea sul

S: \ itmoi $ \ zuzket32 \ k19sra111.4a> 21/04/2006 11:18 0 busezn1adep

Seu e119om $ art,

S: \ itMboo $ \ zuset32 \ lty4 hmm.Zuz 21/04/2006 11:18 <21,33 KV
N1a9et eco e 1pdoiz art.

S: \ itmroi $ \ 5uzet32 \ piha hee.911 21/04/2006 11:18 38,71 metros quadrados
Nzadep ekp@omz art.

S: \ Tyroi in \ zusey32 \ A2.911 21/04/2006 11:18 38,71 SQ N1AAAP

Seu i10m5 arg.

S: \ itnra $ \ zuzet32 \ a2.

Egot iztpamz art.

S: \ itiroi $ \ zuseet32 \ 382.111 21/04/2006 11:18 320 MUSELA

N \ @Depp ekom i1pomz art.

pagina: 244

240 CAPÍTULO 4

Vamos prosseguir para a análise dos protocolos.Primeiro, pode -se notar que
Vuyeeg detecta o disfarce de vários arquivos, em particular, ttx4ha1.5uz e
Pikh4he.Ai.Ao mesmo tempo, Au descobre suspeito
GRIP (e o interceptador é o mesmo pith4cht.5u $) e
Introdução no espaço de endereço dos processos e no Bibli introduzido
Teca Pith4x! 4 e também é mascarado.Tal coincidência nos protocolos
Não é acidental e permite que você julgue inequivocamente a presença de Rutkin em
sistema.Para experiência, você pode usar câncer ou um gerente semelhante
Os arquivos vão para a pasta Samipmo \!
Os arquivos são realmente invisíveis.

A análise das funções interceptadas nos permite argumentar que o rutkit do rastreamento
Iniciando processos e fluxos, recebendo informações sobre arquivos e pastas
e obter informações sobre o sistema.Além da interceptação das funções da AU.detectar
Suted a camuflagem do processo Echrog.ehe e ouvindo a porta 16661
Um processo identificado, que também é de momentos suspeitos.

Como o próximo passo, iremos neutralizar os interceptores da rotina
Kita.Para fazer isso, nas configurações, ativamos o bloqueio de opções do trabalho
Insira o ozigmof e bloqueie o trabalho do modo KB KEP.

1. Procure diferentes programas e que interceptem as funções da arte

1.1 Pesquisar interceptores de arte que trabalham no OzetMoay

Função Pea11.811: Tatoa9011 (70) Interceptada, Method ArtSoan1) Assk.zirto
>>> Código Rutkita nas funções Gagoaa011 é neutralizado

A função m1p1lpeoe.911: tpekhpeesoppese (229) interceptado,
Método ArtSoden1) Assk

>>> Código Rutkita na função TPEEGPE (SOPPES®EA é neutralizado
1.2 Pesquisar interceptores de arte que trabalham no modo de Kegpa1

A função 2MSGEERGOSEZE (2E) é interceptada (80583543-> e9E1S482),
Interceptador com: \ itmoi $ \ zuset32 \ ptah4 oi.Zuz

>>> A função é restaurada com sucesso!

A função 2msGeatherGosezesh (30) é interceptada (80588503-> e9e20s? T),
Interceptador com: \ itmra $ \ zusey32 \ glo4 oi.Zu5

>>> A função é restaurada com sucesso!

A função 2MargSesz (7a)} interceptada (8057459-> e9E1S2E4),
Interceptador com: \ $ $ \ zuzet3 2 \ ptx4hi.Zuz

>>> A função é restaurada com sucesso!

A função 2Motheeaaa (80) interceptou (80597S0a-> e9e1s7y),
Interceptador C: \ itMroch $ \ zuzesetm32 \ pta4hl.Zuz

>>> A função é restaurada com sucesso!

pagina: 245

Métodos de pesquisa do sistema, pesquisa e remoção de malware 241

A função 2MoceGue) zhtestoguy!
Interceptador com: \ $ $ \ zuzhet32 \ pth4hl.$ y3

>>> A função é restaurada com sucesso!

Função 2FoeGubuzetorOgtas: OP GAO) interceptada (80576S27-> e9etstai),
Interceptor com: \ $ $ \ zuzet3 2 \ itikit.Zu $

>>> A função é restaurada com sucesso!
Funções testadas: 284, interceptado: 6, restaurado: 6

>>>> descobriu um disfarce do processo 188 s: \ e!

Como pode ser visto no protocolo (Listagem 4.3), Au7, relatado no bem-sucedido TI-
Interceptação de interceptação.Para controle, você pode repetir esta operação -
O segundo lançamento do AU7, no modo de oposição do Rutkin, deve mostrar
Falta de interceptações.Se as interceptações aparecerem novamente, isso significa
que Rutkit verifica periodicamente seus interceptores e os restaura
Em caso de neutralização.Em nosso exemplo, a interceptação neutralize com sucesso
Eles são, mas as varreduras subsequentes mostram que foram restauradas
Lena.Em tal situação, a medida mais eficaz é remover
Drivers Rutkin e reinicialização subsequente.Antes de excluir arquivos
Faz sentido permitir o sistema AU \ U7 Siag4, que a probabilidade de
Formação de arquivos durante a recarga.

No nosso caso, depois de excluir os arquivos de mascaramento ttx4xp1.5u $ e
Shth4zh.a!Através da remoção tardia de um \ u7 e reinicialização
Verka mostra que interceptações e processos de camuflagem desapareceram.Desaparecer
A nova interceptação é o principal indicador de que o rutkin é
Peni é neutralizado.Resta encontrar como estágio final,
estudar e excluir os restantes arquivos mascarados indicados no
Keryu Kos \ Kiveuyeg.

Em uma nota

Rutkin pode mascarar quaisquer arquivos que não sejam necessariamente prejudiciais.Poeta
Antes de excluir qualquer arquivo, você precisa analisar e criar um backup
Cópias de todos os arquivos excluídos.

Um exemplo da análise é Vaskaog.

Este baskaog já foi mencionado nos capítulos 2 e 3, mas merece detalhes
consideração.O nome completo deste programa é a sabotagem
(Bp: // uchchu vhdeg.tor/), de acordo com o princípio da ação, é clássico
LAGO-Modo-Ratkin.Oeypdeg quente é distribuído junto com o inicial
Textos sobre oern, o que levou ao surgimento de uma enorme quantidade disso
clones com pequenas modificações,

pagina: 246

242 Capítulo 4

Na versão do autor, Rutkit é um remédio universal que
Ele pode ser configurado usando um arquivo de abelha.O arquivo ICH é descrito
Os nomes de processos, chaves e valores do registro mascarados, bem como números
Portas de mascaramento de TSR e vários outros parâmetros.

A medida mais eficaz contra o neckeg reepdeg é um \ u7, que
Rhya pode muito bem bloquear as interceptações no lago.Fragmento
MOP o protocolo de digitalização AU \ U7 para um computador afetado
Reepdeg, fornecido na Listagem 4.4.

`Witure & 4.Fropman Pragokrla ue

1. Pesquise Soska e programas interceptando as funções da arte
>> Perigo!Processos descobertos de processos

>>>> descobriu um disfarce do processo 1532 {100.eh
1.1 Pesquisar interceptores de arte que operam em Ozihmod

Kegpa function132.811: veiayar11e (676) interceptado,
Método de ArtSoden1)] Assk.Prtto

Função pyo911.a11: 19x10a@9011 (70) interceptados, método artsoden)] assk.Irto

Função pyo11.91}: mesgease1] e (123) interceptada,
Método de ArtSoden1)] Assk.dprtto

Função pyo11.911: mebu1segosopeke] e1] e (154) interceptados,
Método ARTSO4EN1) ASSK

Função pyo11.91]: meepimegaekeu (159) interceptada,
Método artsoden1) Pergunte.Rto

Função 06911.311: meelilegaseua] mekeuu (161) interceptou,
Método artsoden1) Pergunte.DPRTO

Pyo11.911: MeoparGoseuse (211) interceptado,
método artsoden1) assk.ortto

Função pE11.911: M. 5OKOKOGUR1KESEOOOOGHE11E (234) interceptada,
Método artsodenn1] Assk.Irto

Função BY4911.911: mecegutueettiyogpae1ot (263) interceptado,
Método artsoden \] Assk.Larto

Função P911.911: Oceguuo1 prytepeogtaeopa11e (269) interceptou,
Método argsoden1Dask.Ortho

Peye function11.9} 1: MVeaaa1 gel] Methog (276) interceptado,
Método ArtSoden13Ask

Pyo11.911 Função: MVezitigheai (237) interceptada,
Método ArtSoden1ASK.Rto

Função P11.911: Meuatsopa] (359) Interceptada,
Método artsoden1) Pergunte.Trto

Função pE11.a11: ve 1Sbeemma1UZEsspeoogta1olet (603} interceptada,
Método artsodenn1ask.oprto.

pagina: 247

Métodos de pesquisa do sistema, pesquisa e remoção de malware 243

Função pyo91] .911: 2msgeake11e (933) interceptados,
Método ArtSen1) Assk.Irto

Função do pE11.911: 2 mume1StosSpegeGe11e11e (963) interceptado,
Método Argsoden!} Pergunte.OPRTO

Função p11.a11: 2 \ epotegatece (968} interceptada,
Método artsoden1) Pergunte.Trtto

Função P911.311: 2M \ EpiteGayua] SECEU (970} Interceptada,
Método ArtSoden1) Assk

A função é@] 11.911: 2 MUMBRGOSEZE (1020} interceptada,
Método de ArtSoden1)] Assk.Ifrtto

A função pyo11.911;
Método artsoden1ask.irto

Função P4A11.911: 7 MECEGUBUSETTPOOOGOA*1OT (1072) Interceptado,
ArtSoden1} pergunte.Zirto

Função pE11.911: 2oceguuo1otpeoogta1o1111e (1078) interceptada,
O método é artista!) Pergunte.Zyoto

Função p911.9411: 7 checheach1gooaa1metoh (1085) interceptado,
Método artsena {pergunte.Irto

A função PAA11 .911: 2MWESCHETRGEA (1106) interceptada,
Método ARTSODEN13ASK.Irto

Função 06911.911: 7muapsope] (1168} interceptada,
Método artsoden1) Pergunte.OPRTO

Ayauar Function132.911: epilbago1sestoznri (210} interceptado,
Método artsena {pergunte.Irto

AUAR132.911 Função: epilbago1Sez5ato $ para (211) interceptados,
Método ArtSoden \) pergunte.Irto

Função de Aduar132.911: Berry and Build
Método ArtSoden1ASK.Irto

Função a@uar132.91}: epbekgu1sezaaaa $ ekh (213) interceptado,
Método ARTSODEN13ASK.Larto

Função de 2_32.911]: e $ abes (71) interceptados, o método artsoden1) Assk
Função \ 52 32.911: Gesu (16) interceptou, o método ArtSoden.OPRTO

O protocolo mostra que uma quantidade sofrida de funções é interceptada, em
em particular, as funções usadas para trabalhar com o registro e funções,
Alterado para obter informações sistêmicas.Usando v.
Keug!
Um disfarce de vários arquivos e chaves de registro será revelado (Listagem 4.5).

Listagem 4.5.Fragmento do protocópio Vokiyauyev t

S: \ Her5e \ bhdee100 21/04/2006 12:08 0
Arte.

pagina: 248

244 CAPÍTULO 4

S: \ szee \ fase100 \ 1hae?

Por exemplo, i1pam $ art.

S: \ szee \ fase100 \ phaei100.eh 21/04/2006 12:08 68,50 kV
NUZAAP EGOSH Y1P4OMCH ART.

S: \ sesh \ phaee100 \ vhade100.111 21/04/2006 12:08:00 3,78 KVN: AAEP

Leste 1 pop $ art.

S: \ eses \ vhae {100 \ phaeag.

Ekom u1pam $ art.

S: \ sess \ vhaeo100 \ zgs \ zgs \ vx4.4p21.04.2006 12:08:00 355.64 kV
Nzdepa egt i1pddz art.

S: \ itmvoy 5 \ rgeesp \ nhooe1o00.eh-00760821.ra 21/04/2006 12:09

6.13 KVNAAEP EGT I1PAOMZ ART,

A neutralização da sabotagem reepdeg é realizada por um razoavelmente simples
SOBE.

1. O computador AU7 é digitalizado com o ON
A ação das rotas, enquanto a neutralização das interceptações é realizada.

2. No despachante dos processos AU7, é necessário parar as rotinas disfarçadas
Os processos (eles são fáceis de encontrar de acordo com o protocolo de verificação ou pelo protocolo
Lou do sistema do sistema).

3. Após a neutralização do processo de Rutkita Lly Au7, disfarce de arquivos e
As chaves do registro deixarão de operar, o que permite remover a camuflagem
Ferva arquivos e chaves usados ​​para o carregamento automático de Rutkin.
Depois de excluir arquivos usando a exclusão atrasada, você precisa
Reiniciar e controlar o lançamento do AU7 e Cosjikeeg para confirmar
O fato do fato de remover bem -sucedida Rutkin.

Exemplo da análise - \ m/ogt.

Este desenho de vírus usa rootkit para mascarar sua presença
No computador, dificuldades em análise e tratamento.Uma tentativa de analisar
O computador de uma esposa com uma ajuda CookeueEG não dá resultados -
Não detecta arquivos ocultos e chaves de registro.Tentando lançar um \ y2
leva à conclusão imediata de seu trabalho, o que sugere
O fato de o computador ter um programa malicioso que bloqueia
Lançamento de certos processos.Em tal situação, você pode ir dois
caminhos:

@ Aplicar o lançamento de um \ y7, com a proteção em (inicie com a chave de agosto
Ach = y), isso levará à ativação a \ u7, espague
mecanismos;

pagina: 249

Métodos de pesquisa do sistema, pesquisa e remoção de programas maliciosos 245
E

Com renomear A2.eh, por exemplo, em 123.Eh.Renomear com muita frequência
ajuda nesses casos, especialmente para programas que não têm um mecanismo
Mov auto -defesa.

Após ativar o mecanismo de proteção, é possível iniciar o AU7.(nisso
Um exemplo de renomeação também ajuda, pois o worm verifica o nome
Arquivo preenchido) - Listagem 4.6.

Lischin 48 Lote Proplic Au.Para PC.Infecção.WOM REBBE _

Puxe bo gee ..

1. Procure cooeches e programas que interceptem as funções da arte

>> Perigo!Processos descobertos de processos

>>>> descobriu um disfarce do processo 1140 5 USBOSE.EH

1.1} Pesquise interceptores de arte que operam no lago

Análise KegPA132.A1], a tabela de exportação é encontrada na seção.

Função kehpe] 132.911: puta1gzee1] ea (209) interceptada,
Método ArtSoden \) pergunte.Zifto

Kegpa function132.911: e1p9e1g3ze11] ela (212) interceptou,
Método de ArtSoden 4) pergunte.Irto

Kegpa function132.911: E1pykhi 9mhee111ea (218) interceptou,
Método artsoden1] Assk.Irto

Função keghpa132.311: e1pamehee11e!(219) interceptados,
Método ArtSoden \) pergunte.Irto

Kegpa function132.411: OctarGosez (629) interceptado,
ArtSodenn1} Pergunte.Irto

Análise do PBA11.911, a tabela de exportação é encontrada na seção.

Função pyo911.911]: mebo -gupubuzetpelae op (263) interceptou,
Método ARTSOCHENN1) pergunte.Irto

Função 1911.91}: ve 1SemeesMae1Tubuzttititiaogtae1OP (609} interceptada,
Método de ArtSoden 4) pergunte.Irto

Função p6911.911: 7*yumegubuzemtiyota1op (1072) interceptada,
Método ArtSoden1) Assk

Análise e $ EG32.41], a tabela de exportação foi encontrada na seção BECHES
Análise A@AR132.911, Tabela de exportação IDEN na seção “Marcos

Aduar Function132.311: Vedeopolkeua (471} interceptada,
Método artsoden1) Pergunte.Irto

Aduar Function132.91}: VEDEPIPKELS (472} interceptado,
Método artsoden1) Askk.Proto

Aduar Function132.311: VEDEPIYUKEUHEKHI (473) interceptado,
método artsoden1) assk.ortto

Função a@\ ar132.911: VEDEPONKEUY (474) interceptada,
Método artsoden1) Pergunte.Proto

pagina: 250

246 Capítulo 4

Aduar Function132.911: Vysepoli1ooa (475) interceptado,
Método ArtSoden1ASK.Proto

Aduar Function132.911: VedEPetivo Shei (476) interceptado,
Metsd ArtSoden1) Pergunte.Ortho

Análise de 2_32.4911], a tabela de exportação foi encontrada na seção “Keche

Função de2_32.911: Detrose & Bupsashche (52) interceptados,
Método artsena}] Assk.Arto

A função M32_32.911: 5EP4 (19) é interceptada, o método do artistaDen1] Ask.Proto
Análise I1p1p.911, a tabela de exportação é encontrada na seção “Marcos

Função m1p1pef.911: Nebroophashezheea (203} interceptada,
ArtSoden1} Pergunte

Função inpee.911;Não -uniforme5e (204) interceptado,
Método artsoden1) Pergunte.Proto

A função m1p1pee.411;NesrbelllyavetShea (207) interceptou,
Método ArtSoden!) Pergunte.Irto

Função i1ppee.911;: nepribopdvestzem (210} interceptada,
Método ARTSoden1} Askk.Dirto

A função m1p1lpeoe.911;Tpsegpa (Keaea11e (272} interceptado,
Método Artsoann)] Assk.TPRTO

Análise de funções interceptadas sugere que o worm pode
Máscara os arquivos no disco (funções do rusy11e e e1odmehehe11e),
Responda à abertura de processos (oospargoseuses), processos de máscara e
Bibliotecas carregadas (meceoguzuzettprotta1ot, kep1beemak1uub5-
Settorogmae1ot, 2. Ocegubuzesstevoya {op), monitore a ópera
rádio com um registro e mascarar as chaves e parâmetros (aa-
UAR132.911: VE9*), rastreie a troca com a Internet (funções
M52_32.911: DenozaruPashen e MZ2_32.4911: ZEP@, MUP1PEE.911: FAN*).

Análises adicionais mostram outra característica interessante do worm.
Uma tentativa de abrir um processo mascarado leva a uma resposta imediata
reação de Noah- o worm está tentando completar à força o trabalho do
que está interessado no processo disfarçado.Isso é interessante e
um mecanismo de proteção não padrão que permite que um verme lide com o anti-
Rutkuts.O princípio de operação dessa proteção é baseado no fato de que o usual
O processo de processos não vê o processo mascarado, portanto, não
pode abri -lo.O utilitário antiRutkit pode detectar um disfarçado
O processo e uma ação bastante lógica de sua parte são a abertura da massa
um processo estimado para um estudo ou conclusão adicional - neste
No momento em que o mecanismo de proteção do worm funcionará.Além disso, a proposta de pêlo
Lowisms protegerão contra os anti-infirtes mais simples que pesquisam
Os processos escassos pelo método de aplicação.

pagina: 251

Métodos de pesquisa do sistema, pesquisa e remoção de malware 247

Procure espiões do teclado

A metodologia para encontrar um espião de teclado (Keilger) depende da tecnologia
Rastreando o teclado aplicado pelo desenvolvedor.Durante a busca pelo Cla-
Os espiões da Viature devem ser levados em consideração a vários pontos comuns ao espião
Novos tipos.

Sobre o espião do teclado deve de alguma forma ser carregado no início
Computador (método automático -launch depende do tipo de espião).Durante a análise
Deve -se ter em mente que o espião do teclado pode ser atribuído a alguns
Apêndice Toro Safe, de acordo com o princípio do vírus - semelhante
A abordagem permite mascarar o arquivo executável e seu automóvel.

Sobre o espião do teclado deve receber informações de uma maneira ou de outra
MECIAÇÃO sobre a condição do teclado.

S] As informações coletadas devem ser salvas no disco ou transmitidas
Para posar em um computador de um atacante em tempo real.Incluindo
Telly, o espião do teclado pode ser calculado pelo monitoramento do sistema.
No entanto, deve -se ter em mente que geralmente os espiões de acumulação do teclado
informações em um tampão intermediário de um suficientemente suficiente
(de centenas de bytes a dezenas de kilobytes) e solte -o apenas no disco
Um preenchendo o buffer.

Keilogger com base em armadilhas

Keilogers deste tipo são mais frequentemente encontrados.Sua presença no sistema
A biblioteca com a função de uma armadilha, introduzida em todos os C \]-
processos.Portanto, para procurar um kelogger, basta analisar
Para fazer uma lista de bibliotecas usadas por S'u |Esta operação
Você pode fazer isso manualmente ou usando AUI.Analisador AUI.Não somente
Procura bibliotecas estranhas, mas também produz sua análise expressa.Babador-
Lioteki, identificado pela base de AUL ou catálogo seguro com miose, auto-
Maticamente removido da suspeita, as informações sobre o restante são exibidas em
protocolo.Como exemplo, considere a busca por um espião do teclado
a base de armadilhas consideradas no capítulo 2 (um exemplo é colocado no anexo a
Livro de Wed in the Pasta Cat).Após o lançamento deste exemplo, a armadilha é registrada
E no protocolo AU7, você pode ver uma mensagem sobre a detecção de um estranho
Biblioteca (Listagem 4.7).

Listagem 47. Fragmento do Pratovol /Y2 para o Keilger

5. Pesquise interceptores de eventos/skon do teclado/mouse (Keu1 Oda, Trojan
O,

pagina: 252

248 Capítulo 4

>>> e: \ va1rn15 \ va1rr17 \ rgos Eve5 \ vea \ ka1 \ keu.411 -> com um alto grau
A probabilidade foi descoberta por Keu1oddeg ou Trojan

E: \ va1rv15 \ 0e1rr17 \ rgo] Esez \ kya1 \ keu.911! >>> Rede neural: arquivo
Com uma probabilidade de 99,80%, é semelhante a um interceptador típico de eventos de teclado/mouse

Apesar de uma resposta bastante clara a forasteiros O. Análise
A cortina não pode dar uma resposta se a biblioteca é Keilger ou o Trojan
biblioteca.Além disso, o analisador não pode avaliar a prejudicial
Objeto - Uma biblioteca com uma armadilha pode ser usada como para resposta
em "Hot Keys" e para espionagem para o usuário - tudo depende
De que propósitos as informações recebidas pela armadilha são usadas.

Mais eficaz em termos de análise é o uso de especial
Anti -comilgers lisizados.Eles estão impressionados com a maior parte
nós pelo princípio da interceptação de funções usadas por keiilgers de depois
Durante o monitoramento de seus desafios.

Keilogger com base em
Enquete de teclado cíclico

Apesar da simplicidade da implementação, um espião desse tipo é bastante difícil
detectar.Várias razões contribuem para isso.

0 para a espionagem não use armadilhas (portanto, eles não são causados
as funções de instalação de uma armadilha e um estranho
biblioteca).

Sobre muitas aplicações entrevistar a condição do teclado no processo de trabalho
Você, portanto, a detecção do fato da pesquisa de teclado não é evidenciada
É sobre a presença no sistema Keiloger.

Com uma pesquisa de teclado, pode ser realizado sob a condição, por exemplo, no caso
A presença no foco da entrada do teclado de uma janela com um determinado nome.É isso
Bolsha complicará a busca por um espião.

Atualmente, a única metodologia eficaz de anti-
ações desses espiões.Isso se resume à interceptação de ar | -funções
Sekazupskustas e seus análogos e monitorando suas ligações.Os próximos são possíveis
Duas estratégias de oposição.

O] O usuário recebe uma notificação sobre isso.que um determinado aplicativo é

A pesquisa de teclado é inibida e é proposta para criar uma regra que permita
ou proibir esta operação.

Sobre a Anticlianger bloqueia automaticamente a pesquisa de teclado.Geralmente
O critério de bloqueio é a visibilidade da janela do aplicativo - se

pagina: 253

Métodos de pesquisa do sistema, pesquisa e remoção de malware 249

A janela está aparentemente localizada no foco da entrada do teclado, então
A pesquisa de teclado é permitida.Caso contrário, em resposta a um pedido
O status do teclado é exibido por informações falsas, como regra, sobre
O fato de todos os teclados serem lançados.Nesse caso, o trabalho do anti -comilador
Quase invisível para o usuário e aplicativos de trabalho.
Nesse princípio, Rpuasukeuboaga e Apikeeo-Eores trabalham,
Sanny no capítulo 3.

Keilogger com base na tecnologia de Rutka

O espião do teclado desse tipo não pode ser detectado com ajuda
Anti -Cheilgers especializados.Em particular, descrito no capítulo 3
Riuasukeuboaga e API API ADUAPSED
ni e, portanto, não consigo resistir ao keilger trabalhando em
PrincipA Rutkutka.Além disso, os programas virtuais incorporados nesses programas
Os teclados são ineficazes devido ao fato de que os aplicativos são
Informações corretas sobre eventos de teclado através de mensagens em tpao \.
Portanto, a interceptação das funções do tipo de rexhazade e corredor permitirá
Registre as informações inseridas usando um teclado de tela.

Você pode neutralizar o caso desse tipo com a ajuda de anti-infusão
Baleias que exibem informações sobre funções interceptadas para análise.
Informações semelhantes, em particular, exibem -in -in anti -Russits
Ay.Pode ser suspeito da existência de um keiilger de raízes pode ser analisado pela interceptação
Funções da Biblioteca do IZEG32.4p projetadas para trabalhar com uma fila
mensagens.Atenção particular deve ser dada à interceptação de funções
Reekmeszade e Semeszade.

Situações típicas que surgem durante
Tratamento para PC e sua solução

Considere uma série de situações típicas com as quais as mais frequentemente caem
colida na prática durante o diagnóstico e tratamento de um computador,
Zero \ Age ou Trojan Programs.Durante a consideração de
Mas a nova atenção será focada no processo de análise de computador e
O curso dos pensamentos que permitem suspeitar de determinados arquivos
Ser de programas maliciosos.Uma característica importante da análise é que
Os Dizassemblers não o usam para sua implementação,
Telly, essa análise está disponível mesmo para um usuário iniciante.

pagina: 254

250 CAPÍTULO 4 '

Mudança das configurações do navegador

Alterar as configurações do navegador indica a presença no computador
Programas de classe Nbaskug ou programa malicioso de um tipo diferente, que
Tem as funções de Ntsaskug.Na maioria das vezes a partir das atividades de tal pró-
Gramas são sofridos por usuários de jegpe: echrogeg, já que ele está no presente
O momento é o navegador mais comum.

Várias configurações podem ser distinguidas, que geralmente são modificadas
Programas como NTSaskug.

Com uma página inicial.A substituição da página inicial é a maior
Uma manifestação gasta de programas de n \ askegog.Manifestações visíveis -
A página inicial do navegador é espontânea e em
a maioria dos casos de tentativas de restaurar a página inicial do
Eles não dão um indestismo.

Configurações dos prefixos de protocolo.
Página de pesquisa.
Título da janela do navegador.

Lista de sites confiáveis.Geralmente vários são adicionados a esta lista
forasteiros, geralmente pertencentes a sites dos quais
A instalação de malware.

Configurações de segurança.Na maioria dos casos, carregando e
Execução de componentes ASIUH sem solicitação de usuário.

Sobre a classificação do Laboratório Kaspersky para programas de dados
Categorias de TGO/AP.

Oooo

[Não.

O combate a se resume a duas operações.

1. Pesquisa e destruição de um programa malicioso que executa não-inslato
Mudança cionizada nas configurações.Durante a pesquisa, você precisa aprender
que Ntzaskag poderia alterar as configurações e a autodestruição
Live, ou as configurações podem ser alteradas por um script malicioso
Uma das páginas compareceu.Momento de início na busca por nuaskeg
Pode haver o fato de que ele deve de alguma forma carregar
Xia ao iniciar um computador.

2. Restauração de configurações.

As configurações de restauração podem ser realizadas através da Au, em automação
regime mítico.Para fazer isso, chame o gerente de recuperação
Configurações do sistema (arquivo | recuperação do sistema) e marque um dos
Pontos de sopro:

Com a descarga de Vastraks dos prefixos dos protocolos GP (egae! Ehrogage ao padrão -
a remoção dos prefixos dos protocolos descritos no registro e C03-
Dinamarca de prefixos padrão;

pagina: 255

Métodos de pesquisa do sistema, pesquisa e remoção de malware 251

[0 Restauração da página inicial Piegaeo Echogeg -
Redefinir a página inicial para esvaziar e restaurar os parâmetros,
página inicial padrão;

0 Redefinir as configurações da lagoa você, outras configurações de Niega!Echrogag no lançador -
executa a remoção das configurações de pesquisa existentes;Além disso, restaura
Várias configurações secundárias são lançadas, em particular, exibidas em
Texto da direção da janela.

Se, por algum motivo
Lo, então você pode restaurar manualmente as configurações com a ajuda do editor do registro
RA (Tabela 4.1).

Tabela 4.1.As chaves do registro que armazenam as configurações básicas do Tete!EHR/OGEG

LLC 7500001 LLC

Zo -SuEate \ M1Stoso \ |<Nome do prefixo> = prefixos de protocolo para auto-
I1p9omz \ sittEpsetz |<fix> Definição Matical de
1OP \ ov \ rga {1hez col. De acordo com o prefixo da cor do site

Zoeemag \ M1S -GOZOE*\ |Buyaz1e RADA CHV |) P (, instalado em caso de pressão
Tpeegpee |Botões tii com o original em
Ehr1ogechg \ ma1p página inicial página de partida

Reoec1e_bakaksp_ |Não as páginas de pesquisa pelo silêncio

Ovi

Zeakgsi RADA das páginas czares da pesquisa, aberto
meu ao pressionar o botão de pesquisa

ZPOI_BTASIZVAG Controla a tela da linha
Status na parte inferior da janela.Se
O parâmetro é igual à "partida", depois a linha
O status é exibido

I1 ROM P1ASECHEP |Parâmetro como ru1pagu © in-
Postagem de janela

Zo -Sueate \ M1Stozoos \ |It1 mmm lista dos últimos
TPEEHPUE ECHROGEG \ Crue.
Tureanov!
Zotiave \ m+skozoag \ |Páginas da busca dos Emirados Árabes Unidos Beagspov, aberto
Tpeegyee ehr1getg meu ao pressionar o botão de pesquisa
Zoeieis \ Mesare \ |Balance RADA Home Page M5Sare
Mesara Mamodayug
Mau1 dafog \ ma1p

pagina: 256

252 Capítulo 4

De acordo com as estatísticas, um ou mais parâmetros são modificados com mais frequência,
Colocado no registro -chave Zoe \ Age \ Misgoza \ ieugleg ehr!
Zoe \ Mage \ Masgozo \ Ulpdu $ \ SigTuegiaOp \ O em G \ Rheichez.Portanto,
O programa que é digno com o programa é fácil de detectar usando
Utilitários Ke8mop.Além disso, você pode fazer uma cópia de backup dos dados
Chaves, exportando -as com Vevechi.

Um exemplo prático - TGO] ap.

Sintomas: a página inicial do navegador muda para c: \ besiga32.pnt |,
É impossível tornar as configurações de Icegleg EHR] (o item de menu está disponível,
Na boca de uma tentativa de cumprir, não fornece resultados visíveis).Suponha
que este programa de Trojan não é detectado por meios de antivírus
MI e sua pesquisa devem ser realizadas manualmente.Considere os principais passos
análise.

Bloquear as chamadas de janela de configuração pode ser implementado por meio de políticos
Segurança (Royce) criada pelo programa malicioso.Usando
A \ y2.Demos a redefinição de todos os Royce.Para fazer isso, usamos o Built -in Au2
O utilitário de recuperação do sistema, o modo de redefinição de todos os roifez $ para o atual
Do utilizador.Da mesma forma, estamos descarregando os estados iniciais (posição
Redefinir da página inicial tpegpeye ehryuga).Operações de recuperação
Os tópicos são bem -sucedidos, mas o efeito no pytig do echrogeg não é
eles.Este é um momento muito indicativo que permite que você apresente vários
Para suposições:

P, talvez no sistema exista um programa malicioso que é constantemente
modifica a página inicial e ou cria Royce para limitar
acesso às configurações do navegador ou reage à criação de uma janela de
construção e imediatamente o fecha;

Oh, é possível que o Rutkit seja usado, que no momento da leitura pelo navegador
O registro não retorna seu conteúdo real a certas chaves, mas
Alguns dados estabelecidos pelo desenvolvedor Rutkita.

Para verificar a hipótese da presença de Rutkin, procuramos rotas com
Usando Au \ 7 e Kochzhiyvyuyuyeg.Ambas as concessionárias não detectam
O computador da esposa não é nada suspeito.Portanto, estamos desenvolvendo
A primeira suposição é um programa malicioso umedecendo
Construção.O método mais simples para sua detecção é o uso
Utilitários de KeooMop.

Na utilidade do Kevmop, configuramos um filtro- no nosso caso, o interesse é
Somente as operações de gravação bem -sucedidas são colocadas.Uma chave de filtro chamada não pode
Aplique- Se você fechar todas as aplicações antes do estudo, então
A honra das operações de gravação no registro será pequena.Uso da utilidade

pagina: 257

Métodos de pesquisa do sistema, pesquisa e remoção de malware 253
Personnes e programas de renda 93

Kesmop revela imediatamente a atividade suspeita do processo Rounty5.
(Listagem 4.8).

Pistus 4.9.Fragmento do protocolo -e9mop

1 0,02002E85 RAUE1TA5.EH: 1032 ZES \ A1 TSE
Nkim \ boesmate \ magozoo-s \ tishel ehr1ots \ ma1p \ tosa1 rada $ 0se $ $ $
“C: \ Zesitism2.Molhado! "

4 0,13683539 Rauraschevo5.EHE: 1032 Zeso11
Nkm \ zoskega \ m 4 skozookh \ tpeegpes ehr1ogeg \ ma1p \ 5tago rada $ 0sasus $
"C: \ zesota32?

7 p.25682622 Raue teb .eha: 1032 Zet \ ua1e
Nkgm \ eemate \ m1stozoic s \ tpetgpae ecchr1sgeg \ ma1p \ oeea1*_reda_ ou,
Z0SS55 "C; \ Zesig32. W."

10 0. 37700502 RAUE1TA5.EH: 1032 ZEG \ A1LE
Nksi \ 5 $ sobre seu mágico \ Masgozoe \ ttpgkekee ehr] shcheg \ mazp \ gosa] rada $ 0s.
"C: \ 5SOTA3Z2. RE"

13 0,49720202 Uma vez 1p5.ehe: 1032 5egua1p
Nkso \ bogeomata \ musgozoes \ tpetpee ehr1oteg \ ma1t \ 3+comeu rada $ 0sa $ $ $ $
"C: \ 5SIG32. VE"

16 0. 61736031 RAUS1MEB.EHA: 1032 Zesaa] e
Nkso \ $ oesmage \ m1stozoya (\ tpesegpe ehr] ogeg \ ma1p \ ooeai1e_rada ovz,
$ SSCA $ 5 "C: \ 5SIG3 2. Bem"

Assim, as primeiras linhas do protocolo permitiram encontrar uma "praga".
Análises adicionais do protocolo mostram que tal
Listagem 4.8 Operações são repetidas com uma frequência de 1-2 vezes por segundo, que de-
A restauração da página inicial lata inútil.Estudo do sistema s
Usando o protocolo de abertura do sistema a \ u7, nos permite estabelecer que
O programa suspeito é registrado no autorun.Começa na pasta \ u/lp-
House \ Zuyu IS32, não é reconhecido pelo banco de dados de objetos seguros.Verifique, Vi-
se o processo é o processo no gerenciador de controle de processo padrão e existe
A possibilidade de conclusão forçada do processo de pista.Na nossa
O processo é visível no despachante padrão, 11 pode ser interrompido sem qualquer
Por trás dos problemas.

Depois de concluir o trabalho do processo suspeito, realizamos um segundo
uma tentativa de restaurar o sistema com ajuda AU, desta vez depois
A formação da página inicial é realmente despejada na página para
O padrão e torna -se possível chamar o diálogo das configurações do navegador.

Para concluir o tratamento de um computador, resta excluir o arquivo Ravita5.
disco e exclua um elemento automático que se refere a ele.Antes do ullain
É útil escrever a data e a hora do arquivo do arquivo e depois a busca
Para verificar o Liska, que outros arquivos com os nomes *.

pagina: 258

254 CAPÍTULO 4

nós neste dia.Essa técnica geralmente permite que você encontre mais alguns
programas que eram ao mesmo tempo com o controle remoto- cada um dos
Quais programas devem ser cuidadosamente verificados.

Exemplo prático - tgodap.papadad
Com base no arquivo de peso

No exemplo anterior, é considerado um programa que encontra continuamente
Eu estava em memória desde o momento de carregar, o que facilitou significativamente sua detecção
queimando.No entanto, para modificar a página inicial, eles exigem constante
Mas um processo bêbado - basta colocar um pequeno
um programa que modifica as chaves necessárias para o registro e completo
meu trabalho.

O próximo passo na simplificação é se recusar a usar os programas
Para modificar o registro, basta criar um arquivo kez no disco e
Traga o comando de suas importações para o registro.Um exemplo do real
O KES-FILE é fornecido na Listagem 4.9.

Pystimt 4 9 Então] sou $ 4 ru ao ma base floresta florestal

VESOTT4

[Nkau será sobreposto sobre $ ek \ $ oemak \ musgozoel \ tpekhpeoe echrogech \ ma4t]
"5 bolsa rada" = "fã: // 2-02E9".

[NKAU_ Coleção _OZEV \ Bodemage \ Meszsar \ Messara Mau1datot \ Ma1t]
"Nop rade" = "5 Ser: // 2-O1 g. Sost"

"Aceo1oaa noma rade" = "show"

Em uma nota

Neste exemplo, o endereço real do site hacker é substituído pelo site
o autor, então esse arquivo de peso pode ser sem medo de lançar para estudar
seu trabalho e teste subsequente de vários métodos de restauração
iniciando uma página inicial.

Para a importação deste arquivo de peso, a equipe de comando pode ser usada:
Nome completo do arquivo GED Shirsge
Além disso, neste caso, a localização do arquivo, seu nome e extensão podem

ser qualquer.A introdução deste comando no AutoStart pode ser executada com
a ajuda de um pequeno programa que pode se auto -destruir depois

pagina: 259

Métodos de pesquisa do sistema, pesquisa e remoção de malware 255 255

executando esta operação.Além disso, existem soluções baseadas em
PMF-Nesse caso, o código executável está ausente.

Apesar da aparente simplicidade, esse método tem várias vantagens com
O ponto de vista do desenvolvedor de programas prejudiciais.

O arquivo de peso é um arquivo de texto, portanto é fácil o suficiente
perceba o polimorfismo mais simples devido ao rearranjo das seções
arquivo e introdução de linhas e comentários insignificantes.

Nos analisadores de lançamento automático intelectual quando a chave é detectada
the-thelers da utilidade do CAES.EHE pode excluí-lo do protocolo devido a
o que é um componente do sistema e é testado para
Catálogo de segurança.

A busca por tgoap.StaPrara desse tipo é extremamente simples- é necessário
Analise o AutoStart e encontre a importação de arquivos KES ao encontrar
Arquivos importados e estudar seu conteúdo.O tratamento se resume à remoção
NIYA da equipe de informações de importação automática de informações de importação no registro.

Substituição do papel de parede da área de trabalho
Sem o desejo do usuário

Substituindo a imagem de fundo do desktop recentemente gradual
Mas está ganhando popularidade.Propósito típico - imitação de infecção
um programa prejudicial com a publicidade subsequente de pago
Programa "Antishpio", retirada de várias informações de publicidade.

Vários métodos principais de modificação do exibido podem ser distinguidos
Na área de trabalho da informação.

Sobre copiar um arquivo gráfico para o disco com modificações subsequentes
Configurações da área de trabalho.

Ao determinar o nome e a localização da imagem atual de fundo
Desktop, seguido pela modificação desta imagem em
disco.

Sobre o uso das capacidades da ASIU, o Izor.Nesse caso, em vez de imagem
O NTMT.-FILE é usado, que, além de informações estáticas
Os MATCIONS podem conter links ou scripts.

Muitos usuários podem definir configurações de mesa,
Portanto, na maioria dos casos, o programa malicioso bloqueia a chamada
janelas de configurações com a ajuda de $ ou rastreando a criação
Windows e fechamento forçado das configurações.

As configurações de desktop são armazenadas no registro, as chaves principais são apresentadas em
mesa.4.2.

pagina: 260

256 CAPÍTULO 4

Tabela 4.2.As chaves principais do registro com configurações de desktop

Oh [p

Sogygo!Rap \ ozhermor |SOPUEGEE \ A11 RARARET |A imagem de fundo do trabalhador

P e
OG191PA1A11111111RARAG da tabela, o So -chamado."papel de parede

IA11Raret

Atraso mepynio1au na exibição do menu em
milissegundos.Instalação da dor

Os atrasos ampliados às vezes se aplica
programas prejudiciais
Para simular a presença de um "vírus" em
computador

Zona \ Mage \ \ \ Configurações de Asezhor
e \ iEgle {ehrugeg \
Bezkur \ sotropet5

Exemplo prático - Noah

Esta amostra de programas Noah é um típico muito visual
medir.Primeiro, considere os sintomas.

Sobre a imagem em segundo plano da área de trabalho muda para a mensagem de anúncios
na natureza, que chega ao download de chamadas e estabelece um certo anti-
Vírus (Fig. 4.1).

O Na região do sistema, aparece um ícone, para o qual com alguns
Uma mensagem pop -up é exibida de que o computador é exibido
supostamente infectado.

É impossível causar um menu para alterações nas configurações da área de trabalho.Quando você-
Borean de um item de menu pop -up.
T: // sl \ uim rum!$ \ Bsgeep.

Depois de reiniciar o ícone do computador na área do sistema e alterado
A área de trabalho permanece inalterada.

Analisando os sintomas listados, você pode fazer vários preliminares
Conclusões da TEL.

Um certo aplicativo estranho é realizado no computador.Esta conclusão
É fácil desenhar na presença de ícones na área do sistema.Deve ser observado
Tit que este não é necessariamente um processo - talvez um código de programa
colocado em uma determinada biblioteca ou implementado em memória de um dos sistemas
processos escuros.

pagina: 261

Métodos de pesquisa do sistema, pesquisa e remoção de malware 257

C] Este aplicativo está um pouco escrito em uma carga de ônibus ou por
O princípio do vírus é atribuído a um dos veículos.

Provavelmente, a retirada de informações estranhas é feita de
Shchu asiue okhotyre, e as informações exibidas são colocadas no arquivo
Zsgeep.tv1.

Marminms!
Wats'ka1m Oamsek!

21. Wets OO Matn Comrititia 15 Ztoveo Roneyen 4 UtaSya Nao 019. UCH
UT 5 Pesh, Zeno Emay.$.A. Osuv Aston Aya Tsosoev.Ano 17 15 Mrozvtte
Vemou tnem \ ln tanoaao $ 1001 uza $ 5pa.Auatave Roya
Ronemis $ e Nº Zomi Sasei Rovov V8, tendo Ranoya, Wotsya \ Mee USA
Boneco de neve.

Zesuke Wochezheier Asnt
Kemou Ass zru \ Poppy Pitch Watsu RS!

Arroz.4.1.Tipo de desktop de computador
Após o lançamento de Noah

Para esclarecer a situação, examinaremos o sistema com ajuda Auya,
com a oposição de rutkin e heurísticas máximas
(Ao mesmo tempo, acreditamos que uma variedade deste Noé não é determinada pela sinalização
Pesquisa de turnê).A varredura não revela a presença de processos ocultos e
interceptações suspeitas de função, portanto.Em uma caneta de aproximação
Pode-se supor que o mascaramento por Rutkutka-Method não é usado.Então
Como as heurísticas máximas foram incluídas, o protocolo foi criado
os dados do analisador para processos não identificados, em particular, há um
Entrada suspeita (Listagem 4.10).

pagina: 262

258 Capítulo 4

Pistint 4.40.Fragmento de Pratocol AUO

Analisador - Estudando Arquivo C: \ YATMOI $ \ Zuzem32 \ VBookdipr.EH
[E $]: o aplicativo não tem janelas visíveis
[25]: começa na pasta do sistema

[E $]: Gravado no AutoStart !!

Conforme observado no capítulo 3, exibido no modo de heurística expandida de
A formação é mais informação para reflexão.Nesse caso
Vemos que um processo é descoberto cujo arquivo executável não é identificado
na base do cofre e do catálogo de μgose, enquanto o aplicativo é escrito em
Automóvel -e não tem janelas visíveis, o que automaticamente o torna um
Dos suspeitos.Para completar a imagem, cumpriremos o estudo do sistema
por meio de um \ 7.Com configurações padrão.

No protocolo do estudo, o mesmo Pookdrotr.ehe é encontrado e identificado
Há informações adicionais, em particular:

O) O arquivo Nookatr.ehe foi criado recentemente, o tempo de sua criação é aproximadamente
FORRIORES O TEMPO DO início dos sintomas.Estudando as propriedades do arquivo
Chama que não haja descrição e dados no desenvolvedor;

A partir do autorol do arquivo, é feito usando um parâmetro chamado TPE!
Zuztei 6001 na chave do registro do nki \ $ ohi \ mage \ misgova \\ ito \ i \
StevyUSheGup \ VIP.Ao mesmo tempo, sabe -se que utilitários e motoristas de qi]
Recentemente, não foram instalados.

Por esses dois fatores, é impossível julgar a prejudicação do programa estudado
Nós, mas você podemos fazer dela suspeitar número um.Para confirmação
ou refutação de suspeita, cumpriremos vários
Vorok-

Com o primeiro cheque está a pesquisa e análise do arquivo do servo \ m $ \
Zsgeep.nt1.Análise mostra que esse arquivo realmente existe
E seu conteúdo corresponde às informações exibidas na área de trabalho.

Com a visualização do arquivo Noocoter.
Ravan, e dentro do arquivo, as cordas contidas no ZSGEP.
Isso nos permite fazer uma conclusão inequívoca sobre o envolvimento do programa para
Modificações da área de trabalho.

Em princípio, a análise pode ser considerada concluída, suspeitos
Definido e permanece para realizar tratamento.O tratamento consiste em vários
passos:

1. É necessário concluir a operação do processo do Pookdrtr.eh e depois remover
Este arquivo é do disco.No caso de usar a remoção atrasada do AUO

pagina: 263

Métodos de pesquisa do sistema, pesquisa e remoção de malware 259
R

O autor da lâmpada automática será removido automaticamente.Se remover manualmente
É necessário excluir a chave do registro responsável pelo autoronal do arquivo.

2. O arquivo é excluído pelo seruupurou/$ \ bsgeep.it!.

3. Com a ajuda da recuperação do sistema AUKH, retiramos as configurações do trabalho
Qual a tabela para os parâmetros padrão.

4. Realizamos uma reinicialização.

Após a reinicialização, todos os sintomas desaparecem, o que confirma a correção
A conclusão de que o pookdir.ehe realizou os dados das manipulações com o trabalhador
mesa.

O curso descrito do raciocínio é aplicável a todos os programas maliciosos
Esta classe com pequenas variações.Em particular, no nosso caso,
Cess Kokkddvr.ehe foi lançado continuamente, que simplificou a análise do sistema
Nós.Em um caso mais difícil, em vez do processo, a biblioteca pode ser usada
Ka registrou, por exemplo, como uma expansão de um condutor ou
Proguer uypyuop.Além disso, no nosso caso, o programa não
Protegido de estudar por um empacotador ou criptor, que é significativamente
Roats sua análise.No caso do uso de um empacotador, você pode estudar o despejo
Memória do processo feito com a ajuda de Aukh.Outra maneira de estudar
O processo de memória do processo é o uso do utilitário rgosez $ ehr] - ogeg -
Nas propriedades do processo na guia $#11rb, o utilitário exibe a lista de todos os texto
linhas de tabela encontradas no arquivo.

Em uma nota

Deve -se ter em mente que as informações textuais podem ser armazenadas na criptografia
Aann forma e decifrar no momento do tratamento.Da mesma forma pode
ser protegido pelo código do programa- decifrando o fragmento de software
Sim, será apropriado antes de sua implementação.Nisso,
A análise do chá da memória DVMP será ineficaz.No entanto, estatísticas de shows
As bênçãos que essas medidas de proteção nos programas da classe de classe \\ idade, zru \\ ag, Noah
Eles raramente são usados.

Conclusão de janelas estranhas
Com informações de publicidade

Esta situação é uma manifestação típica de programas
Categorias ab \/idade e $ ru \/aga.A retirada das informações de publicidade pode ser condensada
Tocando em alguns métodos.

0 Um determinado aplicativo oculto é realizado no computador afetado.
Que exibe periodicamente o Windows com informações de publicidade.Isso é
Um caso simples em termos de encontrar um programa malicioso.

pagina: 264

260 CAPÍTULO 4

0 Uma certa aplicação oculta causa periodicamente iegiyig ecrogyg ou
O navegador padrão e passa pelos parâmetros da linha de comando
Endereço da página com informações de publicidade (ou o caminho para o arquivo local
com publicidade).

0 é controlado por um navegador seco (por exemplo, por ooe)
Para mudar para páginas com informações de publicidade,

0 O conteúdo das páginas vistas é modificado por um ou outro
caminho.Geralmente algumas palavras -chave são substituídas por um hiperlink
mi que levam a sites de anunciantes, as faixas são substituídas
Ou inclusão na página visualizada de informações estranhas.
Nesse caso, os principais suspeitos são todos os tipos de
As extensões do navegador estavam soprando.

É importante observar que, para retirar informações de publicidade, a presença de alguns
O canto do processo malicioso não é obrigatório.Vários são conhecidos
Tecnologias alternativas para a produção de publicidade.

Com o uso de um planejador de tarefas.Na lista de tarefas do planejador, adicionando
Há uma tarefa que se resume ao lançamento de um navegador com uma frequência dedicada.
O endereço da página com informações de publicidade neste caso é transmitido
Parters crote da linha de complexo.

C com a ajuda do script da página NTMG, embutida na área de trabalho
A tecnologia Asnuam é Ozorkor.

Com a ajuda do script da página NTMT, aberto em invisível para o pol-
O invasor é a janela do navegador.

Considere vários exemplos típicos de análise e tratamento para real
Programas Aya \/Age.

Exemplo - ACH \ Age.

Este mago é interessante com mecanismos de proteção suficientemente poderosos
Remoção, portanto, em seu exemplo, consideraremos não apenas diagnósticos.
mas também abordagens para o tratamento de programas difíceis de manobras.

Sintomas: as janelas são exibidas periodicamente durante o computador
navegador com informações de publicidade;A página é aberta nas janelas,
Falso em vp: //m.a4- \ -a-g-e.sot/, com o qual Realresa está chegando
ção para um 113 sites de anunciantes.

Iniciaremos a análise do sistema com pesquisa tralisial pelas rotas usando o
Lit Au7 e Koskiveuyeg.Auy cheque mostra que não identificou
Não há interceptações de funções, mas o Cookyketiag não detecta mascarado
arquivos e chaves de chave.Portanto, é possível com um alto grau de fé

pagina: 265

Métodos de pesquisa do sistema, pesquisando e removendo programas prejudiciais 261

dizer que o sistema não possui rotas ativas que mascaram
Arquivos e processos.

O próximo passo na análise é realizar um estudo do sistema com
Usando Au \ U7 e estudando a lista de processos avançados.Estudo de lista
Nada suspeito revela os processos - todos os processos são possíveis
identificar como seguro e automático por meio de AU7.ou estudo
Localização e atribuição do arquivo manualmente.

Estudar o protocolo do estudo do sistema AUI, nos permite identificar o primeiro
suspeitos.

0 A lista de módulos carregados inclui duas bibliotecas: sl \ u/ipmro \/$ \
5ummet32 \ eris! E $.Oi e Salumo \/ $ \ ITCHING32 \ yoe-a1.Essas bibliotecas
A data da criação é semelhante e eles foram criados recentemente.Ambos os arquivos foram instalados
O atributo leni é sistêmico, o que aumenta a suspeita.

C Entre os processos avançados está o processo de vkip32.eh, no endereço
Cuja perseguição é carregada por um dos suspeitos OM.Como
Elemento de análise adicional usando um rgsez $ ehr |
Linha de comando vim do processo de kip 132.eh- no nosso caso, é
No HIP1132.EH "C: \ ITMOI $ \ Zuzet32 \ EHE. 911", 011 Seshahz1OP.

Com uma análise adicional do protocolo, ele nos permite estabelecer que um dos
Bibliotecas rasgadas são registradas como a expansão do ULPYUOVOP, e o segundo
Paraíso - como uma extensão do condutor.

A tentativa de joint venture de analisar arquivos mostra que o acesso a um deles é BL-
Morto.Com base na falta de interceptações, podemos assumir que
O bloqueio é instalado abrindo um arquivo no modo de monopólio
Acesso (um exemplo de tal bloqueio é considerado no capítulo 2).A presença de BL-
Kirovka é outro fator que permite que você pegue o arquivo
Suspender.

Ações adicionais são óbvias- desconecte os elementos do lançamento automático para o dado
arquivos usando o gerente de lançamento automático a \ u7 ou por meio de utilidade
Você é Ashogip $ e reinicie.A implementação desta operação não dá apelido
Quem é o resultado visível, exceto para dobrar registros no início automático (Fig. 4.2).

Estudar do sistema usando Au \ y mostra outro
Um recurso terrível - os nomes dos arquivos no disco e suas chaves mudaram
Automóveis no registro.Alterar nomes de arquivos nos permite concluir que
A remoção tardia será inútil porque nova
Nomes de arquivos no momento do carregamento do sistema.

Para "esclarecer o diagnóstico", realizaremos mais duas operações.O primeiro é
Identificação do processo que restaura as chaves do lançamento automático.Esta operação
Vamos cumprir com a ajuda do keyomop para reduzir o tamanho do protocolo do
Navegamos pelo filtro pela palavra-chave "*\/tovop*" e ligamos o registro-

pagina: 266

262 CAPÍTULO 4

Apenas operações de gravação bem -sucedidas.Em seguida, ativamos o monitoramento e
Pecamos o elemento de míssil automático de um dos suspeitos O. na seção \ m.
VOP (esta operação pode ser executada usando AU7 ou Ashogip5).Em
O proativo pode observar uma reação imediata de Shock2
(Listagem 4.11).

NZI que x

= Actusalsk 1
Auto -zalusco Sticks

= Racher g de registro
Ryya 528 3 R Raster
Chaves do sistema do passado, clique de vômito
Zlvizagls no século 4.#LUCH REGISTRO
4 FAPE M.> ", o registro

"Il | e 4

Mrya Zeglswu e ‚ -

registro comercial
Espada do Registro.
A chave do rexi a
|cabanas, eu sou uma cunha melhor

Arroz.4.2.Conduzindo uma tentativa de desligar o elemento automático -

1 1.22391136 h1p1p1p.ehe: 400 oe1etkeuu
Nyu \ zoetiava \ ma staos \ ip9i $
Mt \ saggepeug $ {op \ usp1o9op \ MOS1EU \ pepdochordas $ Ossez $ keu: 0HE1203S30

2 1.22430107 i1p1p1dop.ehe: 400 ze pescoço
Nkim \ zotchava \ m1sgoos \ i1pa0i $

Mt \ SOGePUG1OP \ 1711 ODOP \ MY1RU \ i1PDU5ordas \ AzupSpGopa5 $ 0SSISE $
0x0

3 1.22519951 \ 1p1dop.eha: 400 zesaa1e
Nkim \ zotiava \ m1 em um \ e 1190 $
Mt \ sigkepeuyeg1op \ POP1OOOOP \ mo 1 eu \ i1pdurdordas \ o1 mane 59sa $ 5
"C: \ itmra $ \ zuztet32 \ yahagt. 911"

4 1.22531936 UP] ODOP.EHE: 400 5 Esua1e
Nkhkim \ zoetiava \ m1 soda \ e 3 p9oi $

Mt \ saggepeeg1op \ 111 ODOP \ MY 1 U \ RUPDON5ORD®E \ TPRAGZOPAS 50SA55
0GE

5 1.22555402 U1P1111ODOP.EHE: 400 Zeseto

Nkim \ zotiava \ m1sgozo t \ e pdoi5

pagina: 267

Métodos de pesquisa do sistema, pesquisa e remoção de malware 263

Mt \ siggeep1ot \ 111 ODOP \ MOT1EU \ i1PASIORDAS \ TODOG 30SE55
"Iztoop"

6 1.22560934 e101ODOP.EHE: 400 BETUA1
Nkim \ zotiava \ m1 skozes \ 114045

Mt \ siggeePues1OP \ 111 ODOP \ mo1ru \ 3 Paochordate \ TODOE 50SA $ $ $
"\ U1 otodoe"

7 1.22576941 \ 1110d01.eh: 400 zes \ aiya
Nkem \ $ zoetiava \ m1 succos <\ i1p90i $

Não.
"I1pbroyaomt"

As linhas fornecidas na Listagem 4.11 indicam o processo de reconstrução
a chave do registro.pertencente a 1Eok2ta.Análise do Protocolo KE?
nos permite estabelecer que esta operação é repetida continuamente a partir de uma hora
Tota cerca de uma vez um segundo.

A segunda operação é determinar o processo que desencadeia o IEIGPE!
Yruegeg para exibir páginas com publicidade.Esta operação é conveniente
Realize com a ajuda do RGOSZZ $ ECHROGEG.Para fazer isso, feche tudo
lançou aplicativos e aguarde a próxima janela do navegador com
anúncio.Em seguida, você deve iniciar um $ echrugeg e arrastar o ícone de
a imagem da visão de sua barra de ferramentas para o cabeçalho da testa
Zer com publicidade.Em seguida, você precisa completar o arrasto, deixando de lado
O botão do mouse acima da direção da janela - neste momento na lista de processos
O processo será alocado para o qual a janela especificada possui (Fig. 4.3).
Nesse caso, não estamos interessados ​​no próprio processo (sabe -se que este
[Echreokveko.ehe), e seu processo parental, que é \ m1tu-
OP.Isso mais uma vez confirma a suspeita de que a saída das janelas do navegador
A publicidade é produzida por um dos fluxos do processo.

O procedimento de tratamento neste caso pode ser realizado de duas maneiras.

O Usando o Aukh do sistema ikhg@, que bloqueará a possibilidade
Restauração das chaves do registro e renomeação de arquivos.

C com a ajuda de conectar um disco rígido a outro PC ou carregar de
Co ou nomeado.Nesse caso, bibliotecas nocivas são naturais
Eles não serão carregados e não serão capazes de interferir na remoção deles.

Em nosso exemplo, aplicamos Au, considerado.Após sua ativação, nós realizamos
As seguintes operações.

1. Removemos os elementos de lamas automáticos para suspeitos pt.(um elemento em
M/trorop, o segundo - na lista dos módulos de expansão de expansão).

2. Excluímos esses arquivos da biblioteca com a ajuda de remoção atrasada au \ u7 ..
3. Realizamos uma reinicialização sem sair do AU7 e sem desligar a Au, uma saga.

pagina: 268

264 CAPÍTULO 4

Ry oben bin roqueya 278 nala nosso

9 1 = Shushgh DIF

Scha

nós
\ Vaanan Nast
'mal

Avalo da UE Lilivtia.Izzy Riise Eir no cache
\ Vaen está de perto e zron uve
Pandies com a UE Close Oyask.
O nome era pessoal

Sukyteg em bereni osa bio tegi

Arroz.4.3.Procure o processo por sua janela

Depois de reiniciar o controle, realizamos um estudo do sistema com
Potência do analisador AU2 (arquivo | pesquisa do sistema).Em caso de sucesso
O tratamento NOGO são bibliotecas e elementos estranhos para o seu Autozauysk
deve estar ausente.

O aparecimento de UPOs estranhos

Como observado no capítulo /, muitos programas ADU ANE- e ZRU \ AGE são realizados
Na forma de VNO (NCGZEG Nerege Octens, módulos da expansão do navegador).Cabana-
Muitas vezes não é fácil se enrolar de um módulo de expansão, pois além de
Este módulo no sistema pode estar presente um programa, restaurar
módulo em caso de remoção.

UNO é geralmente associado a usuários com uma certa barra de ferramentas
policiais ou botões no painel do navegador.No entanto, esse nem sempre é o caso, e
pode não mostrar visualmente sua presença, o que dificulta
detecção.

pagina: 269

Métodos para pesquisar o sistema, pesquisar e remover malware 265
P, Ree IRENASIA DE PROGRAMAS MALICIAIS 295

* Ashogota [2ayuktioaa ikeya zunrtesli mlm Universidade de Sogt
9e eitu Orshe Oreeg 59
R.Ig a
53 White No. Oksya Yu Izona Ri % Koozham

__ mm _ em ulsk rochcheta No. reMomov eao
2 Bui r "ts Oda № ekrha, eu sou ekryuy, eu sou bakle tazkz

Dadolya uagu oarslea
Em 'Naa Botonia \ Isaiah Eo Força, Mago da Nun Krokv Anna Nepreg
57} © Ashenoi Ca Azova Ale
2] $] ESSG2 SAN COAS Mod
$ Neo Bones pode ser Iyte e Cristo sem Jokz
59 NF Oka Mono Umbrella Ekho, t The Wallpaper

S] $ pescam você aazbeye va
#5 NPI seria as árvores de águia.
d nk combate uma casa de banho mal cheki watt
#9 nkpllen ioon hokivimenesgn
9 Para ele, munição “Guaxinins chicotea eiryulezhol $
2] laboratórios
E] 3 $ Tea Manat:

Arroz.4.4.AMOGIP $ utilitário, guia ICEGPE {Echrugeg

Para estudar a lista de módulos de expansão, um dos
Sannaya no Capítulo 3 Utilitários, por exemplo, Ashogipz ou Au7.Como um exemplo
Você pode considerar o uso do utilitário AshcoGIPV (Fig. 4.4).

Na fig.4.4 mostra uma lista de chaves de registro usadas para registro
Vno.O desligamento temporário do VNO se resume à remoção do correspondente
um registro de um registro com uma cópia da cópia, respectivamente, para a inclusão
sua restauração é feita.Para remover o VNO, exceto o link em
O registro deve ser excluído do arquivo executável e registrado por ele
ST $ então.No caso de usar a remoção atrasada AU7.Esta operação
É produzido automaticamente.As principais chaves do registro usadas para
Registro VNO, mostrado na tabela.4.2.

Tabela 4.2.Chaves de registro usadas para registrar UBO 1Tage!Ehryuga

SOBRE

Zotcava \ M1S -GOZOE+\ POPASHI $ \ |Registro de VNO (neste caso {с1 $ 10} -

Siggeepuyegz1op \ ehrogech \ Esta é uma apreensão da classe de VNO, registrada
Vogzag não1reg sobre] eu5 \ no sistema

{Stz _)

pagina: 270

265 Capítulo 4

Tabela 4.2 (final)

Zoetiave \ M1 Skozoy* \ painéis (Toofagz).Esta chave contém
TPSECKPEE EHR1OGEG \ Too1 Bag Paramustra Weight_57.O nome de cada par

Medidores - SZO Class, Griver - Texto
Descrição do painel

STELIAVE \ M1 em \
TPSEGPEE BHR1OGEG \
Exepz1opz \ {s5to_}

Expansão 1 Prishegpe {Echrog.Cada chave
contém vários parâmetros descrevendo
Expansão, seu ícone e texto para o menu

STELIAVE \ M1SGOZO#E \
Tosegpee Echrogech \ Echrogag
Vakz \ {_s5to}

Parâmetro do tipo Ehes Web _57 de cada um dos
Kikh Keys contém o nome do executável
arquivo

A presença de chaves incorretas do registro com uma descrição
não é um erro, mas muitas vezes leva à operação de vários anti-
programas de espionagem que apenas analisam a chave e não verificam,
Existe um arquivo VNO executável no disco.

Em alguns casos, o VNO pode aplicar proteção contra a remoção, semelhante
Proteção do AZ \ mago anteriormente considerado.Além disso, conhecido
Métodos para instalar VNOs sem o seu registro óbvio na chave correspondente
Chakh Registry.Vários métodos podem ser usados ​​para isso.

Com rutkutka-method.Resume-se à interceptação de funções AR1 responsáveis ​​por
Trabalhar com o registro.Se as informações do registro são lidas por ehr] ogeg,
Então Rutkit fornece informações falsas, acrescentando a chave "virtual"
Chi e parâmetros para o seu VNO.Análise do registro por todos os outros
Programas (por exemplo, Ashogip $) mostra o conteúdo real da re-
Estra, na qual essas informações de registro não são.Este método
ainda não foi generalizado, mas tecnicamente bastante realizado
Nós lambemos.Técnica de diagnóstico - Verificação do computador com anti -traços.
No decorrer de tal cheque, deve -se ter em mente que as utilidades do tipo de peso
Vyuzeeg pode não encontrar nada suspeito, pois o rootkit não é
intervém em seu trabalho com o registro.

Com registro de curto prazo do VNO.Este método é baseado no fato de que
O VNO é registrado no registro, mas em um período muito curto
Não - para o tempo durante o qual | 1Egp!Ehrogheg lê dados de
Registro.Este método, em particular, é usado no TGODAP.

Técnica de diagnóstico: Análise de operações com um registro com ajuda utilitária
Veomop.

pagina: 271

Métodos de pesquisa do sistema, pesquisa e remoção de malware 267
Olho do remo nnoramm_ 20/7

Considere o Hemdrodupe.
Do ponto de vista da análise, tolo.

Exemplo prático - TGU] AP.

Este programa de Trojan não dá sua presença no sistema
IU e geralmente é encontrado por sinais indiretos.Em particular, em
Um computador atingido pode ser encontrado vários suspeitos
objetos.

Com uma análise da lista de módulos carregados com um processo de 1CHR |
Detecte a biblioteca não identificada KB290333.41.

Sobre a análise de um lançamento automático mostra que esta biblioteca não é um VNO,
Mas está escrito em carregamento automático usando a chave ECHROGEK \
Zvagech9 Tatask $ 4i1EG.Além disso, no registro, você pode encontrar St5to
{EU1530S-822-47ES-8000-2706E78654V37}, registrado com isso
biblioteca.

Sobre a varredura do computador Au7 dá uma suspeita da presença
Keiloger ou Trojanskaya O., apontando para a Biblioteca de Sau/PMOO \/$ \
Dlaam.p.Além disso, a verificação heurística do sistema indica o babador
Liotek KB290333.41.

Sobre um estudo detalhado da lista de processos e bibliotecas carregadas
Ele chama de que não haja processos suspeitos, a biblioteca AA%e.
Em memória de todos os processos su] e a biblioteca KB290333.4 |- Somente em
Processos de piele echrogle.Esta verificação é conveniente para executar com base
Um protocolo do estudo de um sistema obtido usando Au.

Uma comparação desses fatos não explica por que o ecroget ecrogeg
anseia a biblioteca KB290333.91, pois não está registrada como
Vno.Você pode assumir as duas opções mais prováveis.

Sobre a biblioteca AAE.D1 está a biblioteca da biblioteca KB290333.91.

Com uma possível biblioteca, o KB290333.41 é registrado como neno, mas
A análise Mennan não permite instalá -lo.Rutkin
Máscaras neste caso são excluídas, uma vez que a verificação do afeto
PC descrito no capítulo 3 com utilitários não mostra interceptação de funções
Ou mascarar as chaves do registro.

Como um estudo adicional nesta situação, aplicamos
O utilitário veh?Mmop.Como um parâmetro de filtragem, você pode aplicar
C1510 EU1530S-822-47ES-8000-2706E7864V37 OU NOMES DAS CHAVES DE REGISTRO,
responsável pelo registro do VNO (os nomes dessas chaves podem ser copiados
de Ashogip $).Análise das modificações do registro durante o lançamento do tubo
Ehrogheg mostra um processo bastante interessante (Listagem 4.12).

pagina: 272

268 CAPÍTULO 4

Pisting 4,12, Modifikitsi Sarrobronyyyy e He: Jo Ze Ze
Jehuae e Yarong.

1 14.70272732 Techrgov.EHE: 484 SGERAKEKEU

Nkm \ sortiava \ m1 skozoe \ i1p9och $ \ sogheepuyegz1op \ ehrogek \ vgoizeg
Non1Rek $ \ {EV1530S-822-47ES-8000-2-2706E78 64837} $ 0SA $ Z5 Asses $:
Ocheoose
2 14.70730877 Techrgov.ehe: 464 ZeeUa1o

Nkm \ zoetiava \ m1 em combinação \ i1Paoch5 \ SIGEPEUYEGZ1OP \ ECHR] Little
NON1REG SOBRE) ES® $ \ {EU1530S-822-47ES-8000-2706E7864837} \ (inicia) $ 0SA $ 5

3 16.31704712 Two -echo.

Nkm \ $ orthnava \ m1 ugoi \ i1 pom \ sitkepuuekht1op \ ehroggzheg \
O Non1Rekhg é destacado \ {EV1530S-822-47es-V000-000-2706E7864V37} ZOSSE $ 5KEU:
0HE190S678

Como pode ser visto na Listagem 4.12, na chave do registro do NKIM \ 5oetiava \ Masgo5oee \
#1pomz \ siggeepuyegz1op \ ehroges \ vogzheg non1g foi um registro
O VNO é desenhado e o ART.Cha-
Semelhança por um curto período de tempo, essa chave foi removida.Por isso,
A técnica de "VNO-Invisível" é bastante óbvia com a ajuda da biblioteca
Zaam.
O grama monitora a criação de janelas.No momento da criação da janela, há
Rogg no registro é realizado pelo registro do VNOS.O próximo é observado!Ehr] OGEG
voa essas informações e está carregando o VNO, após o que
A chave de registro correspondente é removida e não pode ser detectada
Programas Anthspion e utilitários de atributo automático.

pagina: 273

Conclusão

Então, neste livro, examinamos os princípios de rotas, chaves e
algum outro malware.

Em conclusão, daremos várias recomendações finais.

0 Usando as ferramentas descritas nos capítulos 3 e 4, análise, análise.
Recomenda-se aderir a um princípio médico bem conhecido: "Não
o dano ". Em particular, seguindo esse princípio no processo de pesquisa
computador e seu tratamento, é necessário pensar em cada
passo, faça backups de arquivos variáveis ​​e excluídos ou chave
Cujo registro.Este é um ponto importante, porque você pode ouvir muitas vezes
usuários ou lidos em frases de conferências como "vou remover tudo o que
suspeitava os programas que você recomendou e, como resultado
pior.
descrito no capítulo 3 dos recursos da OPIPA que verificam o
Dados de arquivos suspeitos por dezenas de antivírus.

O No capítulo 2, descreve as tecnologias mais comuns que
Muitas vezes, você pode encontrar na prática real.No entanto, Techn-
Logia está sendo constantemente melhorada e desenvolvida, em particular,
Novos tipos de rotas e espiões do teclado estão sendo.Por exemplo, máscaras
Arquivos de arquivos no disco com a ajuda do filtro do sistema de arquivos
Atualmente, raramente é encontrado em programas de Trojan reais,
No entanto, pelo menos um espião do teclado já é conhecido, com sucesso
Usando esta técnica para mascarar seus arquivos.

O No capítulo 3, descreve uma série de serviços públicos, cada um dos quais é bastante ativamente
Abanar e melhora.Portanto, no caso de uso
Os programas descritos são recomendados para participar periodicamente de seus sites
desenvolvedores e rastrear a saída de novas versões.Além disso, não siga
esquecer que nem todos foram considerados nas páginas deste livro
Programas existentes - existem muitos deles, por exemplo, centenas são conhecidas
Gerentes de partida automática ou monitoramento de computador.

Com os programas de desenvolvimento usados ​​pelos desenvolvedores da tecnologia,
É precisamente desenvolvendo e progredindo rapidamente.Um exemplo claro disso
Há rotas- se alguns anos atrás, Rutkit era suficiente
mas um fenômeno raro e exótico usado principalmente
Socais, então, no momento em que escrevem este livro, tecnologias semelhantes

pagina: 274

270 Conclusão

Amplamente utilizado mesmo em programas A4 \/AGE.Aprenda sobre a aparência
Novas tecnologias podem estar em sites especializados, em particular,
Uu tosi.SOT e MM MAZT.G.

Com o tratamento de um computador, é recomendável usar o especializado
Recursos, por exemplo, em p: // mgizi sobre.e!
Renia sobre virologia), str: // mgabsap o. ogr/e bp: // mug.mel
(Verificação automática de arquivos suspeitos com muitos antivirores
corujas), bp:/ ai mgi $ em egi/ e nº r: // seshiuguzroopse.
Pedias com uma descrição de vírus e outras fontes de ameaça ao PC).

pagina: 275
